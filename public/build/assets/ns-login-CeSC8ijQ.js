import{n as f,k as g,b as d,i as k,F as w}from"./bootstrap-DI8pXSaz.js";import{_ as l}from"./lang-BINodpp-.js";import{w as F}from"./runtime-dom.esm-bundler-BJBE8XOq.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as h,c as t,o as s,b as i,a as n,f as p,F as B,e as R,g as b,t as m,w as T}from"./runtime-core.esm-bundler-DUdZl5j1.js";import"./currency-BCJk0SN4.js";import"./chart-BXKSDqJb.js";const V={name:"ns-login",props:["showRecoveryLink","showRegisterButton"],data(){return{fields:[],xXsrfToken:null,validation:new w,isSubitting:!1}},mounted(){k({login:d.get("/api/fields/ns.login"),csrf:d.get("/sanctum/csrf-cookie")}).subscribe({next:o=>{this.fields=this.validation.createFields(o.login),this.xXsrfToken=d.response.config.headers["X-XSRF-TOKEN"],setTimeout(()=>g.doAction("ns-login-mounted",this),100)},error:o=>{f.error(o.message||l("An unexpected error occurred."),l("OK"),{duration:0})}})},methods:{__:l,signIn(){if(!this.validation.validateFields(this.fields))return f.error(l("Unable to proceed the form is not valid."));this.validation.disableFields(this.fields),g.applyFilters("ns-login-submit",!0)&&(this.isSubitting=!0,d.post("/auth/sign-in",this.validation.getValue(this.fields),{headers:{"X-XSRF-TOKEN":this.xXsrfToken}}).subscribe({next:e=>{document.location=e.data.redirectTo},error:e=>{this.isSubitting=!1,this.validation.enableFields(this.fields),e.data&&this.validation.triggerFieldsErrors(this.fields,e.data),f.error(e.message||l("An unexpected error occured."))}}))}}},X={class:"ns-box rounded shadow overflow-hidden transition-all duration-100"},C={class:"ns-box-body"},K={key:0,class:"flex items-center justify-center py-10"},N={class:"p-3"},j={key:1,class:"flex w-full items-center justify-center py-4"},E={href:"/password-lost",class:"hover:underline text-blue-600 text-sm"},I={key:0,class:"border-l border ns-box-footer h-[15px] mx-4"},L={key:1,href:"/sign-up",class:"hover:underline text-blue-600 text-sm"},A={class:"flex justify-end items-center border-t ns-box-footer p-3"};function O(o,e,c,z,r,a){const _=h("ns-spinner"),v=h("ns-field"),x=h("ns-button");return s(),t("div",X,[i("div",C,[r.fields.length===0?(s(),t("div",K,[p(_,{border:"4",size:"16"})])):n("",!0),i("div",N,[r.fields.length>0?(s(),t("div",{key:0,class:"py-2 fade-in-entrance anim-duration-300",onKeyup:e[0]||(e[0]=F(u=>a.signIn(),["enter"]))},[(s(!0),t(B,null,R(r.fields,(u,y)=>(s(),b(v,{key:y,field:u},null,8,["field"]))),128))],32)):n("",!0),c.showRecoveryLink?(s(),t("div",j,[i("a",E,m(a.__("Password Forgotten ?")),1),c.showRegisterButton?(s(),t("div",I)):n("",!0),c.showRegisterButton?(s(),t("a",L,m(a.__("Register")),1)):n("",!0)])):n("",!0)])]),i("div",A,[i("div",null,[p(x,{disabled:r.isSubitting,onClick:e[1]||(e[1]=u=>a.signIn()),class:"justify-between",type:"primary"},{default:T(()=>[r.isSubitting?(s(),b(_,{key:0,class:"mr-2",size:"6"})):n("",!0),i("span",null,m(a.__("Sign In")),1)]),_:1},8,["disabled"])])])])}const M=S(V,[["render",O]]);export{M as default};
