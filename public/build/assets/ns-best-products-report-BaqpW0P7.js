import{b as y,d as f}from"./bootstrap-DrcjF3bc.js";import{c as v,e as k}from"./components-C3I5GvFp.js";import{_ as i,n as w}from"./currency-Dtag6qPd.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as b,o as l,c as a,a as e,f as p,t,F,b as C,n as _,e as d,i as u}from"./runtime-core.esm-bundler-VrNrzzXC.js";import"./chart-CAYz1qzV.js";import"./ns-prompt-popup-D8lO1yew.js";import"./ns-avatar-image-Pigdi04i.js";const N={name:"ns-best-products-report",mounted(){},components:{nsDatepicker:v,nsDateTimePicker:k},data(){return{ns:window.ns,startDateField:{name:"start_date",type:"datetime",value:ns.date.moment.startOf("day").format()},endDateField:{name:"end_date",type:"datetime",value:ns.date.moment.endOf("day").format()},report:null,sortField:{name:"sort",type:"select",label:i("Sort Results"),value:"using_quantity_asc",options:[{value:"using_quantity_asc",label:i("Using Quantity Ascending")},{value:"using_quantity_desc",label:i("Using Quantity Descending")},{value:"using_sales_asc",label:i("Using Sales Ascending")},{value:"using_sales_desc",label:i("Using Sales Descending")},{value:"using_name_asc",label:i("Using Name Ascending")},{value:"using_name_desc",label:i("Using Name Descending")}]}}},computed:{totalDebit(){return 0},totalCredit(){return 0}},props:["storeLogo","storeName"],methods:{nsCurrency:w,__:i,printSaleReport(){this.$htmlToPaper("best-products-report")},loadReport(){y.post("/api/reports/products-report",{startDate:this.startDateField.value,endDate:this.endDateField.value,sort:this.sortField.value}).subscribe({next:c=>{c.current.products=Object.values(c.current.products),this.report=c},error:c=>{f.error(c.message).subscribe()}})}}},S={id:"report-section",class:"px-4"},B={class:"flex -mx-2"},P={class:"px-2"},R={class:"px-2"},U={class:"px-2"},q={class:"ns-button"},V={class:"pl-2"},j={class:"px-2"},L={class:"ns-button"},A={class:"pl-2"},O={class:"flex -mx-2"},Q={class:"px-2"},T={id:"best-products-report",class:"anim-duration-500 fade-in-entrance"},z={class:"flex w-full"},E={class:"my-4 flex justify-between w-full"},H={class:"text-primary"},G={class:"pb-1 border-b border-dashed"},I={class:"pb-1 border-b border-dashed"},J={class:"pb-1 border-b border-dashed"},K=["src","alt"],M={class:"my-4"},W={class:"shadow ns-box"},X={class:"ns-box-body"},Y={class:"table ns-table border w-full"},Z={class:""},$={class:"p-2 text-left"},ee={width:"150",class:"p-2 text-right"},te={width:"150",class:"p-2 text-right"},se={width:"150",class:"p-2 text-right"},re={width:"150",class:"p-2 text-right"},oe={key:0,class:""},ne={class:"p-2 border"},le={class:"p-2 border text-right"},ae={class:"p-2 border text-right"},ie={class:"flex flex-col"},de={key:0},ce={class:"p-2 border text-right"},_e={class:"flex flex-col"},ue={key:0},pe={key:0},he={key:1},me={key:0,class:""},be={colspan:"5",class:"border text-center p-2"},xe={key:1},ge={colspan:"5",class:"text-center p-2 border"},ye={key:2,class:"font-semibold"},fe={class:"p-2 border text-right"};function ve(c,o,h,ke,n,r){const m=b("ns-date-time-picker"),x=b("ns-field");return l(),a("div",S,[e("div",B,[e("div",P,[p(m,{field:n.startDateField},null,8,["field"])]),e("div",R,[p(m,{field:n.endDateField},null,8,["field"])]),e("div",U,[e("div",q,[e("button",{onClick:o[0]||(o[0]=s=>r.loadReport()),class:"rounded flex justify-between border-box-background text-primary shadow py-1 items-center px-2"},[o[2]||(o[2]=e("i",{class:"las la-sync-alt text-xl"},null,-1)),e("span",V,t(r.__("Load")),1)])])]),e("div",j,[e("div",L,[e("button",{onClick:o[1]||(o[1]=s=>r.printSaleReport()),class:"rounded flex justify-between border-box-background text-primary shadow py-1 items-center px-2"},[o[3]||(o[3]=e("i",{class:"las la-print text-xl"},null,-1)),e("span",A,t(r.__("Print")),1)])])])]),e("div",O,[e("div",Q,[p(x,{field:n.sortField},null,8,["field"])])]),e("div",T,[e("div",z,[e("div",E,[e("div",H,[e("ul",null,[e("li",G,t(r.__("Date Range : {date1} - {date2}").replace("{date1}",n.startDateField.value).replace("{date2}",n.endDateField.value)),1),e("li",I,t(r.__("Document : Best Products")),1),e("li",J,t(r.__("By : {user}").replace("{user}",n.ns.user.username)),1)])]),e("div",null,[e("img",{class:"w-24",src:h.storeLogo,alt:h.storeName},null,8,K)])])]),e("div",M,[e("div",W,[e("div",X,[e("table",Y,[e("thead",Z,[e("tr",null,[e("th",$,t(r.__("Product")),1),e("th",ee,t(r.__("Unit")),1),e("th",te,t(r.__("Quantity")),1),e("th",se,t(r.__("Value")),1),e("th",re,t(r.__("Progress")),1)])]),n.report?(l(),a("tbody",oe,[(l(!0),a(F,null,C(n.report.current.products,(s,g)=>(l(),a("tr",{key:g,class:_(s.evolution==="progress"?"bg-success-primary":"bg-error-primary")},[e("td",ne,t(s.name),1),e("td",le,t(s.unit_name),1),e("td",ae,[e("div",ie,[e("span",null,[e("span",null,t(s.quantity),1)]),e("span",{class:_([s.evolution==="progress"?"text-success-tertiary":"text-danger-light-tertiary","text-xs"])},[s.evolution==="progress"?(l(),a("span",de,"+")):d("",!0),u(" "+t(s.quantity-s.old_quantity),1)],2)])]),e("td",ce,[e("div",_e,[e("span",null,t(r.nsCurrency(s.total_price)),1),e("span",{class:_([s.evolution==="progress"?"text-success-tertiary":"text-danger-light-tertiary","text-xs"])},[s.evolution==="progress"?(l(),a("span",ue,"+")):d("",!0),u(" "+t(r.nsCurrency(s.total_price-s.old_total_price)),1)],2)])]),e("td",{class:_([s.evolution==="progress"?"text-success-tertiary":"text-error-light-tertiary","p-2 border text-right"])},[s.evolution==="progress"?(l(),a("span",pe,[u(t(s.difference.toFixed(2))+"% ",1),o[4]||(o[4]=e("i",{class:"las la-arrow-up"},null,-1))])):d("",!0),s.evolution==="regress"?(l(),a("span",he,[u(t(s.difference.toFixed(2))+"% ",1),o[5]||(o[5]=e("i",{class:"las la-arrow-down"},null,-1))])):d("",!0)],2)],2))),128)),n.report.current.products.length===0?(l(),a("tr",me,[e("td",be,t(r.__("No results to show.")),1)])):d("",!0)])):d("",!0),n.report?d("",!0):(l(),a("tbody",xe,[e("tr",null,[e("td",ge,t(r.__("Start by choosing a range and loading the report.")),1)])])),n.report?(l(),a("tfoot",ye,[e("tr",null,[o[6]||(o[6]=e("td",{colspan:"3",class:"p-2 border"},null,-1)),e("td",fe,t(r.nsCurrency(n.report.current.total_price)),1),o[7]||(o[7]=e("td",{class:"p-2 border text-right"},null,-1))])])):d("",!0)])])])])])])}const Re=D(N,[["render",ve]]);export{Re as default};
