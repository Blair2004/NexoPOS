import{F as w,n as d,b,a as u}from"./bootstrap-0aabbab9.js";import{_ as r}from"./currency-47ec5b79.js";import{w as F}from"./npm~@vue~runtime-dom_-a668b91e.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";import{f as T}from"./npm~rxjs-a7e91008.js";import{ae as m,a6 as s,z as t,A as i,F as V,ac as B,x as v,y as a,c as f,ax as y,H as R}from"./npm~@vue~runtime-core_-ff0bdc0c.js";import{U as p}from"./npm~@vue~shared_-82b01912.js";import"./npm~lodash-f7a36ac5.js";import"./npm~@ckeditor~ckeditor5-build-classic_-a8abd726.js";import"./npm~laravel-echo-7ac8f47a.js";import"./npm~pusher-js-7b18aad5.js";import"./npm~axios-0ec1b34a.js";import"./npm~form-data-87061074.js";import"./npm~chart.js-3fed1729.js";import"./npm~moment-fbc5633a.js";import"./npm~vue-6a0d7c4c.js";import"./npm~@vue~compiler-dom_-04241bb4.js";import"./npm~@vue~compiler-core_-2a2ce8c7.js";import"./npm~@vue~reactivity_-481192b6.js";import"./npm~rx-1641e2f8.js";import"./npm~@wordpress~hooks_-18172e20.js";import"./npm~tslib-f3101d7c.js";import"./npm~numeral-faf61dd1.js";import"./npm~currency.js-57f74176.js";const X={name:"ns-login",props:["showRecoveryLink","showRegisterButton"],data(){return{fields:[],xXsrfToken:null,validation:new w,isSubitting:!1}},mounted(){T({login:d.get("/api/fields/ns.login"),csrf:d.get("/sanctum/csrf-cookie")}).subscribe({next:o=>{this.fields=this.validation.createFields(o.login),this.xXsrfToken=d.response.config.headers["X-XSRF-TOKEN"],setTimeout(()=>b.doAction("ns-login-mounted",this),100)},error:o=>{u.error(o.message||r("An unexpected error occurred."),r("OK"),{duration:0}).subscribe()}})},methods:{__:r,signIn(){if(!this.validation.validateFields(this.fields))return u.error(r("Unable to proceed the form is not valid.")).subscribe();this.validation.disableFields(this.fields),b.applyFilters("ns-login-submit",!0)&&(this.isSubitting=!0,d.post("/auth/sign-in",this.validation.getValue(this.fields),{headers:{"X-XSRF-TOKEN":this.xXsrfToken}}).subscribe({next:e=>{document.location=e.data.redirectTo},error:e=>{this.isSubitting=!1,this.validation.enableFields(this.fields),e.data&&this.validation.triggerFieldsErrors(this.fields,e.data),u.error(e.message||r("An unexpected error occured.")).subscribe()}}))}}},N={class:"ns-box rounded shadow overflow-hidden transition-all duration-100"},C={class:"ns-box-body"},K={class:"p-3 -my-2"},j={key:0,class:"flex items-center justify-center py-10"},A={key:1,class:"flex w-full items-center justify-center py-4"},E={href:"/password-lost",class:"hover:underline text-blue-600 text-sm"},I={class:"flex justify-between items-center border-t ns-box-footer p-3"},L={key:0};function z(o,e,_,H,l,n){const x=m("ns-field"),h=m("ns-spinner"),g=m("ns-button");return s(),t("div",N,[i("div",C,[i("div",K,[l.fields.length>0?(s(),t("div",{key:0,class:"py-2 fade-in-entrance anim-duration-300",onKeyup:e[0]||(e[0]=F(c=>n.signIn(),["enter"]))},[(s(!0),t(V,null,B(l.fields,(c,k)=>(s(),v(x,{key:k,field:c},null,8,["field"]))),128))],32)):a("",!0)]),l.fields.length===0?(s(),t("div",j,[f(h,{border:"4",size:"16"})])):a("",!0),_.showRecoveryLink?(s(),t("div",A,[i("a",E,p(n.__("Password Forgotten ?")),1)])):a("",!0)]),i("div",I,[i("div",null,[f(g,{onClick:e[1]||(e[1]=c=>n.signIn()),class:"justify-between",type:"info"},{default:y(()=>[l.isSubitting?(s(),v(h,{key:0,class:"mr-2",size:"6",border:"2"})):a("",!0),i("span",null,p(n.__("Sign In")),1)]),_:1})]),_.showRegisterButton?(s(),t("div",L,[f(g,{link:!0,href:"/sign-up",type:"success"},{default:y(()=>[R(p(n.__("Register")),1)]),_:1})])):a("",!0)])])}const ue=S(X,[["render",z]]);export{ue as default};
