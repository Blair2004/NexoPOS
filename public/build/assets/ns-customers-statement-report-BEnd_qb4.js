import{_ as c,n as x}from"./currency-Dtag6qPd.js";import{_ as p}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as b,o as l,c as n,a as e,f as i,t as s,e as h,F as f,b as g}from"./runtime-core.esm-bundler-VrNrzzXC.js";const y={name:"ns-customers-statement-report",props:["storeLogo","storeName","search-url"],data(){return{startDateField:{type:"datetimepicker",name:"startDate",value:moment(ns.date.current).startOf("day")},endDateField:{type:"datetimepicker",name:"endDate",value:moment(ns.date.current).endOf("day")},selectedCustomer:null,ns:window.ns,report:{total_purchases:0,total_orders:0,account_amount:0,owed_amount:0,credit_limit_amount:0,orders:[],wallet_transactions:[]}}},mounted(){},computed:{selectedCustomerName(){return this.selectedCustomer===null?c("N/A"):`${this.selectedCustomer.first_name} ${this.selectedCustomer.last_name}`}},methods:{__:c,nsCurrency:x,printSaleReport(){this.$htmlToPaper("report")},handleSelectedCustomer(a){this.selectedCustomer=a,nsHttpClient.post(`/api/reports/customers-statement/${a.id}`,{rangeStarts:this.startDateField.value,rangeEnds:this.endDateField.value}).subscribe({next:r=>{this.report=r},error:r=>{nsSnackBar.error(r.message||c("An unexpected error occured")).subscribe()}})}}},v={id:"report-section"},C={class:"flex -mx-2"},w={class:"px-2"},k={class:"px-2"},D={key:0,class:"px-2"},S={class:"ns-button"},F={class:"pl-2"},N={class:"px-2"},B={class:"ns-button"},L={class:"pl-2"},O={id:"report",class:"anim-duration-500 fade-in-entrance"},R={class:"flex w-full"},T={class:"my-4 flex justify-between w-full"},j={class:"text-primary"},A={class:"pb-1 border-b border-dashed border-box-edge"},P={class:"pb-1 border-b border-dashed border-box-edge"},V={class:"pb-1 border-b border-dashed border-box-edge"},E={class:"pb-1 border-b border-dashed border-box-edge"},H=["src","alt"],U={class:"shadow rounded"},W={class:"ns-box"},q={class:"text-center ns-box-header p-2"},z={class:"font-bold"},G={class:"border-b ns-box-body"},I={class:"table ns-table w-full"},J={class:"text-primary"},K={class:""},M={width:"200",class:"font-semibold p-2 border text-left bg-success-secondary border-box-edge text-white print:text-black"},Q={class:"p-2 border text-right border-box-edge"},X={class:""},Y={width:"200",class:"font-semibold p-2 border text-left bg-warning-secondary border-box-edge text-white print:text-black"},Z={class:"p-2 border text-right border-box-edge"},$={class:""},ee={width:"200",class:"font-semibold p-2 border text-left bg-info-secondary border-box-edge text-white print:text-black"},te={class:"p-2 border text-right border-box-edge"},se={class:""},re={width:"200",class:"font-semibold p-2 border text-left border-box-edge"},oe={class:"p-2 border text-right border-box-edge"},de={class:""},le={width:"200",class:"font-semibold p-2 border text-left border-box-edge"},ne={class:"p-2 border text-right border-box-edge"},ae={key:0,class:"shadow rounded overflow-hidden"},ce={class:"ns-box"},ie={class:"text-center ns-box-header p-2"},_e={class:"font-bold"},ue={class:"border-b ns-box-body"},be={class:"table ns-table w-full"},he={class:"p-2 border text-left"},me={class:"p-2 border text-right"},xe={class:"text-primary"},pe={width:"200",class:"font-semibold p-2 border text-left"},fe={class:"p-2 border text-right"};function ge(a,r,_,ye,o,t){const u=b("ns-field"),m=b("ns-search");return l(),n("div",v,[e("div",C,[e("div",w,[i(u,{field:o.startDateField},null,8,["field"])]),e("div",k,[i(u,{field:o.endDateField},null,8,["field"])]),o.selectedCustomer?(l(),n("div",D,[e("div",S,[e("button",{onClick:r[0]||(r[0]=d=>t.handleSelectedCustomer(o.selectedCustomer)),class:"rounded flex justify-between text-primary shadow py-1 items-center px-2"},[r[3]||(r[3]=e("i",{class:"las la-sync-alt text-xl"},null,-1)),e("span",F,s(t.__("Load")),1)])])])):h("",!0),e("div",N,[e("div",B,[e("button",{onClick:r[1]||(r[1]=d=>t.printSaleReport()),class:"rounded flex justify-between text-primary shadow py-1 items-center px-2"},[r[4]||(r[4]=e("i",{class:"las la-print text-xl"},null,-1)),e("span",L,s(t.__("Print")),1)])])])]),e("div",null,[i(m,{placeholder:t.__("Search Customer..."),label:["first_name","last_name"],value:"id",onSelect:r[2]||(r[2]=d=>t.handleSelectedCustomer(d)),url:a.searchUrl},null,8,["placeholder","url"])]),e("div",O,[e("div",R,[e("div",T,[e("div",j,[e("ul",null,[e("li",A,s(t.__("Range : {date1} â€” {date2}").replace("{date1}",this.startDateField.value).replace("{date2}",this.endDateField.value)),1),e("li",P,s(t.__("Document : Customer Statement")),1),e("li",V,s(t.__("Customer : {selectedCustomerName}").replace("{selectedCustomerName}",t.selectedCustomerName)),1),e("li",E,s(t.__("By : {user}").replace("{user}",o.ns.user.username)),1)])]),e("div",null,[e("img",{class:"w-24",src:_.storeLogo,alt:_.storeName},null,8,H)])])]),e("div",U,[e("div",W,[e("div",q,[e("h3",z,s(t.__("Summary")),1)]),e("div",G,[e("table",I,[e("tbody",J,[e("tr",K,[e("td",M,s(t.__("Total Purchases")),1),e("td",Q,s(t.nsCurrency(o.report.purchases_amount)),1)]),e("tr",X,[e("td",Y,s(t.__("Due Amount")),1),e("td",Z,s(t.nsCurrency(o.report.owed_amount)),1)]),e("tr",$,[e("td",ee,s(t.__("Wallet Balance")),1),e("td",te,s(t.nsCurrency(o.report.account_amount)),1)]),e("tr",se,[e("td",re,s(t.__("Credit Limit")),1),e("td",oe,s(t.nsCurrency(o.report.credit_limit_amount)),1)]),e("tr",de,[e("td",le,s(t.__("Total Orders")),1),e("td",ne,s(o.report.total_orders),1)])])])])])]),r[5]||(r[5]=e("br",null,null,-1)),r[6]||(r[6]=e("br",null,null,-1)),o.report.orders.length>0?(l(),n("div",ae,[e("div",ce,[e("div",ie,[e("h3",_e,s(t.__("Orders")),1)]),e("div",ue,[e("table",be,[e("thead",null,[e("tr",null,[e("th",he,s(t.__("Order")),1),e("th",me,s(t.__("Total")),1)])]),e("tbody",xe,[(l(!0),n(f,null,g(o.report.orders,d=>(l(),n("tr",{class:"",key:d.id},[e("td",pe,s(d.code),1),e("td",fe,s(t.nsCurrency(d.total)),1)]))),128))])])])])])):h("",!0)])])}const ke=p(y,[["render",ge]]);export{ke as default};
