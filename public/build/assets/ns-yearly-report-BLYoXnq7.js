import{b as y,n as m,h as g}from"./bootstrap-BvuHheHc.js";import{e as w,c as D}from"./components-DEhIxHMz.js";import{g as R,n as S}from"./ns-prompt-popup-CgPenOts.js";import{_ as b}from"./lang-BINodpp-.js";import{n as N}from"./currency-COpKd-rX.js";import{v as B}from"./runtime-dom.esm-bundler-DaZ-XdMB.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as k,c as n,o,g as T,a as x,w as a,i as v,t as s,b as e,B as z,f,F as u,e as _}from"./runtime-core.esm-bundler-D4l6Snf1.js";import"./chart-CFvJmF2u.js";import"./ns-avatar-BDINLW_a.js";import"./ns-avatar-image-DCGLscGw.js";const O={name:"ns-yearly-report",props:["storeLogo","storeName"],mounted(){this.timezone!==""&&(this.year=ns.date.getMoment().format("Y"),this.loadReport())},components:{nsDatepicker:D,nsNotice:R,nsDateTimePicker:w},data(){return{startDate:g(),endDate:g(),report:{},timezone:ns.date.timeZone,year:"",ns:window.ns,labels:["month_paid_orders","month_taxes","month_expenses","month_income"]}},computed:{totalDebit(){return 0},totalCredit(){return 0}},methods:{__:b,nsCurrency:N,setStartDate(i){this.startDate=i.format()},setEndDate(i){this.endDate=i.format()},printSaleReport(){this.$htmlToPaper("annual-report")},sumOf(i){return Object.values(this.report).length>0?Object.values(this.report).map(c=>parseFloat(c[i])||0).reduce((c,p)=>c+p):0},recomputeForSpecificYear(){Popup.show(S,{title:b("Would you like to proceed ?"),message:b("The report will be computed for the current year, a job will be dispatched and you'll be informed once it's completed."),onAction:i=>{i&&y.post("/api/reports/compute/yearly",{year:this.year}).subscribe(c=>{m.success(c.message)},c=>{m.success(c.message||b("An unexpected error has occurred."))})}})},getReportForMonth(i){return this.report[i]},loadReport(){const i=this.year;y.post("/api/reports/annual-report",{year:i}).subscribe(c=>{this.report=c},c=>{m.error(c.message).subscribe()})}}},P={class:"px-4"},V={key:1,class:"flex -mx-2"},Y={class:"px-2"},A=["placeholder"],M={class:"px-2 flex"},j={class:"pl-2"},E={class:"px-2 flex"},L={class:"pl-2"},J={class:"px-2 flex"},H={class:"pl-2"},U={key:2,id:"annual-report",class:"anim-duration-500 fade-in-entrance"},I={class:"flex w-full"},W={class:"my-4 flex justify-between w-full"},Z={class:"text-fontcolor-soft"},q={class:"pb-1 border-b border-dashed"},G={class:"pb-1 border-b border-dashed"},K={class:"pb-1 border-b border-dashed"},Q=["src","alt"],X={class:"bg-box-background shadow rounded my-4 overflow-hidden"},$={class:"border-b border-box-edge overflow-auto"},ee={class:"table ns-table w-full"},te={class:""},re={width:"150",class:"border p-2 text-right"},se={width:"150",class:"border p-2 text-right"},le={width:"150",class:"border p-2 text-right"},oe={width:"150",class:"border p-2 text-right"},ne={class:"border p-2 text-left"},ce={class:"border p-2 text-left"},de={class:"text-left border p-2"},ue={class:"text-left border p-2"},_e={class:"text-left border p-2"},ie={class:"text-left border p-2"},ae={class:"text-left border p-2"},pe={class:"text-left border p-2"},be={class:"text-left border p-2"},he={class:"text-left border p-2"},me={class:"text-left border p-2"},xe={class:"text-left border p-2"},fe={class:"text-left border p-2"};function ye(i,c,p,ge,t,r){const C=k("ns-notice"),h=k("ns-button");return o(),n("div",P,[t.timezone===""?(o(),T(C,{key:0,color:"error"},{title:a(()=>[v(s(r.__("An Error Has Occured")),1)]),description:a(()=>[v(s(r.__("Unable to load the report as the timezone is not set on the settings.")),1)]),_:1})):x("",!0),t.timezone!==""?(o(),n("div",V,[e("div",Y,[z(e("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=l=>t.year=l),placeholder:r.__("Year"),class:"outline-hidden text-fontcolor rounded border-input-edge bg-input-background border p-2"},null,8,A),[[B,t.year]])]),e("div",M,[f(h,{onClick:c[1]||(c[1]=l=>r.loadReport())},{default:a(()=>[c[4]||(c[4]=e("i",{class:"las la-sync-alt text-xl"},null,-1)),e("span",j,s(r.__("Load")),1)]),_:1})]),e("div",E,[f(h,{onClick:c[2]||(c[2]=l=>r.printSaleReport())},{default:a(()=>[c[5]||(c[5]=e("i",{class:"las la-print text-xl"},null,-1)),e("span",L,s(r.__("Print")),1)]),_:1})]),e("div",J,[f(h,{onClick:c[3]||(c[3]=l=>r.recomputeForSpecificYear())},{default:a(()=>[c[6]||(c[6]=e("i",{class:"las la-sync-alt text-xl"},null,-1)),e("span",H,s(r.__("Recompute")),1)]),_:1})])])):x("",!0),t.timezone!==""?(o(),n("div",U,[e("div",I,[e("div",W,[e("div",Z,[e("ul",null,[e("li",q,s(r.__("Date : {date}").replace("{date}",t.ns.date.current)),1),e("li",G,s(r.__("Document : Yearly Report")),1),e("li",K,s(r.__("By : {user}").replace("{user}",t.ns.user.username)),1)])]),e("div",null,[e("img",{class:"w-24",src:p.storeLogo,alt:p.storeName},null,8,Q)])])]),e("div",X,[e("div",$,[e("table",ee,[e("thead",te,[e("tr",null,[c[7]||(c[7]=e("th",{width:"100",class:"border p-2 text-left"},null,-1)),e("th",re,s(r.__("Sales")),1),e("th",se,s(r.__("Taxes")),1),e("th",le,s(r.__("Expenses")),1),e("th",oe,s(r.__("Income")),1)])]),e("tbody",null,[e("tr",null,[e("td",ne,s(r.__("January")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[1]?t.report[1][l]:0)),1))),128))]),e("tr",null,[e("td",ce,s(r.__("Febuary")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[2]?t.report[2][l]:0)),1))),128))]),e("tr",null,[e("td",de,s(r.__("March")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[3]?t.report[3][l]:0)),1))),128))]),e("tr",null,[e("td",ue,s(r.__("April")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[4]?t.report[4][l]:0)),1))),128))]),e("tr",null,[e("td",_e,s(r.__("May")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[5]?t.report[5][l]:0)),1))),128))]),e("tr",null,[e("td",ie,s(r.__("June")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[6]?t.report[6][l]:0)),1))),128))]),e("tr",null,[e("td",ae,s(r.__("July")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[7]?t.report[7][l]:0)),1))),128))]),e("tr",null,[e("td",pe,s(r.__("August")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[8]?t.report[8][l]:0)),1))),128))]),e("tr",null,[e("td",be,s(r.__("September")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[9]?t.report[9][l]:0)),1))),128))]),e("tr",null,[e("td",he,s(r.__("October")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[10]?t.report[10][l]:0)),1))),128))]),e("tr",null,[e("td",me,s(r.__("November")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[11]?t.report[11][l]:0)),1))),128))]),e("tr",null,[e("td",xe,s(r.__("December")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(t.report[12]?t.report[12][l]:0)),1))),128))])]),e("tfoot",null,[e("tr",null,[e("td",fe,s(r.__("Total")),1),(o(!0),n(u,null,_(t.labels,(l,d)=>(o(),n("td",{key:d,class:"border p-2 text-right"},s(r.nsCurrency(r.sumOf(l))),1))),128))])])])])])])):x("",!0)])}const ze=F(O,[["render",ye]]);export{ze as default};
