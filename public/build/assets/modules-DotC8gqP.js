import{b as p,n as h,m as w,P as M}from"./bootstrap-CTGbPB8U.js";import{_ as f}from"./lang-BINodpp-.js";import{c as k}from"./ns-prompt-popup-Clv0LWBA.js";import{v as C}from"./runtime-dom.esm-bundler-BhgnMY0Q.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as P,c,o as i,b as e,t as a,B,a as u,F as E,e as F,i as m,g as b,w as v,f as y}from"./runtime-core.esm-bundler-lHXuXxGr.js";import"./currency-DQAAGb0G.js";import"./chart-ka-CGrsc.js";const L={name:"ns-modules",props:["url","upload"],data(){return{rawModules:[],searchPlaceholder:f('Press "/" to search modules'),total_enabled:0,total_disabled:0,total_invalid:0,searchText:"",searchTimeOut:null,currentLocale:ns.language}},mounted(){this.loadModules().subscribe(),document.addEventListener("keypress",l=>{l.key==="/"&&this.$refs.searchField!==null&&setTimeout(()=>{this.$refs.searchField.select()},1)})},watch:{},computed:{noModules(){return Object.values(this.modules).length===0},modules(){if(this.searchText.length>0){const l=Object.values(this.rawModules).filter(r=>{const n=new RegExp(this.searchText,"gi"),d=r.name.match(n);return d!==null?d.length>0:!1}),s=new Object;for(let r=0;r<l.length;r++)s[l[r].namespace]=l[r];return s}return this.rawModules},noModuleMessage(){return f("There is nothing to display here.")}},methods:{__:f,openPopupDetails(l){M.show(k,{title:f("{module}").replace("{module}",l.name),message:typeof l.description=="object"?l.description[this.currentLocale]:l.description})},download(l){document.location="/dashboard/modules/download/"+l.namespace},truncateText(l,s,r="..."){console.log({text:l});let n=l.split(" ");return n.length>s&&(n=n.slice(0,s),n.push(r)),n.join(" ")},countWords(l){return l.split(" ").length},reloadModules(l){return this.loadModules(this.url+"/"+l).subscribe()},refreshModules(){this.loadModules().subscribe()},enableModule(l){const s=`${this.url}/${l.namespace}/enable`;p.put(s).subscribe({next:async r=>{h.success(r.message),this.loadModules().subscribe({next:n=>{document.location.reload()},error:n=>{h.error(n.message)}})},error:r=>{h.error(r.message)}})},disableModule(l){const s=`${this.url}/${l.namespace}/disable`;p.put(s).subscribe({next:r=>{h.success(r.message),this.loadModules().subscribe({next:n=>{document.location.reload()},error:n=>{h.error(n.message)}})},error:r=>{h.error(r.message)}})},loadModules(l){return p.get(l||this.url).pipe(w(s=>(this.rawModules=s.modules,this.total_enabled=s.total_enabled,this.total_disabled=s.total_disabled,this.total_invalid=s.total_invalid,s)))},removeModule(l){if(confirm(f('Would you like to delete "{module}"? All data created by the module might also be deleted.').replace("{module}",l.name))){const s=`${this.url}/${l.namespace}/delete`;p.delete(s).subscribe({next:r=>{this.loadModules().subscribe({next:n=>{document.location.reload()}})},error:r=>{h.error(r.message,null,{duration:5e3})}})}}}},N={id:"module-wrapper",class:"flex-auto flex flex-col pb-4"},R={class:"flex flex-col lg:flex-row md:justify-between md:items-center"},V={class:"flex flex-col md:flex-row md:justify-between md:items-center -mx-2"},D={class:"px-2"},W={class:"ns-button mb-2"},S={class:"mx-2"},A={class:"px-2"},U={class:"ns-button mb-2"},H=["href"],I={class:"px-2 w-auto"},q={class:"input-group mb-2 shadow border-2 info rounded overflow-hidden"},z=["placeholder"],G={class:"header-tabs flex -mx-4 flex-wrap"},J={class:"px-4 text-xs text-blue-500 font-semibold hover:underline"},K={class:"px-4 text-xs text-blue-500 font-semibold hover:underline"},Q={class:"px-4 text-xs text-blue-500 font-semibold hover:underline"},X={class:"module-section flex-auto flex flex-wrap -mx-4"},Y={key:0,class:"p-4 flex-auto flex"},Z={class:"flex border-dashed border w-full border-secondary h-32 flex-auto justify-center items-center"},j={class:"text-fontcolor"},$={key:1,class:"p-4 flex-auto flex"},O={class:"flex h-full flex-auto border-dashed border-2 border-box-edge bg-surface justify-center items-center"},ee={class:"font-bold text-xl text-fontcolor text-center"},se={class:"ns-modules rounded shadow overflow-hidden ns-box"},te={class:"module-head h-32 p-2"},le={class:"font-semibold text-lg"},oe={class:"text-xs flex justify-between"},re={class:"flex justify-between"},ae={key:0,class:"text-error-tertiary mx-2"},ne={key:0,class:"py-2 text-sm"},de=["onClick"],ie={key:1,class:"py-2 text-sm"},ce=["onClick"],ue={class:"ns-box-footer border-t p-2 flex justify-between"},he={class:"flex -mx-1"},_e={class:"px-1 flex -mx-1"},fe={class:"px-1 flex"},xe={class:"px-1 flex"};function pe(l,s,r,n,d,o){const x=P("ns-button");return i(),c("div",N,[e("div",R,[e("div",V,[e("span",D,[e("div",W,[e("a",{onClick:s[0]||(s[0]=t=>o.refreshModules()),class:"items-center justify-center rounded cursor-pointer shadow flex px-3 py-1"},[s[5]||(s[5]=e("i",{class:"las la-sync"},null,-1)),e("span",S,a(o.__("Refresh")),1)])])]),e("span",A,[e("div",U,[e("a",{href:r.upload,class:"flex items-center justify-center rounded cursor-pointer shadow px-3 py-1"},[e("span",null,a(o.__("Upload")),1),s[6]||(s[6]=e("i",{class:"las la-angle-right"},null,-1))],8,H)])]),e("div",I,[e("div",q,[B(e("input",{ref:"searchField",placeholder:d.searchPlaceholder,"onUpdate:modelValue":s[1]||(s[1]=t=>d.searchText=t),type:"text",class:"w-full md:w-60 outline-hidden py-1 px-2"},null,8,z),[[C,d.searchText]])])])]),e("div",G,[e("div",J,[e("a",{href:"javascript:void(0)",onClick:s[2]||(s[2]=t=>o.reloadModules("enabled"))},a(o.__("Enabled"))+"("+a(d.total_enabled)+")",1)]),e("div",K,[e("a",{href:"javascript:void(0)",onClick:s[3]||(s[3]=t=>o.reloadModules("disabled"))},a(o.__("Disabled"))+" ("+a(d.total_disabled)+")",1)]),e("div",Q,[e("a",{href:"javascript:void(0)",onClick:s[4]||(s[4]=t=>o.reloadModules("invalid"))},a(o.__("Invalid"))+" ("+a(d.total_invalid)+")",1)])])]),e("div",X,[o.noModules&&d.searchText.length===0?(i(),c("div",Y,[e("div",Z,[e("div",j,a(o.noModuleMessage),1)])])):u("",!0),o.noModules&&d.searchText.length>0?(i(),c("div",$,[e("div",O,[e("h2",ee,a(o.__("No modules matches your search term.")),1)])])):u("",!0),(i(!0),c(E,null,F(o.modules,(t,g)=>(i(),c("div",{class:"px-4 w-full md:w-1/2 lg:w-1/3 xl:1/4 py-4",key:g},[e("div",se,[e("div",te,[e("h3",le,a(t.name),1),e("div",oe,[e("div",re,[e("span",null,a(t.author),1),t["psr-4-compliance"]===!1?(i(),c("span",ae," â€” "+a(o.__("not PSR-4 Compliant")),1)):u("",!0)]),e("strong",null,"v"+a(t.version),1)]),typeof t.description=="string"?(i(),c("p",ne,[m(a(o.truncateText(t.description,20,"..."))+" ",1),o.countWords(t.description)>20?(i(),c("a",{key:0,class:"text-xs text-info-tertiary hover:underline",onClick:_=>o.openPopupDetails(t),href:"javascript:void(0)"},"["+a(o.__("Read More"))+"]",9,de)):u("",!0)])):u("",!0),typeof t.description=="object"?(i(),c("p",ie,[m(a(o.truncateText(t.description[d.currentLocale]||t.description.en,20,"..."))+" ",1),o.countWords(t.description[d.currentLocale]||t.description.en)>20?(i(),c("a",{key:0,class:"text-xs text-info-tertiary hover:underline",onClick:_=>o.openPopupDetails(t),href:"javascript:void(0)"},"["+a(o.__("Read More"))+"]",9,ce)):u("",!0)])):u("",!0)]),e("div",ue,[t.enabled?u("",!0):(i(),b(x,{key:0,disabled:t.autoloaded||t["psr-4-compliance"]===!1,onClick:_=>o.enableModule(t),type:"default"},{default:v(()=>[m(a(o.__("Enable")),1)]),_:2},1032,["disabled","onClick"])),t.enabled?(i(),b(x,{key:1,disabled:t.autoloaded||t["psr-4-compliance"]===!1,onClick:_=>o.disableModule(t),type:"warning"},{default:v(()=>[m(a(o.__("Disable")),1)]),_:2},1032,["disabled","onClick"])):u("",!0),e("div",he,[e("div",_e,[e("div",fe,[y(x,{disabled:t.autoloaded,onClick:_=>o.download(t),type:"info"},{default:v(()=>s[7]||(s[7]=[e("i",{class:"las la-archive"},null,-1)])),_:2,__:[7]},1032,["disabled","onClick"])]),e("div",xe,[y(x,{disabled:t.autoloaded,onClick:_=>o.removeModule(t),type:"error"},{default:v(()=>s[8]||(s[8]=[e("i",{class:"las la-trash"},null,-1)])),_:2,__:[8]},1032,["disabled","onClick"])])])])])])]))),128))])])}const Ce=T(L,[["render",pe]]);export{Ce as default};
