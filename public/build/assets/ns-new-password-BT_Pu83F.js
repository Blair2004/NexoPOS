import{_ as n}from"./lang-BINodpp-.js";import{n as o,k as p,b as r,i as w,F as k}from"./bootstrap-DI8pXSaz.js";import{_ as y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as l,c as a,o as e,b as d,a as c,F,e as x,g as h,f as _,w as S,t as N}from"./runtime-core.esm-bundler-DUdZl5j1.js";import"./currency-BCJk0SN4.js";import"./chart-BXKSDqJb.js";import"./runtime-dom.esm-bundler-BJBE8XOq.js";const T={name:"ns-login",props:["token","user"],data(){return{fields:[],xXsrfToken:null,validation:new k,isSubitting:!1}},mounted(){w([r.get("/api/fields/ns.new-password"),r.get("/sanctum/csrf-cookie")]).subscribe(t=>{this.fields=this.validation.createFields(t[0]),this.xXsrfToken=r.response.config.headers["X-XSRF-TOKEN"],setTimeout(()=>p.doAction("ns-login-mounted",this),100)},t=>{o.error(t.message||n("An unexpected error occurred."),n("OK"),{duration:0})})},methods:{__:n,submitNewPassword(){if(!this.validation.validateFields(this.fields))return o.error(n("Unable to proceed the form is not valid."));this.validation.disableFields(this.fields),p.applyFilters("ns-new-password-submit",!0)&&(this.isSubitting=!0,r.post(`/auth/new-password/${this.user}/${this.token}`,this.validation.getValue(this.fields),{headers:{"X-XSRF-TOKEN":this.xXsrfToken}}).subscribe(s=>{o.success(s.message),setTimeout(()=>{document.location=s.data.redirectTo},500)},s=>{this.isSubitting=!1,this.validation.enableFields(this.fields),s.data&&this.validation.triggerFieldsErrors(this.fields,s.data),o.error(s.message)}))}}},V={class:"ns-box rounded shadow overflow-hidden transition-all duration-100"},X={class:"p-3"},B={key:0,class:"py-2 fade-in-entrance anim-duration-300"},C={key:0,class:"flex items-center justify-center py-10"},E={class:"flex justify-end items-center bg-gray-200 p-3"};function P(t,s,j,K,i,u){const b=l("ns-field"),f=l("ns-spinner"),g=l("ns-button");return e(),a("div",V,[d("div",X,[i.fields.length>0?(e(),a("div",B,[(e(!0),a(F,null,x(i.fields,(m,v)=>(e(),h(b,{key:v,field:m},null,8,["field"]))),128))])):c("",!0)]),i.fields.length===0?(e(),a("div",C,[_(f,{border:"4",size:"16"})])):c("",!0),d("div",E,[d("div",null,[_(g,{onClick:s[0]||(s[0]=m=>u.submitNewPassword()),class:"justify-between",type:"info"},{default:S(()=>[i.isSubitting?(e(),h(f,{key:0,class:"mr-2",size:"6",border:"2"})):c("",!0),d("span",null,N(u.__("Save Password")),1)]),_:1})])])])}const L=y(T,[["render",P]]);export{L as default};
