import{P as g,b as m,d as c,D as M,v as k}from"./bootstrap-75140020.js";import{_ as h}from"./currency-feccde3d.js";import{c as C}from"./ns-prompt-popup-1d037733.js";import"./index.es-25aa42ee.js";import{_ as T}from"./_plugin-vue_export-helper-c27b6911.js";import{r as P,o as i,c as u,a as e,t as d,B,e as _,F as D,b as E,i as p,g as v,w as b,f as w}from"./runtime-core.esm-bundler-414a078a.js";import"./chart-2ccf8ff7.js";const N={name:"ns-modules",props:["url","upload"],data(){return{rawModules:[],searchPlaceholder:h('Press "/" to search modules'),total_enabled:0,total_disabled:0,searchText:"",searchTimeOut:null}},mounted(){this.loadModules().subscribe(),document.addEventListener("keypress",s=>{s.key==="/"&&this.$refs.searchField!==null&&setTimeout(()=>{this.$refs.searchField.select()},1)})},watch:{},computed:{noModules(){return Object.values(this.modules).length===0},modules(){if(this.searchText.length>0){const s=Object.values(this.rawModules).filter(t=>{const a=new RegExp(this.searchText,"gi"),n=t.name.match(a);return n!==null?n.length>0:!1}),r=new Object;for(let t=0;t<s.length;t++)r[s[t].namespace]=s[t];return r}return this.rawModules},noModuleMessage(){return h("No module has been uploaded yet.")}},methods:{__:h,openPopupDetails(s){g.show(C,{title:h("{module}").replace("{module}",s.name),message:s.description})},download(s){document.location="/dashboard/modules/download/"+s.namespace},truncateText(s,r,t="..."){let a=s.split(" ");return a.length>r&&(a=a.slice(0,r),a.push(t)),a.join(" ")},countWords(s){return s.split(" ").length},refreshModules(){this.loadModules().subscribe()},enableModule(s){const r=`${this.url}/${s.namespace}/enable`;m.put(r).subscribe({next:async t=>{c.success(t.message).subscribe(),this.loadModules().subscribe({next:a=>{document.location.reload()},error:a=>{c.error(a.message).subscribe()}})},error:t=>{c.error(t.message).subscribe()}})},disableModule(s){const r=`${this.url}/${s.namespace}/disable`;m.put(r).subscribe({next:t=>{c.success(t.message).subscribe(),this.loadModules().subscribe({next:a=>{document.location.reload()},error:a=>{c.error(a.message).subscribe()}})},error:t=>{c.error(t.message).subscribe()}})},loadModules(){return m.get(this.url).pipe(M(s=>(this.rawModules=s.modules,this.total_enabled=s.total_enabled,this.total_disabled=s.total_disabled,s)))},removeModule(s){if(confirm(h('Would you like to delete "{module}"? All data created by the module might also be deleted.').replace("{module}",s.name))){const r=`${this.url}/${s.namespace}/delete`;m.delete(r).subscribe({next:t=>{this.loadModules().subscribe({next:a=>{document.location.reload()}})},error:t=>{c.error(t.message,null,{duration:5e3}).subscribe()}})}}}},F={id:"module-wrapper",class:"flex-auto flex flex-col pb-4"},V={class:"flex flex-col md:flex-row md:justify-between md:items-center"},R={class:"flex flex-col md:flex-row md:justify-between md:items-center -mx-2"},W={class:"px-2"},A={class:"ns-button mb-2"},S=e("i",{class:"las la-sync"},null,-1),U={class:"mx-2"},H={class:"px-2"},L={class:"ns-button mb-2"},q=["href"],z=e("i",{class:"las la-angle-right"},null,-1),G={class:"px-2 w-auto"},I={class:"input-group mb-2 shadow border-2 info rounded overflow-hidden"},J=["placeholder"],K={class:"header-tabs flex -mx-4 flex-wrap"},Q={class:"px-4 text-xs text-blue-500 font-semibold hover:underline"},X={href:"#"},Y={class:"px-4 text-xs text-blue-500 font-semibold hover:underline"},Z={href:"#"},j={class:"module-section flex-auto flex flex-wrap -mx-4"},$={key:0,class:"p-4 flex-auto flex"},O={class:"flex h-full flex-auto border-dashed border-2 border-box-edge bg-surface justify-center items-center"},ee={class:"font-bold text-xl text-primary text-center"},se={key:1,class:"p-4 flex-auto flex"},te={class:"flex h-full flex-auto border-dashed border-2 border-box-edge bg-surface justify-center items-center"},le={class:"font-bold text-xl text-primary text-center"},oe={class:"ns-modules rounded shadow overflow-hidden ns-box"},re={class:"module-head h-32 p-2"},ae={class:"font-semibold text-lg"},de={class:"text-xs flex justify-between"},ne={class:"py-2 text-sm"},ie=["onClick"],ce={class:"ns-box-footer border-t p-2 flex justify-between"},ue={class:"flex -mx-1"},he={class:"px-1 flex -mx-1"},_e={class:"px-1 flex"},xe=e("i",{class:"las la-archive"},null,-1),fe={class:"px-1 flex"},me=e("i",{class:"las la-trash"},null,-1);function be(s,r,t,a,n,l){const x=P("ns-button");return i(),u("div",F,[e("div",V,[e("div",R,[e("span",W,[e("div",A,[e("a",{onClick:r[0]||(r[0]=o=>l.refreshModules()),class:"items-center justify-center rounded cursor-pointer shadow flex px-3 py-1"},[S,e("span",U,d(l.__("Refresh")),1)])])]),e("span",H,[e("div",L,[e("a",{href:t.upload,class:"flex items-center justify-center rounded cursor-pointer shadow px-3 py-1"},[e("span",null,d(l.__("Upload")),1),z],8,q)])]),e("div",G,[e("div",I,[B(e("input",{ref:"searchField",placeholder:n.searchPlaceholder,"onUpdate:modelValue":r[1]||(r[1]=o=>n.searchText=o),type:"text",class:"w-full md:w-60 outline-none py-1 px-2"},null,8,J),[[k,n.searchText]])])])]),e("div",K,[e("div",Q,[e("a",X,d(l.__("Enabled"))+"("+d(n.total_enabled)+")",1)]),e("div",Y,[e("a",Z,d(l.__("Disabled"))+" ("+d(n.total_disabled)+")",1)])])]),e("div",j,[l.noModules&&n.searchText.length===0?(i(),u("div",$,[e("div",O,[e("h2",ee,d(l.noModuleMessage),1)])])):_("",!0),l.noModules&&n.searchText.length>0?(i(),u("div",se,[e("div",te,[e("h2",le,d(l.__("No modules matches your search term.")),1)])])):_("",!0),(i(!0),u(D,null,E(l.modules,(o,y)=>(i(),u("div",{class:"px-4 w-full md:w-1/2 lg:w-1/3 xl:1/4 py-4",key:y},[e("div",oe,[e("div",re,[e("h3",ae,d(o.name),1),e("p",de,[e("span",null,d(o.author),1),e("strong",null,"v"+d(o.version),1)]),e("p",ne,[p(d(l.truncateText(o.description,20,"..."))+" ",1),l.countWords(o.description)>20?(i(),u("a",{key:0,class:"text-xs text-info-tertiary hover:underline",onClick:f=>l.openPopupDetails(o),href:"javascript:void(0)"},"["+d(l.__("Read More"))+"]",9,ie)):_("",!0)])]),e("div",ce,[o.enabled?_("",!0):(i(),v(x,{key:0,disabled:o.autoloaded,onClick:f=>l.enableModule(o),type:"info"},{default:b(()=>[p(d(l.__("Enable")),1)]),_:2},1032,["disabled","onClick"])),o.enabled?(i(),v(x,{key:1,disabled:o.autoloaded,onClick:f=>l.disableModule(o),type:"success"},{default:b(()=>[p(d(l.__("Disable")),1)]),_:2},1032,["disabled","onClick"])):_("",!0),e("div",ue,[e("div",he,[e("div",_e,[w(x,{disabled:o.autoloaded,onClick:f=>l.download(o),type:"info"},{default:b(()=>[xe]),_:2},1032,["disabled","onClick"])]),e("div",fe,[w(x,{disabled:o.autoloaded,onClick:f=>l.removeModule(o),type:"error"},{default:b(()=>[me]),_:2},1032,["disabled","onClick"])])])])])])]))),128))])])}const Ce=T(N,[["render",be]]);export{Ce as default};
