import{F as L,b as x,a as g,c as q,T as E,P as w}from"./bootstrap-b8cd97d4.js";import N from"./manage-products-6448a5c6.js";import{_ as c,n as j}from"./currency-dc6217f5.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import{an as C,af as l,G as u,H as r,F as v,al as y,z as R,c as F,aH as B,M as T,e as D,o as M,A as m,aJ as P,am as V}from"./npm~@vue~runtime-core_-0a26b3ab.js";import{V as d,z as k}from"./npm~@vue~shared_-5bb087a6.js";import{r as I,F as U}from"./npm~@vue~reactivity_-26e9e2f4.js";import{c as K,b as S}from"./ns-prompt-popup-4f52d15c.js";import{s as G}from"./select-api-entities-4e4ac6db.js";import"./npm~@dicebear~avatars_-24df7cd3.js";import"./npm~@dicebear~avatars-avataaars-sprites_-796ded10.js";import"./npm~moment-a9aaa855.js";import"./npm~vue2-daterange-picker-c3e32574.js";import"./npm~vuedraggable-45210012.js";import"./npm~vue-upload-component-5c82cdcf.js";import"./npm~lodash-3db1c062.js";import{B as z,f as H}from"./npm~rxjs-eeb06f17.js";import{m as A,l as J}from"./npm~@vue~runtime-dom_-2c8e0ca9.js";import"./npm~laravel-echo-0c2ba8ed.js";import"./npm~pusher-js-bd96ae31.js";import"./npm~@ckeditor~ckeditor5-build-classic_-b5d88964.js";import"./npm~axios-c24e582b.js";import"./npm~chart.js-3fed1729.js";import"./npm~vue-0182d78b.js";import"./npm~@vue~compiler-dom_-ce2c1e21.js";import"./npm~@vue~compiler-core_-745c8708.js";import"./npm~rx-f450d610.js";import"./npm~@wordpress~hooks_-bd0b7221.js";import"./npm~mathjs-b10bd4cd.js";import"./npm~@babel~runtime_-9313f80d.js";import"./npm~decimal.js-d133ee8e.js";import"./npm~complex.js-dc0d19c5.js";import"./npm~fraction.js-cb0643cb.js";import"./npm~typed-function-de33f2d8.js";import"./npm~seedrandom-37239647.js";import"./npm~javascript-natural-sort-11e7fc54.js";import"./npm~escape-latex-404addb9.js";import"./npm~numeral-304d6dd9.js";import"./npm~currency.js-57f74176.js";import"./npm~@ckeditor~ckeditor5-vue_-4438b480.js";import"./join-array-567f2575.js";import"./npm~pure-color-28f75675.js";import"./npm~svgson-59868252.js";import"./npm~deep-rename-keys-9802c842.js";import"./npm~kind-of-f578382b.js";import"./npm~is-buffer-793dba8c.js";import"./npm~rename-keys-8dab041c.js";import"./npm~xml-reader-1f1b3f66.js";import"./npm~eventemitter3-e2795b41.js";import"./npm~xml-lexer-a4e87e97.js";import"./npm~sortablejs-1952ed83.js";import"./npm~tslib-8dbab242.js";const Q={name:"ns-procurement-product-options",props:["popup"],data(){return{validation:new L,fields:[],rawFields:[{label:c("Expiration Date"),name:"expiration_date",description:c("Define when that specific product should expire."),type:"datetimepicker"},{label:c("Barcode"),name:"barcode",description:c("Renders the automatically generated barcode."),type:"text",disabled:!0},{label:c("Tax Type"),name:"tax_type",description:c("Adjust how tax is calculated on the item."),type:"select",options:[{label:c("Inclusive"),value:"inclusive"},{label:c("Exclusive"),value:"exclusive"}]}]}},methods:{__:c,applyChanges(){if(this.validation.validateFields(this.fields)){const e=this.validation.extractFields(this.fields);return this.popup.params.resolve(e),this.popup.close()}return x.error(c("Unable to proceed. The form is not valid.")).subscribe()}},mounted(){const t=this.rawFields.map(e=>(e.name==="expiration_date"&&(e.value=this.popup.params.product.procurement.expiration_date),e.name==="tax_type"&&(e.value=this.popup.params.product.procurement.tax_type),e.name==="barcode"&&(e.value=this.popup.params.product.procurement.barcode),e));this.fields=this.validation.createFields(t)}},W={class:"ns-box shadow-lg w-6/7-screen md:w-5/7-screen lg:w-3/7-screen"},X={class:"p-2 border-b ns-box-header"},Y={class:"font-semibold"},Z={class:"p-2 border-b ns-box-body"},$={class:"p-2 flex justify-end ns-box-body"};function ee(t,e,n,i,s,o){const h=C("ns-field"),a=C("ns-button");return l(),u("div",W,[r("div",X,[r("h5",Y,d(o.__("Options")),1)]),r("div",Z,[(l(!0),u(v,null,y(s.fields,(p,b)=>(l(),R(h,{class:"w-full",field:p,key:b},null,8,["field"]))),128))]),r("div",$,[F(a,{onClick:e[0]||(e[0]=p=>o.applyChanges()),type:"info"},{default:B(()=>[T(d(o.__("Save")),1)]),_:1})])])}const te=O(Q,[["render",ee]]),re={class:"w-6/7-screen md:w-4/7-screen lg:w-3/7-screen flex flex-col shadow-lg bg-popup-surface"},se={class:"flex flex-col"},oe={class:"h-24 font-bold text-4xl text-primary flex justify-center items-center"},ie=D({__name:"ns-numpad-popup",props:["popup"],setup(t){let e=I("");const n=t,i=o=>{e.value=o},s=()=>{n.popup.params.resolve(e.value),n.popup.close()};return M(()=>{e.value=n.popup.params.value}),(o,h)=>{const a=C("ns-numpad-plus");return l(),u("div",re,[r("div",se,[r("div",oe,d(U(e)),1),F(a,{onChanged:h[0]||(h[0]=p=>i(p)),onNext:h[1]||(h[1]=p=>s()),value:U(e)},null,8,["value"])])])}}}),ne={name:"ns-procurement",mounted(){this.reloadEntities(),this.shouldPreventAccidentlRefreshSubscriber=this.shouldPreventAccidentalRefresh.subscribe({next:t=>{t?window.addEventListener("beforeunload",this.addAccidentalCloseListener):window.removeEventListener("beforeunload",this.addAccidentalCloseListener)}})},computed:{activeTab(){return this.validTabs.filter(t=>t.active).length>0?this.validTabs.filter(t=>t.active)[0]:!1}},data(){return{totalTaxValues:0,totalPurchasePrice:0,formValidation:new L,form:{},nsSnackBar:x,fields:[],searchResult:[],searchValue:"",debounceSearch:null,nsHttpClient:g,taxes:[],validTabs:[{label:c("Details"),identifier:"details",active:!0},{label:c("Products"),identifier:"products",active:!1}],reloading:!1,shouldPreventAccidentalRefresh:new z(!1),shouldPreventAccidentlRefreshSubscriber:null,showInfo:!1}},watch:{form:{handler(){this.formValidation.isFormUntouched(this.form)?this.shouldPreventAccidentalRefresh.next(!1):this.shouldPreventAccidentalRefresh.next(!0)},deep:!0},searchValue(t){t&&(clearTimeout(this.debounceSearch),this.debounceSearch=setTimeout(()=>{this.doSearch(t)},500))}},components:{nsManageProducts:N},props:["submitMethod","submitUrl","returnUrl","src","rules"],methods:{__:c,nsCurrency:j,addAccidentalCloseListener(t){return t.preventDefault(),!0},async defineConversionOption(t){try{const e=this.form.products[t];if(e.procurement.unit_id===void 0)return q.error(c("An error has occured"),c("Select the procured unit first before selecting the conversion unit."),{actions:{learnMore:{label:c("Learn More"),onClick:i=>{console.log(i)}},close:{label:c("Close"),onClick:i=>{i.close()}}},duration:5e3});const n=await G(`/api/units/${e.procurement.unit_id}/siblings`,c("Convert to unit"),e.procurement.convert_unit_id||null,"select");e.procurement.convert_unit_id=n.values[0],e.procurement.convert_unit_label=n.labels[0]}catch(e){if(e!==!1)return x.error(e.message||c("An unexpected error has occured")).subscribe()}},computeTotal(){this.totalTaxValues=0,this.form.products.length>0&&(this.totalTaxValues=this.form.products.map(t=>t.procurement.tax_value).reduce((t,e)=>t+e)),this.totalPurchasePrice=0,this.form.products.length>0&&(this.totalPurchasePrice=this.form.products.map(t=>parseFloat(t.procurement.total_purchase_price)).reduce((t,e)=>t+e))},updateLine(t){const e=this.form.products[t],n=this.taxes.filter(i=>i.id===e.procurement.tax_group_id);if(parseFloat(e.procurement.purchase_price_edit)>0&&parseFloat(e.procurement.quantity)>0){if(n.length>0){const i=n[0].taxes.map(s=>E.getTaxValue(e.procurement.tax_type,e.procurement.purchase_price_edit,parseFloat(s.rate)));e.procurement.tax_value=i.reduce((s,o)=>s+o),e.procurement.tax_type==="inclusive"?(e.procurement.net_purchase_price=parseFloat(e.procurement.purchase_price_edit)-e.procurement.tax_value,e.procurement.gross_purchase_price=parseFloat(e.procurement.purchase_price_edit),e.procurement.purchase_price=parseFloat(e.procurement.gross_purchase_price)):(e.procurement.gross_purchase_price=parseFloat(e.procurement.purchase_price_edit)+e.procurement.tax_value,e.procurement.net_purchase_price=parseFloat(e.procurement.purchase_price_edit),e.procurement.purchase_price=parseFloat(e.procurement.gross_purchase_price))}else e.procurement.gross_purchase_price=parseFloat(e.procurement.purchase_price_edit),e.procurement.purchase_price=parseFloat(e.procurement.purchase_price_edit),e.procurement.net_purchase_price=parseFloat(e.procurement.purchase_price_edit),e.procurement.tax_value=0;e.procurement.tax_value=e.procurement.tax_value*parseFloat(e.procurement.quantity),e.procurement.total_purchase_price=e.procurement.purchase_price*parseFloat(e.procurement.quantity)}this.computeTotal(),this.$forceUpdate()},fetchLastPurchasePrice(t){const e=this.form.products[t],n=e.unit_quantities.filter(i=>e.procurement.unit_id===i.unit_id);n.length>0&&(e.procurement.purchase_price_edit=n[0].last_purchase_price||0),this.updateLine(t)},switchTaxType(t,e){t.procurement.tax_type=t.procurement.tax_type==="inclusive"?"exclusive":"inclusive",this.updateLine(e)},doSearch(t){g.post("/api/procurements/products/search-product",{search:t}).subscribe(e=>{e.length===1?this.addProductList(e[0]):e.length>1?this.searchResult=e:x.error(c("No result match your query.")).subscribe()})},reloadEntities(){this.reloading=!0,H([g.get("/api/categories"),g.get("/api/products"),g.get(this.src),g.get("/api/taxes/groups")]).subscribe(t=>{this.reloading=!1,this.categories=t[0],this.products=t[1],this.taxes=t[3],this.form.general&&t[2].tabs.general.fieds.forEach((e,n)=>{e.value=this.form.tabs.general.fields[n].value||""}),this.form=Object.assign(JSON.parse(JSON.stringify(t[2])),this.form),this.form=this.formValidation.createForm(this.form),this.form.tabs&&this.form.tabs.general.fields.forEach((e,n)=>{e.options&&(e.options=t[2].tabs.general.fields[n].options)}),this.form.products.length===0&&(this.form.products=this.form.products.map(e=>(["gross_purchase_price","purchase_price_edit","tax_value","net_purchase_price","purchase_price","total_price","total_purchase_price","quantity","tax_group_id"].forEach(n=>{e[n]===void 0&&(e[n]=e[n]===void 0?0:e[n])}),e.$invalid=e.$invalid||!1,e.purchase_price_edit=e.purchase_price,{name:e.name,purchase_units:e.purchase_units,procurement:e,unit_quantities:e.unit_quantities||[]}))),this.$forceUpdate()})},setTabActive(t){this.validTabs.forEach(e=>e.active=!1),this.$forceUpdate(),this.$nextTick().then(()=>{t.active=!0})},addProductList(t){if(t.unit_quantities===void 0)return x.error(c("Unable to add product which doesn't unit quantities defined.")).subscribe();t.procurement=new Object,t.procurement.gross_purchase_price=0,t.procurement.purchase_price_edit=0,t.procurement.tax_value=0,t.procurement.net_purchase_price=0,t.procurement.purchase_price=0,t.procurement.total_price=0,t.procurement.total_purchase_price=0,t.procurement.quantity=1,t.procurement.expiration_date=null,t.procurement.tax_group_id=t.tax_group_id,t.procurement.tax_type=t.tax_type||"inclusive",t.procurement.unit_id=t.unit_quantities[0].unit_id,t.procurement.product_id=t.id,t.procurement.convert_unit_id=t.unit_quantities[0].convert_unit_id,t.procurement.procurement_id=null,t.procurement.$invalid=!1,this.searchResult=[],this.searchValue="",this.form.products.push(t)},submit(){if(this.form.products.length===0)return x.error(c("Unable to proceed, no product were provided."),c("OK")).subscribe();if(this.form.products.forEach(i=>{parseFloat(i.procurement.quantity)>=1?i.procurement.unit_id===0?i.procurement.$invalid=!0:i.procurement.$invalid=!1:i.procurement.$invalid=!0}),this.form.products.filter(i=>i.procurement.$invalid).length>0)return x.error(c("Unable to proceed, one or more product has incorrect values."),c("OK")).subscribe();if(this.formValidation.validateForm(this.form).length>0)return this.setTabActive(this.activeTab),x.error(c("Unable to proceed, the procurement form is not valid."),c("OK")).subscribe();if(this.submitUrl===void 0)return x.error(c("Unable to submit, no valid submit URL were provided."),c("OK")).subscribe();this.formValidation.disableForm(this.form);const e={...this.formValidation.extractForm(this.form),products:this.form.products.map(i=>i.procurement)},n=w.show(K);g[this.submitMethod?this.submitMethod.toLowerCase():"post"](this.submitUrl,e).subscribe({next:i=>{if(n.close(),i.status==="success")return this.shouldPreventAccidentalRefresh.next(!1),document.location=this.returnUrl;this.formValidation.enableForm(this.form)},error:i=>{n.close(),x.error(i.message,void 0,{duration:5e3}).subscribe(),this.formValidation.enableForm(this.form),i.errors&&this.formValidation.triggerError(this.form,i.errors)}})},deleteProduct(t){this.form.products.splice(t,1),this.$forceUpdate()},handleGlobalChange(t){this.globallyChecked=t,this.rows.forEach(e=>e.$checked=t)},setProductOptions(t){new Promise((n,i)=>{w.show(te,{product:this.form.products[t],resolve:n,reject:i})}).then(n=>{for(let i in n)this.form.products[t].procurement[i]=n[i];this.updateLine(t)})},async selectUnitForProduct(t){try{const e=this.form.products[t],n=await new Promise((s,o)=>{w.show(S,{label:c("{product}: Purchase Unit").replace("{product}",e.name),description:c("The product will be procured on that unit."),value:e.unit_id,resolve:s,reject:o,options:e.unit_quantities.map(h=>({label:h.unit.name,value:h.unit.id}))})});e.procurement.unit_id=n;const i=e.unit_quantities.filter(s=>parseInt(s.unit_id)===+n);e.procurement.convert_unit_id=i[0].convert_unit_id||void 0,e.procurement.convert_unit_label=await new Promise((s,o)=>{e.procurement.convert_unit_id!==void 0?g.get(`/api/units/${e.procurement.convert_unit_id}`).subscribe({next:h=>{s(h.name)},error:h=>{s(c("Unkown Unit"))}}):s(c("N/A"))}),this.fetchLastPurchasePrice(t)}catch(e){console.log(e)}},async selectTax(t){try{const e=this.form.products[t],n=await new Promise((i,s)=>{w.show(S,{label:c("Choose Tax"),description:c("The tax will be assigned to the procured product."),resolve:i,reject:s,options:this.taxes.map(o=>({label:o.name,value:o.id}))})});e.procurement.tax_group_id=n,this.updateLine(t)}catch{}},async triggerKeyboard(t,e,n){try{const i=await new Promise((s,o)=>{w.show(ie,{value:t[e],resolve:s,reject:o})});t[e]=i,this.updateLine(n)}catch(i){console.log({exception:i})}},getSelectedTax(t){const e=this.form.products[t],n=this.taxes.filter(i=>!!(e.procurement.tax_group_id&&e.procurement.tax_group_id===i.id));return n.length===1?n[0].name:c("N/A")},getSelectedUnit(t){const e=this.form.products[t],i=e.unit_quantities.map(s=>s.unit).filter(s=>e.procurement.unit_id!==void 0?s.id===e.procurement.unit_id:!1);return i.length===1?i[0].name:c("N/A")},handleSavedEvent(t,e){t.data&&(e.options.push({label:t.data.entry.first_name,value:t.data.entry.id}),e.value=t.data.entry.id)}}},ae={class:"form flex-auto flex flex-col",id:"crud-form"},ce={class:"flex flex-col"},le={class:"flex justify-between items-center"},ue={for:"title",class:"font-bold my-2 text-primary"},de={for:"title",class:"text-sm my-2 -mx-1 flex text-primary"},pe={key:0,class:"cursor-pointer rounded-full ns-inset-button border px-2 py-1"},me={key:1,class:"cursor-pointer rounded-full ns-inset-button border px-2 py-1"},he={class:"px-1"},_e=["href"],fe=["disabled"],be=["disabled"],ve={key:0,class:"text-xs text-primary py-1"},xe={key:0,class:"rounded border-2 bg-info-primary border-info-tertiary flex"},ye=r("div",{class:"icon w-16 flex py-4 justify-center"},[r("i",{class:"las la-info-circle text-4xl"})],-1),ge={class:"text flex-auto py-4"},we={class:"font-bold text-lg"},ke=r("i",{class:"las la-hand-point-right"}," ",-1),Ce=r("i",{class:"las la-hand-point-right"}," ",-1),Pe={id:"form-container",class:"-mx-4 flex flex-wrap mt-4"},Te={class:"px-4 w-full"},Fe={id:"tabbed-card",class:"ns-tab"},Ve={id:"card-header",class:"flex flex-wrap"},Ue=["onClick"],Se={key:0,class:"ns-tab-item"},Ae={class:"card-body rounded-br-lg rounded-bl-lg shadow p-2"},Le={key:0,class:"-mx-4 flex flex-wrap"},Oe={key:1,class:"ns-tab-item"},qe={class:"card-body rounded-br-lg rounded-bl-lg shadow p-2"},Ee={class:"mb-2"},Ne={class:"input-group info flex border-2 rounded overflow-hidden"},je=["placeholder"],Re={class:"h-0"},Be={class:"shadow bg-floating-menu relative z-10"},De=["onClick"],Me={class:"block font-bold text-primary"},Ie={class:"block text-sm text-priamry"},Ke={class:"block text-sm text-primary"},Ge={class:"overflow-x-auto"},ze={class:"w-full ns-table"},He={class:""},Je={class:"flex"},Qe={class:"flex md:flex-row flex-col md:-mx-1"},We={class:"md:px-1"},Xe=["onClick"],Ye={class:"md:px-1"},Ze=["onClick"],$e={class:"md:px-1"},et=["onClick"],tt={class:"md:px-1"},rt=["onClick"],st={class:"md:px-1"},ot=["onClick"],it=["onClick"],nt={class:"flex justify-center"},at={key:0,class:"outline-none border-dashed py-1 border-b border-info-primary text-sm"},ct={key:1,class:"outline-none border-dashed py-1 border-b border-info-primary text-sm"},lt={class:"flex items-start"},ut={class:"input-group rounded border-2"},dt=["onChange","onUpdate:modelValue"],pt=["value"],mt={class:"flex items-start flex-col justify-end"},ht={class:"text-sm text-primary"},_t={class:"text-primary"},ft=["colspan"],bt={class:"p-2 border"},vt=["colspan"],xt={class:"p-2 border"};function yt(t,e,n,i,s,o){const h=C("ns-field");return l(),u("div",ae,[s.form.main?(l(),u(v,{key:0},[r("div",ce,[r("div",le,[r("label",ue,d(s.form.main.label||o.__("No title is provided")),1),r("div",de,[r("div",{class:"px-1",onClick:e[0]||(e[0]=a=>s.showInfo=!s.showInfo)},[s.showInfo?m("",!0):(l(),u("span",pe,d(o.__("Show Details")),1)),s.showInfo?(l(),u("span",me,d(o.__("Hide Details")),1)):m("",!0)]),r("div",he,[n.returnUrl?(l(),u("a",{key:0,href:n.returnUrl,class:"rounded-full ns-inset-button border px-2 py-1"},d(o.__("Go Back")),9,_e)):m("",!0)])])]),r("div",{class:k([s.form.main.disabled?"disabled":s.form.main.errors.length>0?"error":"","flex border-2 rounded input-group info overflow-hidden"])},[P(r("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.form.main.value=a),onKeypress:e[2]||(e[2]=a=>s.formValidation.checkField(s.form.main)),onBlur:e[3]||(e[3]=a=>s.formValidation.checkField(s.form.main)),onChange:e[4]||(e[4]=a=>s.formValidation.checkField(s.form.main)),disabled:s.form.main.disabled,type:"text",class:k([(s.form.main.disabled,""),"flex-auto outline-none h-10 px-2"])},null,42,fe),[[A,s.form.main.value]]),r("button",{disabled:s.form.main.disabled,onClick:e[5]||(e[5]=a=>o.submit()),class:"outline-none px-4 h-10 border-l"},[V(t.$slots,"save",{},()=>[T(d(o.__("Save")),1)])],8,be),r("button",{onClick:e[6]||(e[6]=a=>o.reloadEntities()),class:"outline-none px-4 h-10"},[r("i",{class:k([s.reloading?"animate animate-spin":"","las la-sync"])},null,2)])],2),s.form.main.description&&s.form.main.errors.length===0?(l(),u("p",ve,d(s.form.main.description),1)):m("",!0),(l(!0),u(v,null,y(s.form.main.errors,(a,p)=>(l(),u("p",{class:"text-xs py-1 text-error-primary",key:p},[r("span",null,[V(t.$slots,"error-required",{},()=>[T(d(a.identifier),1)])])]))),128))]),s.showInfo?(l(),u("div",xe,[ye,r("div",ge,[r("h3",we,d(o.__("Important Notes")),1),r("ul",null,[r("li",null,[ke,r("span",null,d(o.__("Stock Management Products.")),1)]),r("li",null,[Ce,r("span",null,d(o.__("Doesn't work with Grouped Product.")),1)])])])])):m("",!0),r("div",Pe,[r("div",Te,[r("div",Fe,[r("div",Ve,[(l(!0),u(v,null,y(s.validTabs,(a,p)=>(l(),u("div",{onClick:b=>o.setTabActive(a),class:k([a.active?"active":"inactive","tab cursor-pointer px-4 py-2 rounded-tl-lg rounded-tr-lg text-primary"]),key:p},d(a.label),11,Ue))),128))]),o.activeTab.identifier==="details"?(l(),u("div",Se,[r("div",Ae,[s.form.tabs?(l(),u("div",Le,[(l(!0),u(v,null,y(s.form.tabs.general.fields,(a,p)=>(l(),u("div",{class:"flex px-4 w-full md:w-1/2 lg:w-1/3",key:p},[F(h,{onSaved:b=>o.handleSavedEvent(b,a),field:a},null,8,["onSaved","field"])]))),128))])):m("",!0)])])):m("",!0),o.activeTab.identifier==="products"?(l(),u("div",Oe,[r("div",qe,[r("div",Ee,[r("div",Ne,[P(r("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>s.searchValue=a),type:"text",placeholder:o.__("SKU, Barcode, Name"),class:"flex-auto text-primary outline-none h-10 px-2"},null,8,je),[[A,s.searchValue]])]),r("div",Re,[r("div",Be,[(l(!0),u(v,null,y(s.searchResult,(a,p)=>(l(),u("div",{onClick:b=>o.addProductList(a),key:p,class:"cursor-pointer border border-b hover:bg-floating-menu-hover border-floating-menu-edge p-2 text-primary"},[r("span",Me,d(a.name),1),r("span",Ie,d(o.__("SKU"))+" : "+d(a.sku),1),r("span",Ke,d(o.__("Barcode"))+" : "+d(a.barcode),1)],8,De))),128))])])]),r("div",Ge,[r("table",ze,[r("thead",null,[r("tr",null,[(l(!0),u(v,null,y(s.form.columns,(a,p)=>(l(),u("td",{width:"200",key:p,class:"text-primary p-2 border"},d(a.label),1))),128))])]),r("tbody",null,[(l(!0),u(v,null,y(s.form.products,(a,p)=>(l(),u("tr",{key:p,class:k(a.procurement.$invalid?"error border-2 border-error-primary":"")},[(l(!0),u(v,null,y(s.form.columns,(b,_)=>(l(),u(v,null,[b.type==="name"?(l(),u("td",{key:_,width:"500",class:"p-2 text-primary border"},[r("span",He,d(a.name),1),r("div",Je,[r("div",Qe,[r("div",We,[r("span",{class:"text-xs text-info-tertiary cursor-pointer underline",onClick:f=>o.deleteProduct(p)},d(o.__("Delete")),9,Xe)]),r("div",Ye,[r("span",{class:"text-xs text-info-tertiary cursor-pointer underline",onClick:f=>o.setProductOptions(p)},d(o.__("Options")),9,Ze)]),r("div",$e,[r("span",{class:"text-xs text-info-tertiary cursor-pointer underline",onClick:f=>o.selectUnitForProduct(p)},d(o.__("Unit"))+": "+d(o.getSelectedUnit(p)),9,et)]),r("div",tt,[r("span",{class:"text-xs text-info-tertiary cursor-pointer underline",onClick:f=>o.selectTax(p)},d(o.__("Tax"))+": "+d(o.getSelectedTax(p)),9,rt)]),r("div",st,[r("span",{class:"text-xs text-info-tertiary cursor-pointer underline",onClick:f=>o.defineConversionOption(p)},d(o.__("Convert"))+": "+d(a.procurement.convert_unit_id?a.procurement.convert_unit_label:o.__("N/A")),9,ot)])])])])):m("",!0),b.type==="text"?(l(),u("td",{key:_,onClick:f=>o.triggerKeyboard(a.procurement,_,p),class:"text-primary border cursor-pointer"},[r("div",nt,[["purchase_price_edit"].includes(_)?(l(),u("span",at,d(o.nsCurrency(a.procurement[_])),1)):m("",!0),["purchase_price_edit"].includes(_)?m("",!0):(l(),u("span",ct,d(a.procurement[_]),1))])],8,it)):m("",!0),b.type==="custom_select"?(l(),u("td",{key:_,class:"p-2 text-primary border"},[r("div",lt,[r("div",ut,[P(r("select",{onChange:f=>o.updateLine(p),"onUpdate:modelValue":f=>a.procurement[_]=f,class:"p-2"},[(l(!0),u(v,null,y(b.options,f=>(l(),u("option",{key:f.value,value:f.value},d(f.label),9,pt))),128))],40,dt),[[J,a.procurement[_]]])])])])):m("",!0),b.type==="currency"?(l(),u("td",{key:_,class:"p-2 text-primary border"},[r("div",mt,[r("span",ht,d(o.nsCurrency(a.procurement[_])),1)])])):m("",!0)],64))),256))],2))),128)),r("tr",_t,[r("td",{class:"p-2 border",colspan:Object.keys(s.form.columns).indexOf("tax_value")},null,8,ft),r("td",bt,d(o.nsCurrency(s.totalTaxValues)),1),r("td",{class:"p-2 border",colspan:Object.keys(s.form.columns).indexOf("total_purchase_price")-(Object.keys(s.form.columns).indexOf("tax_value")+1)},null,8,vt),r("td",xt,d(o.nsCurrency(s.totalPurchasePrice)),1)])])])])])])):m("",!0)])])])],64)):m("",!0)])}const xr=O(ne,[["render",yt]]);export{xr as default};
