import{n as z,N as he,c as te,e as me,f as be,a as ge,g as ve,b as pe,h as ye,d as _e}from"./ns-reorder-popup.vue_vue_type_style_index_0_scoped_978f1655_lang-DwD9iCuq.js";import{N as xe}from"./ns-avatar-C2owAxZ8.js";import{n as ke}from"./ns-avatar-image-BehlO75A.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as r,o as i,a as c,A as S,n as g,b as n,t as f,F as p,e as E,B as P,r as y,g as F,i as x,f as O,w as T,d as we,j as q,C as Ce,s as W,K as se,h as V,D as le,E as De,k as Se,u as ee}from"./runtime-core.esm-bundler-DUdZl5j1.js";import{h as D,n as w,p as K,a as G,F as Q,P as I,B as Te,b as L,S as Ee}from"./bootstrap-DmZtCizJ.js";import{_ as b}from"./lang-BINodpp-.js";import{v as R,w as Y,a as J,b as Oe,d as ne}from"./runtime-dom.esm-bundler-BJBE8XOq.js";const Me={data:()=>({clicked:!1,_save:0}),props:["type","disabled","link","href","routerLink","to","target"],mounted(){},computed:{isDisabled(){return this.disabled&&(this.disabled.length===0||this.disabled==="disabled"||this.disabled)}}},Fe=["disabled"],Ae=["target","href"];function je(t,e,s,u,d,l){return i(),r("div",{class:g(["flex ns-button",s.type?s.type:"default"])},[!s.link&&!s.href?(i(),r("button",{key:0,disabled:l.isDisabled,class:"flex items-center justify-center py-2 px-3 font-semibold"},[S(t.$slots,"default")],8,Fe)):c("",!0),s.href?(i(),r("a",{key:1,target:s.target,href:s.href,class:"flex items-center justify-center py-2 px-3 font-semibold"},[S(t.$slots,"default")],8,Ae)):c("",!0)],2)}const Pe=C(Me,[["render",je]]),Le={name:"ns-calendar",props:["date","field","visible","range","selected-range","side"],data(){return{calendar:[[]],currentDay:D(),daysOfWeek:new Array(7).fill("").map((t,e)=>e),hours:0,minutes:0,currentView:"days",clickedOnCalendar:!1,moment:D,months:new Array(12).fill("").map((t,e)=>e)}},computed:{momentCopy(){return D()}},beforeUnmount(){document.removeEventListener("click",this.checkClickedItem)},mounted(){document.addEventListener("click",this.checkClickedItem),this.currentDay=[void 0,null,""].includes(this.date)?D():D(this.date),this.hours=this.currentDay.hours(),this.minutes=this.currentDay.minutes(),this.build(),this.toggleView("days")},methods:{__:b,handleCalendarClick(){this.clickedOnCalendar=!0},getDayClass({day:t,_dayIndex:e,dayOfWeek:s,_index:u,currentDay:d}){const l=[];return(D(this.date).isSame(t.date,"day")||this.isRangeEdge(t))&&!this.isInvalidRange()?l.push("bg-secondary text-fontcolor border-secondary text-white"):l.push("hover:bg-numpad-hover"),this.isInvalidRange()&&this.isRangeEdge(t)&&l.push("bg-error-secondary text-white"),u===0&&l.push("border-t border-tab-table-th"),this.isInRange(t)&&!this.isRangeEdge(t)?l.push("bg-tertiary"):t.isDifferentMonth&&!this.isRangeEdge(t)&&l.push("bg-tab-table-th"),l.join(" ")},erase(){this.selectDate({date:D(ns.date.current)})},isInRange(t){return this.range&&this.range.length===2&&this.range[0]&&this.range[1]?D(t.date).isSameOrAfter(this.range[0])&&D(t.date).isSameOrBefore(this.range[1]):!1},isInvalidRange(){return this.selectedRange&&this.selectedRange.endDate?D(this.selectedRange.startDate).isAfter(D(this.selectedRange.endDate))||D(this.selectedRange.endDate).isBefore(D(this.selectedRange.startDate)):!1},isRangeEdge(t){return this.range&&this.range.length===2&&this.range[0]&&this.range[1]?D(t.date).isSame(this.range[0],"day")||D(t.date).isSame(this.range[1],"day"):!1},setYear(t){parseInt(t.srcElement.value)>0&&parseInt(t.srcElement.value)<9999&&(this.currentDay.year(t.srcElement.value),this.selectDate({date:this.currentDay.clone()}))},subYear(){parseFloat(this.currentDay.format("YYYY"))>0&&(this.currentDay.subtract(1,"year"),this.selectDate({date:this.currentDay.clone()}))},addYear(){this.currentDay.add(1,"year"),this.selectDate({date:this.currentDay.clone()})},toggleView(t){this.currentView=t,this.currentView==="years"&&setTimeout(()=>{this.$refs.year.select()},100),this.currentView==="days"&&setTimeout(()=>{this.$refs.hours.addEventListener("focus",function(e){this.select()}),this.$refs.minutes.addEventListener("focus",function(e){this.select()})},100)},setMonth(t){this.currentDay.month(t),this.selectDate({date:this.currentDay.clone()})},detectHoursChange(){parseFloat(this.hours)<0&&(this.hours=0),parseFloat(this.hours)>23&&(this.hours=23),this.selectDate({date:this.currentDay.clone()})},detectMinuteChange(){parseFloat(this.minutes)<0&&(this.minutes=0),parseFloat(this.minutes)>59&&(this.minutes=59),this.selectDate({date:this.currentDay.clone()})},checkClickedItem(t){this.$parent.$el.getAttribute("class").split(" ").includes("picker")&&(!this.$parent.$el.contains(t.srcElement)&&!this.clickedOnCalendar&&this.visible&&this.$emit("onClickOut",!0),setTimeout(()=>{this.clickedOnCalendar=!1},100))},selectDate(t){if([void 0].includes(t))this.$emit("set",null);else{if(this.side==="left"&&D(this.selectedRange.endDate).isValid()&&t.date.isAfter(this.selectedRange.endDate))return w.error(b("The left range will be invalid.")),!1;if(this.side==="right"&&D(this.selectedRange.startDate).isValid()&&t.date.isBefore(this.selectedRange.startDate))return w.error(b("The right range will be invalid.")),!1;this.currentDay=t.date,this.currentDay.hours(this.hours),this.currentDay.minutes(this.minutes),this.$emit("set",this.currentDay.format("YYYY-MM-DD HH:mm:ss"))}this.build()},subMonth(){this.currentDay.subtract(1,"month"),this.build()},addMonth(){this.currentDay.add(1,"month"),this.build()},resetCalendar(){this.calendar=[[]]},build(){this.resetCalendar(),this.currentDay.clone().startOf("month");const t=this.currentDay.clone().startOf("month"),e=this.currentDay.clone().endOf("month");for(;;){t.day()===0&&this.calendar[0].length>0&&this.calendar.push([]);let s=this.calendar.length-1;if(this.calendar[s].push({date:t.clone(),dayOfWeek:t.day(),isToday:t.isSame(D.now(),"day"),isDifferentMonth:!1,isNextMonth:!1,isPreviousMonth:!1}),t.isSame(e,"day"))break;t.add(1,"day")}if(this.calendar[0].length<7){const s=7-this.calendar[0].length,u=this.calendar[0][0].date.clone(),d=[];for(let l=0;l<s;l++)u.subtract(1,"day"),d.unshift({date:u.clone(),dayOfWeek:u.day(),isToday:u.isSame(D.now(),"day"),isDifferentMonth:!0,isNextMonth:!1,isPreviousMonth:!0});this.calendar[0].unshift(...d)}if(this.calendar[this.calendar.length-1].length<7){const s=this.calendar.length-1,u=7-this.calendar[s].length,d=this.calendar[s][this.calendar[s].length-1].date.clone(),l=[];for(let a=0;a<u;a++)d.add(1,"day"),l.push({date:d.clone(),dayOfWeek:d.day(),isToday:d.isSame(D.now(),"day"),isDifferentMonth:!0,isNextMonth:!0,isPreviousMonth:!1});this.calendar[s].push(...l)}}}},Re={key:0,class:"flex-auto"},$e={class:"p-2 flex items-center"},He={class:"flex flex-auto font-semibold text-fontcolor justify-center"},Ie={class:"h-32 flex grow-0 items-center justify-center text-fontcolor p-4"},Ve={class:"rounded input-group info border-2 flex overflow-hidden"},Ye={class:"w-24 flex grow-0"},ze=["value"],qe={class:"p-2"},Be={key:1,class:"flex-auto border-b border-box-background"},Ne={class:"p-2 flex items-center"},Ue={class:"flex flex-auto font-semibold text-fontcolor justify-center"},We={class:"mr-2 border-b border-secondary border-dashed"},Ke={class:"grid grid-flow-row grid-cols-3 grid-rows-1 gap-0 text-fontcolor divide-x divide-y border-b border-box-background"},Ge={class:"w-full h-full"},Qe=["onClick"],Je={class:"p-2"},Xe={key:2},Ze={class:"p-2 flex items-center"},et={class:"flex flex-auto font-semibold text-fontcolor justify-center"},tt={class:"grid grid-flow-row grid-cols-7 grid-rows-1 gap-0 text-fontcolor divide-x divide-y"},st={class:"md:h-10 h-8 flex justify-center items-center border-tab-table-th text-sm"},lt={class:"md:h-10 h-8 flex justify-center items-center border-tab-table-th text-sm"},nt={class:"md:h-10 h-8 flex justify-center items-center border-tab-table-th text-sm"},it={class:"md:h-10 h-8 flex justify-center items-center border-tab-table-th text-sm"},rt={class:"md:h-10 h-8 flex justify-center items-center border-tab-table-th text-sm"},dt={class:"md:h-10 h-8 flex justify-center items-center border-tab-table-th text-sm"},ot={class:"md:h-10 h-8 flex justify-center items-center border-tab-table-th text-sm"},at=["onClick"],ut={key:0},ct={key:1,class:"text-fontcolor-soft"},ft={class:"border-t border-tab-table-th w-full p-2"},ht={class:"-mx-1 flex justify-between"},mt={class:"px-1"},bt={class:"-mx-1 flex"},gt={class:"px-1"},vt={class:"px-2"},pt={key:0,class:"rounded border-tab-table-th-edge flex items-center justify-center p-1 border"};function yt(t,e,s,u,d,l){return i(),r("div",{onClick:e[21]||(e[21]=a=>l.handleCalendarClick()),class:"flex bg-box-background flex-col rounded-lg overflow-hidden"},[d.currentView==="years"?(i(),r("div",Re,[n("div",$e,[n("div",null,[n("button",{onClick:e[0]||(e[0]=a=>l.subMonth()),class:"w-8 h-8 ns-inset-button border outline-hidden text-numpad-text rounded"},[...e[22]||(e[22]=[n("i",{class:"las la-angle-left"},null,-1)])])]),n("div",He,[n("span",{class:"mr-2 cursor-pointer border-b border-secondary border-dashed",onClick:e[1]||(e[1]=a=>l.toggleView("months"))},f(d.currentDay.format("MMM")),1),n("span",{class:"cursor-pointer border-b border-secondary border-dashed",onClick:e[2]||(e[2]=a=>l.toggleView("years"))},f(d.currentDay.format("YYYY")),1)]),n("div",null,[n("button",{onClick:e[3]||(e[3]=a=>l.addMonth()),class:"w-8 h-8 ns-inset-button border outline-hidden text-numpad-text rounded"},[...e[23]||(e[23]=[n("i",{class:"las la-angle-right"},null,-1)])])])]),n("div",Ie,[n("div",Ve,[n("button",{onClick:e[4]||(e[4]=a=>l.subYear()),class:"px-2 py-2"},[...e[24]||(e[24]=[n("i",{class:"las la-minus"},null,-1)])]),n("div",Ye,[n("input",{type:"text",ref:"year",class:"p-2 flex-auto w-full text-center outline-hidden",onChange:e[5]||(e[5]=a=>l.setYear(a)),value:d.currentDay.format("YYYY")},null,40,ze)]),n("button",{onClick:e[6]||(e[6]=a=>l.addYear()),class:"px-2 py-2"},[...e[25]||(e[25]=[n("i",{class:"las la-plus"},null,-1)])])])]),n("div",qe,[n("button",{onClick:e[7]||(e[7]=a=>l.toggleView("days")),class:"p-2 w-full ns-inset-button border text-sm error hover:text-white rounded flex items-center justify-center"},f(l.__("Return To Calendar")),1)])])):c("",!0),d.currentView==="months"?(i(),r("div",Be,[n("div",Ne,[n("div",null,[n("button",{onClick:e[8]||(e[8]=a=>l.subYear()),class:"w-8 h-8 ns-inset-button outline-hidden border rounded"},[...e[26]||(e[26]=[n("i",{class:"las la-angle-left"},null,-1)])])]),n("div",Ue,[n("span",We,f(d.currentDay.format("MMM")),1),n("span",{class:"cursor-pointer border-b border-secondary border-dashed",onClick:e[9]||(e[9]=a=>l.toggleView("years"))},f(d.currentDay.format("YYYY")),1)]),n("div",null,[n("button",{onClick:e[10]||(e[10]=a=>l.addYear()),class:"w-8 h-8 ns-inset-button outline-hidden border rounded"},[...e[27]||(e[27]=[n("i",{class:"las la-angle-right"},null,-1)])])])]),n("div",Ke,[(i(!0),r(p,null,E(d.months,(a,o)=>(i(),r("div",{key:o,class:"h-8 flex justify-center items-center text-sm border-box-background"},[n("div",Ge,[n("div",{class:g([l.momentCopy.month(a).format("MM")===d.currentDay.format("MM")?"bg-secondary text-white":"hover:bg-numpad-hover","h-full w-full border-box-background flex items-center justify-center cursor-pointer"]),onClick:h=>l.setMonth(a)},f(l.momentCopy.format("MMM")),11,Qe)])]))),128))]),n("div",Je,[n("button",{onClick:e[11]||(e[11]=a=>l.toggleView("days")),class:"p-2 w-full ns-inset-button border text-sm error rounded flex items-center justify-center"},f(l.__("Return To Calendar")),1)])])):c("",!0),d.currentView==="days"?(i(),r("div",Xe,[n("div",Ze,[n("div",null,[n("button",{onClick:e[12]||(e[12]=a=>l.subMonth()),class:"w-8 h-8 ns-inset-button border rounded"},[...e[28]||(e[28]=[n("i",{class:"las la-angle-left"},null,-1)])])]),n("div",et,[n("span",{class:"mr-2 cursor-pointer border-b border-secondary border-dashed",onClick:e[13]||(e[13]=a=>l.toggleView("months"))},f(d.currentDay.format("MMM")),1),n("span",{class:"cursor-pointer border-b border-secondary border-dashed",onClick:e[14]||(e[14]=a=>l.toggleView("years"))},f(d.currentDay.format("YYYY")),1)]),n("div",null,[n("button",{onClick:e[15]||(e[15]=a=>l.addMonth()),class:"w-8 h-8 ns-inset-button border rounded"},[...e[29]||(e[29]=[n("i",{class:"las la-angle-right"},null,-1)])])])]),n("div",tt,[n("div",st,f(l.__("Sun")),1),n("div",lt,f(l.__("Mon")),1),n("div",nt,f(l.__("Tue")),1),n("div",it,f(l.__("Wed")),1),n("div",rt,f(l.__("Thr")),1),n("div",dt,f(l.__("Fri")),1),n("div",ot,f(l.__("Sat")),1)]),(i(!0),r(p,null,E(d.calendar,(a,o)=>(i(),r("div",{key:o,class:"grid grid-flow-row grid-cols-7 grid-rows-1 gap-0 text-fontcolor divide-x divide-y"},[(i(!0),r(p,null,E(d.daysOfWeek,(h,m)=>(i(),r("div",{key:m,class:"md:h-10 h-8 flex justify-center items-center text-sm border-tab-table-th"},[(i(!0),r(p,null,E(a,(v,k)=>(i(),r(p,null,[v.dayOfWeek===h?(i(),r("div",{key:k,class:g([l.getDayClass({day:v,_dayIndex:k,dayOfWeek:h,_index:m,currentDay:d.currentDay}),"h-full w-full flex items-center justify-center cursor-pointer"]),onClick:M=>l.selectDate(v)},[v.isDifferentMonth?c("",!0):(i(),r("span",ut,f(v.date.format("DD")),1)),v.isDifferentMonth?(i(),r("span",ct,f(v.date.format("DD")),1)):c("",!0)],10,at)):c("",!0)],64))),256))]))),128))]))),128))])):c("",!0),n("div",ft,[n("div",ht,[n("div",mt,[n("div",bt,[n("div",gt,[n("button",{onClick:e[16]||(e[16]=a=>l.erase()),class:"border ns-inset-button text-sm error rounded md:w-10 w-8 md:h-10 h-8 flex items-center justify-center"},[...e[30]||(e[30]=[n("i",{class:"las la-trash text-lg"},null,-1)])])])])]),n("div",vt,[d.currentView==="days"?(i(),r("div",pt,[e[31]||(e[31]=n("span",{class:"pr-2 pl-1 text-font"},[n("i",{class:"las la-clock"})],-1)),P(n("input",{placeholder:"HH",ref:"hours",onChange:e[17]||(e[17]=a=>l.detectHoursChange(a)),class:"w-12 p-1 text-center border border-numpad-edge bg-input-background outline-hidden text-sm active:border-numpad-edge","onUpdate:modelValue":e[18]||(e[18]=a=>d.hours=a),type:"number"},null,544),[[R,d.hours]]),e[32]||(e[32]=n("span",{class:"mx-1"},":",-1)),P(n("input",{placeholder:"mm",ref:"minutes",onChange:e[19]||(e[19]=a=>l.detectMinuteChange(a)),class:"w-12 p-1 text-center border border-numpad-edge bg-input-background outline-hidden text-sm active:border-numpad-edge","onUpdate:modelValue":e[20]||(e[20]=a=>d.minutes=a),type:"number"},null,544),[[R,d.minutes]])])):c("",!0)])])])])}const ie=C(Le,[["render",yt]]),_t={data:()=>({}),emits:["change"],props:["checked","field","label","class"],computed:{isChecked(){return this.field?this.field.value:this.checked},hasError(){return!!(this.field&&this.field.errors!==void 0&&this.field.errors.length>0)}},methods:{toggleIt(){this.field!==void 0&&(this.field.value=!this.field.value),this.$emit("change",!this.checked)}}},xt={class:"w-5 h-5 flex border items-center justify-center cursor-pointer"},kt={key:0,class:"mx-2"},wt={key:1,class:"mx-2"};function Ct(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(s.field?"flex flex-col":"")},[n("div",{class:g(["ns-checkbox cursor-pointer flex",(l.isChecked?"checked":"")+" "+(s.field?l.hasError?"has-error":"is-pristine":"justify-center items-center")]),onClick:e[0]||(e[0]=o=>l.toggleIt())},[n("div",xt,[n("i",{class:g([l.isChecked?"visible":"invisible","las la-check"])},null,2)]),s.label?(i(),r("label",kt,f(s.label),1)):c("",!0),s.field&&s.field.label?(i(),r("label",wt,f(s.field.label),1)):c("",!0)],2),s.field&&s.field.description?(i(),F(a,{key:0,field:s.field},null,8,["field"])):c("",!0)],2)}const Dt=C(_t,[["render",Ct]]),St={name:"ns-close-button",methods:{}},Tt={class:"outline-hidden ns-close-button hover:border-transparent border rounded-full h-6 min-w-[1.5rem] flex items-center justify-center"};function Et(t,e,s,u,d,l){return i(),r("button",Tt,[e[0]||(e[0]=n("i",{class:"las la-times text-sm"},null,-1)),e[1]||(e[1]=x()),S(t.$slots,"default")])}const Ot=C(St,[["render",Et]]),Mt={data(){return{fields:[],validation:new Q}},props:["popup"],methods:{__:b,popupCloser:G,popupResolver:K,closePopup(){this.popupResolver(!1)},useFilters(){this.popupResolver(this.validation.extractFields(this.fields))},clearFilters(){this.fields.forEach(t=>t.value=""),this.popupResolver(null)}},mounted(){this.fields=this.validation.createFields(this.popup.params.queryFilters),this.popupCloser()}},Ft={class:"ns-box shadow-lg w-95vw h-95vh md:w-[60vw] md:h-[83-vh] flex flex-col"},At={class:"p-2 border-b ns-box-header flex justify-between items-center"},jt={class:"p-2 ns-box-body flex-auto"},Pt={class:"p-2 flex justify-between ns-box-footer border-t"};function Lt(t,e,s,u,d,l){const a=y("ns-close-button"),o=y("ns-field"),h=y("ns-button");return i(),r("div",Ft,[n("div",At,[n("h3",null,f(l.__("Search Filters")),1),n("div",null,[O(a,{onClick:e[0]||(e[0]=m=>l.closePopup())})])]),n("div",jt,[(i(!0),r(p,null,E(d.fields,(m,v)=>(i(),F(o,{field:m,key:v},null,8,["field"]))),128))]),n("div",Pt,[n("div",null,[O(h,{onClick:e[1]||(e[1]=m=>l.clearFilters()),type:"error"},{default:T(()=>[x(f(l.__("Clear Filters")),1)]),_:1})]),n("div",null,[O(h,{onClick:e[2]||(e[2]=m=>l.useFilters()),type:"info"},{default:T(()=>[x(f(l.__("Use Filters")),1)]),_:1})])])])}const Rt=C(Mt,[["render",Lt]]),$t={data:()=>({prependOptions:!1,showOptions:!0,showCheckboxes:!0,isRefreshing:!1,sortColumn:"",searchInput:"",queryFiltersString:"",searchQuery:"",page:1,bulkAction:"",bulkActions:[],queryFilters:[],headerButtons:[],withFilters:!1,selectedEntriesSubject:new RxJS.BehaviorSubject([]),columns:[],selectedEntries:[],globallyChecked:!1,showSelectedEntries:!0,crudConfig:{},result:{current_page:null,data:[],first_page_url:null,from:null,last_page:null,last_page_url:null,next_page_url:null,path:null,per_page:null,prev_page_url:null,to:null,total:null}}),name:"ns-crud",mounted(){this.identifier!==void 0&&nsCrudHandler.defineInstance(this.identifier,this),this.loadConfig()},watch:{selectedEntries:{deep:!0,handler(t){this.selectedEntriesSubject.next(t),this.result.data.forEach(e=>{t.filter(u=>u.$id===e.$id).length>0?e.$checked=!0:e.$checked=!1})}}},props:["src","createUrl","mode","identifier","queryParams","popup"],computed:{getParsedSrc(){return`${this.src}?${this.sortColumn}${this.searchQuery}${this.queryFiltersString}${this.queryPage}${this.getQueryParams()?"&"+this.getQueryParams():""}`},showQueryFilters(){return this.queryFilters.length>0},getSelectedAction(){const t=this.bulkActions.filter(e=>e.identifier===this.bulkAction);return t.length>0?t[0]:!1},pagination(){return this.result?this.pageNumbers(this.result.last_page,this.result.current_page):[]},queryPage(){return this.result?`&page=${this.page}`:""},resultInfo(){return b("displaying {perPage} on {items} items").replace("{perPage}",this.result.per_page||0).replace("{items}",this.result.total||0)},headerButtonsComponents(){return this.headerButtons.map(t=>we(()=>new Promise(e=>{e(nsComponents[t])})))}},methods:{__:b,getQueryParams(){return this.queryParams?Object.keys(this.queryParams).map(t=>`${t}=${this.queryParams[t]}`).join("&"):""},pageNumbers(t,e){var s=[];e-3>1&&s.push(1,"...");for(let u=1;u<=t;u++)e+3>u&&e-3<u&&s.push(u);return e+3<t&&s.push("...",t),s.filter(u=>u>0||typeof u=="string")},handleHeaderButtonUpdate(t){for(let e in t)["selectedEntries","page","bulkAction","searchInput","globallyChecked","sortColumn","searchQuery","queryFiltersString","withFilters","bulkActions"].includes(e)&&(this[e]=t[e])},downloadContent(){nsHttpClient.post(`${this.src}/export?${this.getParsedSrc}`,{entries:this.selectedEntries.map(t=>t.$id)}).subscribe(t=>{setTimeout(()=>document.location=t.url,300),w.success(b("The document has been generated."))},t=>{w.error(t.message||b("Unexpected error occurred."))})},clearSelectedEntries(){I.show(z,{title:b("Clear Selected Entries ?"),message:b("Would you like to clear all selected entries ?"),onAction:t=>{t&&(this.selectedEntries=[],this.handleGlobalChange(!1))}})},refreshRow(t){if(t.$checked===!0)this.selectedEntries.filter(s=>s.$id===t.$id).length===0&&this.selectedEntries.push(t);else{const e=this.selectedEntries.filter(s=>s.$id===t.$id);if(e.length>0){const s=this.selectedEntries.indexOf(e[0]);this.selectedEntries.splice(s,1)}}},handleShowOptions(t){this.result.data.forEach(e=>{e.$id!==t.$id&&(e.$toggled=!1)})},handleGlobalChange(t){this.globallyChecked=t,this.result.data.forEach(e=>{e.$checked=t,this.refreshRow(e)})},loadConfig(){nsHttpClient.get(`${this.src}/config?${this.getQueryParams()}`).subscribe(e=>{this.crudConfig=e,this.columns=e.columns,this.bulkActions=e.bulkActions,this.queryFilters=e.queryFilters,this.prependOptions=e.prependOptions,this.showOptions=e.showOptions,this.showCheckboxes=e.showCheckboxes,this.headerButtons=e.headerButtons||[],this.showSelectedEntries=e.showSelectedEntries,this.refresh()},e=>{w.error(e.message,"OK",{duration:!1})})},cancelSearch(){this.searchInput="",this.search()},search(){this.searchInput?this.searchQuery=`&search=${this.searchInput}`:this.searchQuery="",this.page=1,this.refresh()},sort(t){if(this.columns[t].$sort===!1)return w.error(b("Sorting is explicitely disabled on this column"));for(let e in this.columns)e!==t&&(this.columns[e].$sorted=!1,this.columns[e].$direction="");switch(this.columns[t].$sorted=!0,this.columns[t].$direction){case"asc":this.columns[t].$direction="desc";break;case"desc":this.columns[t].$direction="";break;case"":default:this.columns[t].$direction="asc";break}["asc","desc"].includes(this.columns[t].$direction)?this.sortColumn=`active=${t}&direction=${this.columns[t].$direction}`:this.sortColumn="",this.$emit("sort",this.columns[t]),this.refresh()},bulkDo(){if(this.bulkAction)if(this.selectedEntries.length>0){if(confirm(this.getSelectedAction.confirm||b("Would you like to perform the selected bulk action on the selected entries ?")))return nsHttpClient.post(`${this.src}/bulk-actions`,{action:this.bulkAction,entries:this.selectedEntries.map(t=>t.$id)}).subscribe({next:t=>{w.info(t.message),this.selectedEntries=[],this.refresh()},error:t=>{w.error(t.message)}})}else return w.error(b("No selection has been made."));else return w.error(b("No action has been selected."))},async openQueryFilter(){try{const t=await new Promise((e,s)=>{I.show(Rt,{resolve:e,reject:s,queryFilters:this.queryFilters})});this.withFilters=!1,this.queryFiltersString="",t!==null&&(this.withFilters=!0,this.queryFiltersString="&queryFilters="+encodeURIComponent(JSON.stringify(t))),this.refresh()}catch{}},refresh(){this.globallyChecked=!1,this.isRefreshing=!0,nsHttpClient.get(`${this.getParsedSrc}`).subscribe(e=>{e.data=e.data.map(s=>(this.selectedEntries.filter(d=>d.$id===s.$id).length>0&&(s.$checked=!0),s)),this.isRefreshing=!1,this.result=e,this.page=e.current_page},e=>{this.isRefreshing=!1,w.error(e.message)})}}},Ht={key:0,id:"crud-table-header",class:"p-2 flex flex-col md:flex-row justify-between flex-wrap"},It={id:"crud-search-box",class:"w-full md:w-auto -mx-2 mb-2 md:mb-0 flex"},Vt={key:0,class:"px-2 flex items-center justify-center"},Yt=["href"],zt={class:"px-2"},qt={class:"rounded-full p-1 ns-crud-input flex"},Bt={class:"px-2 flex items-center justify-center"},Nt={key:1,class:"px-2 flex items-center"},Ut={key:0,class:"las la-filter"},Wt={key:1,class:"las la-check"},Kt={key:2,class:"ml-1"},Gt={key:3,class:"ml-1"},Qt={key:2,id:"custom-buttons"},Jt={id:"crud-buttons",class:"-mx-1 flex flex-wrap w-full md:w-auto"},Xt={key:0,class:"px-1 flex items-center"},Zt={class:"px-1 flex items-center"},es={id:"crud-table-body",class:"flex"},ts={class:"overflow-x-auto flex-auto"},ss={key:0,class:"table ns-table w-full"},ls={key:0,class:"text-center p-1 border w-16 align-middle"},is={key:1,class:"text-left p-1 w-16 border"},rs=["onClick"],ds={class:"w-full flex justify-between items-center"},os={class:"flex"},as={class:"h-6 w-6 flex justify-center items-center"},us={key:0,class:"las la-sort-amount-up"},cs={key:1,class:"las la-sort-amount-down"},fs={key:2,class:"text-left p-1 w-16 border"},hs={key:1},ms=["colspan"],bs={class:"p-2 flex flex-col md:flex-row justify-between footer"},gs={key:0,id:"grouped-actions",class:"mb-2 md:mb-0 flex justify-between rounded-full ns-crud-input p-1"},vs={class:"bg-input-disabled",selected:"",value:""},ps=["value"],ys={class:"flex"},_s={class:"items-center flex text-fontcolor mx-4 text-sm"},xs={id:"pagination",class:"flex items-center -mx-1"},ks=["onClick"];function ws(t,e,s,u,d,l){const a=y("ns-checkbox"),o=y("ns-table-row");return i(),r("div",{id:"crud-table",class:g(["w-full rounded-lg",s.mode!=="light"?"shadow mb-8":""])},[s.mode!=="light"?(i(),r("div",Ht,[n("div",It,[s.createUrl?(i(),r("div",Vt,[n("a",{href:s.createUrl||"#",class:"rounded-full ns-crud-button text-sm h-10 flex items-center justify-center cursor-pointer px-3 outline-hidden border"},[...e[18]||(e[18]=[n("i",{class:"las la-plus"},null,-1)])],8,Yt)])):c("",!0),n("div",zt,[n("div",qt,[P(n("input",{onKeypress:e[0]||(e[0]=Y(h=>l.search(),["enter"])),"onUpdate:modelValue":e[1]||(e[1]=h=>t.searchInput=h),type:"text",class:"w-36 md:w-auto bg-transparent outline-hidden px-2"},null,544),[[R,t.searchInput]]),n("button",{onClick:e[2]||(e[2]=h=>l.search()),class:"rounded-full w-8 h-8 outline-hidden ns-crud-input-button"},[...e[19]||(e[19]=[n("i",{class:"las la-search"},null,-1)])]),t.searchQuery?(i(),r("button",{key:0,onClick:e[3]||(e[3]=h=>l.cancelSearch()),class:"ml-1 rounded-full w-8 h-8 outline-hidden ns-crud-input-button error"},[...e[20]||(e[20]=[n("i",{class:"las la-times"},null,-1)])])):c("",!0)])]),n("div",Bt,[n("button",{onClick:e[4]||(e[4]=h=>l.refresh()),class:"rounded-full text-sm h-10 px-3 outline-hidden border ns-crud-button"},[n("i",{class:g([t.isRefreshing?"animate-spin":"","las la-sync"])},null,2)])]),l.showQueryFilters?(i(),r("div",Nt,[n("button",{onClick:e[5]||(e[5]=h=>l.openQueryFilter()),class:g([t.withFilters?"table-filters-enabled":"table-filters-disabled","ns-crud-button border rounded-full text-sm h-10 px-3 outline-hidden"])},[t.withFilters?c("",!0):(i(),r("i",Ut)),t.withFilters?(i(),r("i",Wt)):c("",!0),t.withFilters?c("",!0):(i(),r("span",Kt,f(l.__("Filters")),1)),t.withFilters?(i(),r("span",Gt,f(l.__("Has Filters")),1)):c("",!0)],2)])):c("",!0),l.headerButtonsComponents.length>0?(i(),r("div",Qt,[(i(!0),r(p,null,E(l.headerButtonsComponents,(h,m)=>(i(),F(q(h),{onUpdate:e[6]||(e[6]=v=>l.handleHeaderButtonUpdate(v)),config:t.crudConfig,onRefresh:e[7]||(e[7]=v=>l.refresh()),selectedSubject:t.selectedEntriesSubject,result:t.result,key:m},null,40,["config","selectedSubject","result"]))),128))])):c("",!0)]),n("div",Jt,[t.selectedEntries.length>0&&t.showSelectedEntries?(i(),r("div",Xt,[n("button",{onClick:e[8]||(e[8]=h=>l.clearSelectedEntries()),class:"flex justify-center items-center rounded-full text-sm h-10 px-3 outline-hidden ns-crud-button border"},[e[21]||(e[21]=n("i",{class:"lar la-check-square"},null,-1)),x(" "+f(l.__("{entries} entries selected").replace("{entries}",t.selectedEntries.length)),1)])])):c("",!0),n("div",Zt,[n("button",{onClick:e[9]||(e[9]=h=>l.downloadContent()),class:"flex justify-center items-center rounded-full text-sm h-10 px-3 ns-crud-button border outline-hidden"},[e[22]||(e[22]=n("i",{class:"las la-download"},null,-1)),x(" "+f(l.__("Download")),1)])])])])):c("",!0),n("div",es,[n("div",ts,[Object.values(t.columns).length>0?(i(),r("table",ss,[n("thead",null,[n("tr",null,[t.showCheckboxes?(i(),r("th",ls,[O(a,{class:"inline-block",checked:t.globallyChecked,onChange:e[10]||(e[10]=h=>l.handleGlobalChange(h))},null,8,["checked"])])):c("",!0),t.prependOptions&&t.showOptions?(i(),r("th",is)):c("",!0),(i(!0),r(p,null,E(t.columns,(h,m)=>(i(),r("th",{key:m,onClick:v=>l.sort(m),style:Ce({width:h.width||"auto","max-width":h.maxWidth||"auto","min-width":h.minWidth||"auto"}),class:"cursor-pointer justify-between border text-left p-1"},[n("div",ds,[n("span",os,f(h.label),1),n("span",as,[h.$direction==="desc"?(i(),r("i",us)):c("",!0),h.$direction==="asc"?(i(),r("i",cs)):c("",!0)])])],12,rs))),128)),!t.prependOptions&&t.showOptions?(i(),r("th",fs)):c("",!0)])]),n("tbody",null,[t.result.data!==void 0&&t.result.data.length>0?(i(!0),r(p,{key:0},E(t.result.data,(h,m)=>(i(),F(o,{key:m,onUpdated:e[11]||(e[11]=v=>l.refreshRow(v)),columns:t.columns,prependOptions:t.prependOptions,showOptions:t.showOptions,showCheckboxes:t.showCheckboxes,row:h,onReload:e[12]||(e[12]=v=>l.refresh()),onToggled:e[13]||(e[13]=v=>l.handleShowOptions(v))},null,8,["columns","prependOptions","showOptions","showCheckboxes","row"]))),128)):c("",!0),!t.result||t.result.data.length===0?(i(),r("tr",hs,[n("td",{colspan:Object.values(t.columns).length+2,class:"text-center border py-3"},f(l.__("There is nothing to display...")),9,ms)])):c("",!0)])])):c("",!0)])]),n("div",bs,[t.bulkActions.length>0?(i(),r("div",gs,[P(n("select",{class:"outline-hidden bg-transparent","onUpdate:modelValue":e[14]||(e[14]=h=>t.bulkAction=h),id:"grouped-actions"},[n("option",vs,[S(t.$slots,"bulk-label",{},()=>[x(f(l.__("Bulk Actions")),1)])]),(i(!0),r(p,null,E(t.bulkActions,(h,m)=>(i(),r("option",{class:"bg-input-disabled",key:m,value:h.identifier},f(h.label),9,ps))),128))],512),[[J,t.bulkAction]]),n("button",{onClick:e[15]||(e[15]=h=>l.bulkDo()),class:"ns-crud-input-button h-8 px-3 text-sm outline-hidden rounded-full flex items-center justify-center"},[S(t.$slots,"bulk-go",{},()=>[x(f(l.__("Apply")),1)])])])):c("",!0),n("div",ys,[n("div",_s,f(l.resultInfo),1),n("div",xs,[t.result.current_page?(i(),r(p,{key:0},[n("a",{href:"javascript:void(0)",onClick:e[16]||(e[16]=h=>{t.page=t.result.first_page,l.refresh()}),class:"mx-1 flex items-center justify-center h-8 w-8 rounded-full ns-crud-button border shadow"},[...e[23]||(e[23]=[n("i",{class:"las la-angle-double-left"},null,-1)])]),(i(!0),r(p,null,E(l.pagination,(h,m)=>(i(),r(p,null,[t.page!=="..."?(i(),r("a",{key:m,class:g([t.page==h?"active":"","mx-1 flex items-center justify-center h-8 w-8 rounded-full ns-crud-button border"]),onClick:v=>{t.page=h,l.refresh()},href:"javascript:void(0)"},f(h),11,ks)):c("",!0),t.page==="..."?(i(),r("a",{key:m,href:"javascript:void(0)",class:"mx-1 flex items-center justify-center h-8 w-8 rounded-full ns-crud-button border"},"...")):c("",!0)],64))),256)),n("a",{href:"javascript:void(0)",onClick:e[17]||(e[17]=h=>{t.page=t.result.last_page,l.refresh()}),class:"mx-1 flex items-center justify-center h-8 w-8 rounded-full ns-crud-button border shadow"},[...e[24]||(e[24]=[n("i",{class:"las la-angle-double-right"},null,-1)])])],64)):c("",!0)])])])],2)}const Cs=C($t,[["render",ws]]),Ds={data:()=>({form:{},globallyChecked:!1,formValidation:new Q,links:{},rows:[],optionAttributes:{},extraComponents:()=>nsExtraComponents,nsComponents:()=>nsComponents}),emits:["updated","saved"],mounted(){this.loadForm()},props:["src","createUrl","fieldClass","submitUrl","submitMethod","disableTabs","queryParams","popup"],computed:{activeTabFields(){for(let t in this.form.tabs)if(this.form.tabs[t].active)return this.form.tabs[t].fields;return[]},activeTab(){for(let t in this.form.tabs)if(this.form.tabs[t].active)return this.form.tabs[t];return!1},activeTabIdentifier(){for(let t in this.form.tabs)if(this.form.tabs[t].active)return t;return{}},extractedForm(){return this.formValidation.extractForm(this.form)},extractedFormLabels(){return this.formValidation.extractFormLabels(this.form)}},methods:{__:b,popupResolver:K,toggle(t){for(let e in this.form.tabs)this.form.tabs[e].active=!1;this.form.tabs[t].active=!0},async handleSaved(t,e,s){this.form.tabs[e].fields.filter(u=>{u.name===s.name&&t.data.entry&&(u.options.push({label:t.data.entry[this.optionAttributes.label],value:t.data.entry[this.optionAttributes.value]}),u.value=t.data.entry.id)})},handleClose(){this.popup&&this.popupResolver(!1)},submit(){if(this.formValidation.validateForm(this.form).length>0)return w.error(b("The form is not valid. Double check it or refer to the error dislayed above."),b("Close"));if(this.formValidation.disableForm(this.form),this.submitUrl===void 0)return w.error(b("No submit URL was provided"),b("Okay"));L[this.submitMethod?this.submitMethod.toLowerCase():"post"](this.appendQueryParamas(this.submitUrl),this.formValidation.extractForm(this.form)).subscribe(e=>{if(e.status==="success")if(this.popup)this.popupResolver(e);else{if(this.submitMethod&&this.submitMethod.toLowerCase()==="post"&&this.links.list!==!1)return document.location=e.data.editUrl||this.links.list;w.info(e.message,b("Okay"),{duration:3e3}),this.$emit("saved",e)}this.formValidation.enableForm(this.form)},e=>{w.error(e.message,void 0,{duration:5e3}),e.data!==void 0&&this.formValidation.triggerError(this.form,e.data),this.formValidation.enableForm(this.form)})},handleGlobalChange(t){this.globallyChecked=t,this.rows.forEach(e=>e.$checked=t)},loadForm(){return new Promise((t,e)=>{L.get(`${this.appendQueryParamas(this.src)}`).subscribe({next:u=>{t(u),this.form=this.parseForm(u.form),this.links=u.links,this.optionAttributes=u.optionAttributes,nsHooks.doAction("ns-crud-form-loaded",this),this.form.main&&setTimeout(()=>{this.$el.querySelector("#crud-form input").focus()},100),this.$emit("updated",this.form)},error:u=>{e(u),w.error(u.message,b("Okay"),{duration:0})}})})},appendQueryParamas(t){if(this.queryParams===void 0)return t;const e=Object.keys(this.queryParams).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(this.queryParams[s])}`).join("&");return t.includes("?")?`${t}&${e}`:`${t}?${e}`},parseForm(t){t.main.value=t.main.value===void 0?"":t.main.value,t.main=this.formValidation.createFields([t.main])[0];let e=0;for(let s in t.tabs)e===0&&(t.tabs[s].active=!0),t.tabs[s].active=t.tabs[s].active===void 0?!1:t.tabs[s].active,t.tabs[s].fields=this.formValidation.createFields(t.tabs[s].fields),t.tabs[s].subject=new Te({}),t.tabs[s].fields.forEach(u=>{u.subject=t.tabs[s].subject}),t.tabs[s].component&&t.tabs[s].instance===void 0&&(t.tabs[s].instance={object:W(this.extraComponents()[t.tabs[s].component]),errors:[]}),e++;return t},handleFieldChange(t,e){t.errors.length===0&&t.subject.next({field:t,fields:e})},handleTabError(t){this.form.tabs[this.activeTabIdentifier].instance.errors=[],t!==!1?this.form.tabs[this.activeTabIdentifier].instance.errors.push(...t):this.form.tabs[this.activeTabIdentifier].instance.errors=[]},handleTabChange(t){this.form.tabs[this.activeTabIdentifier].fields=t}}},Ss={key:0,class:"flex items-center justify-center h-full"},Ts={key:1,class:"box-header border-b border-box-edge box-border p-2 flex justify-between items-center"},Es={class:"text-fontcolor font-bold text-lg"},Os={class:"flex flex-col"},Ms={key:0,class:"flex justify-between items-center"},Fs={for:"title",class:"font-bold my-2"},As={key:0},js={for:"title",class:"text-sm my-2"},Ps=["href"],Ls=["disabled"],Rs=["disabled"],$s={key:0,class:"text-xs text-fontcolor py-1"},Hs={key:0},Is={key:1},Vs={class:"header flex ml-4",style:{"margin-bottom":"-1px"}},Ys=["onClick"],zs={class:"ns-tab-item"},qs={class:"border p-4 rounded"},Bs={key:0,class:"-mx-4 flex flex-wrap"},Ns={key:1,class:"-mx-4 flex flex-wrap"},Us={key:1,class:"px-4 text-center"},Ws={class:"text-error-tertiary border-dashed border-error-tertiary border p-4"},Ks={key:2,class:"flex justify-end"},Gs=["disabled"];function Qs(t,e,s,u,d,l){const a=y("ns-spinner"),o=y("ns-close-button"),h=y("ns-field");return Object.values(t.form).length>0?(i(),r("div",{key:0,class:g(["form flex-auto",s.popup?"ns-box w-[95vw] md:w-[66vw] max-h-[80vh] overflow-hidden flex flex-col":""]),id:"crud-form"},[Object.values(t.form).length===0?(i(),r("div",Ss,[O(a)])):c("",!0),s.popup?(i(),r("div",Ts,[n("h2",Es,f(s.popup.params.title),1),n("div",null,[O(o,{onClick:e[0]||(e[0]=m=>l.handleClose())})])])):c("",!0),Object.values(t.form).length>0?(i(),r("div",{key:2,class:g(s.popup?"p-2 overflow-y-auto":"")},[n("div",Os,[t.form.main?(i(),r("div",Ms,[n("label",Fs,[t.form.main.name?(i(),r("span",As,f(t.form.main.label),1)):c("",!0)]),n("div",js,[t.links.list&&!s.popup?(i(),r("a",{key:0,href:t.links.list,class:"rounded-full border px-2 py-1 ns-inset-button error"},f(l.__("Go Back")),9,Ps)):c("",!0)])])):c("",!0),t.form.main.name?(i(),r(p,{key:1},[n("div",{class:g([t.form.main.disabled?"disabled":t.form.main.errors.length>0?"error":"primary","input-group flex border rounded overflow-hidden"])},[P(n("input",{"onUpdate:modelValue":e[1]||(e[1]=m=>t.form.main.value=m),onKeydown:e[2]||(e[2]=Y(m=>l.submit(),["enter"])),onKeypress:e[3]||(e[3]=m=>t.formValidation.checkField(t.form.main,l.extractedForm,l.extractedFormLabels)),onBlur:e[4]||(e[4]=m=>t.formValidation.checkField(t.form.main,l.extractedForm,l.extractedFormLabels)),onChange:e[5]||(e[5]=m=>t.formValidation.checkField(t.form.main,l.extractedForm,l.extractedFormLabels)),disabled:t.form.main.disabled,type:"text",class:"flex-auto outline-hidden h-10 px-2"},null,40,Ls),[[R,t.form.main.value]]),n("button",{disabled:t.form.main.disabled,class:g([t.form.main.disabled?"disabled":t.form.main.errors.length>0?"error":"","outline-hidden px-4 h-10 text-white"]),onClick:e[6]||(e[6]=m=>l.submit())},f(l.__("Save")),11,Rs)],2),t.form.main.description&&t.form.main.errors.length===0?(i(),r("p",$s,f(t.form.main.description),1)):c("",!0),(i(!0),r(p,null,E(t.form.main.errors,(m,v)=>(i(),r("p",{key:v,class:"text-xs py-1 text-error-secondary"},[m.identifier==="required"?(i(),r("span",Hs,[S(t.$slots,"error-required",{},()=>[x(f(m.identifier),1)])])):c("",!0),m.identifier==="invalid"?(i(),r("span",Is,[S(t.$slots,"error-invalid",{},()=>[x(f(m.message),1)])])):c("",!0)]))),128))],64)):c("",!0)]),s.disableTabs!=="true"?(i(),r("div",{key:0,id:"tabs-container",class:g([s.popup?"mt-5":"my-5","ns-tab"])},[n("div",Vs,[(i(!0),r(p,null,E(t.form.tabs,(m,v)=>(i(),r("div",{key:v,onClick:k=>l.toggle(v),class:g([m.active?"active border":"inactive border","tab rounded-tl rounded-tr border px-3 py-2 cursor-pointer"]),style:{"margin-right":"-1px"}},f(m.label),11,Ys))),128))]),n("div",zs,[n("div",qs,[(l.activeTabFields&&l.activeTabFields.length)>0&&!l.activeTab.component?(i(),r("div",Bs,[(i(!0),r(p,null,E(l.activeTabFields,(m,v)=>(i(),r("div",{key:`${l.activeTabIdentifier}-${v}`,class:g(s.fieldClass||"px-4 w-full md:w-1/2 lg:w-1/3")},[O(h,{onSaved:k=>l.handleSaved(k,l.activeTabIdentifier,m),onBlur:k=>t.formValidation.checkField(m,l.extractedForm,l.extractedFormLabels),onKeyup:k=>t.formValidation.checkField(m,l.extractedForm,l.extractedFormLabels)&&l.handleFieldChange(m,l.activeTabFields),field:m},null,8,["onSaved","onBlur","onKeyup","field"])],2))),128))])):c("",!0),l.activeTab&&l.activeTab.component?(i(),r("div",Ns,[l.activeTab.instance.object?(i(),r("div",{key:`${l.activeTabIdentifier}`,class:g(s.fieldClass||"px-4 w-full")},[(i(),F(se,null,[(i(),F(q(l.activeTab.instance.object),{onChanged:e[7]||(e[7]=m=>l.handleTabChange(m)),onInvalid:e[8]||(e[8]=m=>l.handleTabError(m)),tab:l.activeTab},null,40,["tab"]))],1024))],2)):(i(),r("div",Us,[n("div",Ws,f(l.__("Failed to load the component: {component}".replace("{component}",l.activeTab.component))),1)]))])):c("",!0),t.form.main.name?c("",!0):(i(),r("div",Ks,[n("div",{class:g(["ns-button",t.form.main.disabled?"default":t.form.main.errors.length>0?"error":"info"])},[n("button",{disabled:t.form.main.disabled,onClick:e[9]||(e[9]=m=>l.submit()),class:"outline-hidden px-4 h-10 border-l"},f(l.__("Save")),9,Gs)],2)]))])])],2)):c("",!0)],2)):c("",!0)],2)):c("",!0)}const Js=C(Ds,[["render",Qs]]),Xs={data:()=>({}),mounted(){},computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"bg-input-edge cursor-not-allowed":"bg-transparent"},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"}},props:["placeholder","leading","type","field"]},Zs=["for"],el={class:"text-fontcolor-soft mt-1 mb-2 relative overflow-hidden border rounded-md focus:shadow-sm"},tl={key:0,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},sl={class:"sm:text-sm sm:leading-5"},ll=["disabled","id","placeholder"];function nl(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(["flex flex-auto flex-col mb-2 ns-date",l.hasError?"has-error":"is-pristine"])},[n("label",{for:s.field.name,class:"block leading-5 font-medium"},[S(t.$slots,"default")],8,Zs),n("div",el,[s.leading?(i(),r("div",tl,[n("span",sl,f(s.leading),1)])):c("",!0),P(n("input",{disabled:s.field.disabled,"onUpdate:modelValue":e[0]||(e[0]=o=>s.field.value=o),onBlur:e[1]||(e[1]=o=>t.$emit("blur",this)),onChange:e[2]||(e[2]=o=>t.$emit("change",this)),id:s.field.name,type:"date",class:g([l.inputClass,"form-input block w-full sm:text-sm sm:leading-5 h-10"]),placeholder:s.placeholder},null,42,ll),[[R,s.field.value]])]),O(a,{field:s.field},null,8,["field"])],2)}const il=C(Xs,[["render",nl]]),rl={name:"ns-date-time-picker",props:["field","date"],data(){return{visible:!1,hours:0,minutes:0,currentView:"days",currentDay:void 0,moment:D}},computed:{fieldDate(){return this.field?D(this.field.value).isValid()?D(this.field.value):D():this.date?D(this.date):D()}},mounted(){let t=D(this.field.value);t.isValid()?this.setDate(t.format("YYYY-MM-DD HH:mm:ss")):this.setDate(D(ns.date.current).format("YYYY-MM-DD HH:mm:ss"))},methods:{__:b,setDate(t){this.field.value=t}}},dl={class:"picker mb-2"},ol={key:0,class:"block leading-5 font-medium text-font"},al={class:"ns-button"},ul={key:0},cl={key:1},fl={key:0},hl={key:1},ml={key:1,class:"text-sm text-fontcolor-soft py-1"},bl={key:2,class:"relative z-10 h-0 w-0"};function gl(t,e,s,u,d,l){const a=y("ns-calendar");return i(),r("div",dl,[s.field&&s.field.label&&s.field.label.length>0?(i(),r("label",ol,f(s.field.label),1)):c("",!0),n("div",al,[n("button",{onClick:e[0]||(e[0]=o=>d.visible=!d.visible),class:g([s.field&&s.field.label&&s.field.label.length>0?"mt-1 border border-input-edge":"","shadow rounded cursor-pointer w-full p-1 flex items-center text-font"])},[e[5]||(e[5]=n("i",{class:"las la-clock text-xl"},null,-1)),s.field?(i(),r(p,{key:0},[[null,"",void 0].includes(s.field.value)?c("",!0):(i(),r("span",ul,f(l.fieldDate.format("YYYY-MM-DD HH:mm")),1)),[null,"",void 0].includes(s.field.value)?(i(),r("span",cl,"N/A")):c("",!0)],64)):c("",!0),s.date?(i(),r(p,{key:1},[[null,"",void 0].includes(s.date)?c("",!0):(i(),r("span",fl,f(l.fieldDate.format("YYYY-MM-DD HH:mm")),1)),[null,"",void 0].includes(s.date)?(i(),r("span",hl,"N/A")):c("",!0)],64)):c("",!0)],2)]),s.field?(i(),r("p",ml,f(s.field.description),1)):c("",!0),d.visible?(i(),r("div",bl,[n("div",{class:g([s.field&&s.field.label&&s.field.label.length>0?"-mt-4":"mt-2","absolute w-72 shadow-xl rounded ns-box anim-duration-300 zoom-in-entrance flex flex-col"])},[s.field?(i(),F(a,{key:0,onOnClickOut:e[1]||(e[1]=o=>d.visible=!1),onSet:e[2]||(e[2]=o=>l.setDate(o)),visible:d.visible,date:s.field.value},null,8,["visible","date"])):c("",!0),s.date?(i(),F(a,{key:1,onOnClickOut:e[3]||(e[3]=o=>d.visible=!1),onSet:e[4]||(e[4]=o=>l.setDate(o)),visible:d.visible,date:s.date},null,8,["visible","date"])):c("",!0)],2)])):c("",!0)])}const re=C(rl,[["render",gl]]),vl={name:"ns-datepicker",components:{nsCalendar:ie},props:["label","date","format"],computed:{formattedDate(){return D(this.date).format(this.format||"YYYY-MM-DD HH:mm:ss")}},data(){return{visible:!1}},mounted(){},methods:{__:b,setDate(t){this.$emit("set",t)}}},pl={class:"picker"},yl={class:"ns-button"},_l={class:"mx-1 text-sm"},xl={key:0},kl={key:1},wl={key:0,class:"relative h-0 w-0 -mb-2"},Cl={class:"w-72 mt-2 shadow-lg anim-duration-300 zoom-in-entrance flex flex-col ns-floating-panel"};function Dl(t,e,s,u,d,l){const a=y("ns-calendar");return i(),r("div",pl,[n("div",yl,[n("button",{onClick:e[0]||(e[0]=o=>d.visible=!d.visible),class:"rounded cursor-pointer border shadow w-full px-1 py-1 flex items-center text-font"},[e[3]||(e[3]=n("i",{class:"las la-clock text-2xl"},null,-1)),n("span",_l,[n("span",null,f(s.label||l.__("Date"))+" : ",1),s.date?(i(),r("span",xl,f(l.formattedDate),1)):(i(),r("span",kl,f(l.__("N/A")),1))])])]),d.visible?(i(),r("div",wl,[n("div",Cl,[O(a,{visible:d.visible,onOnClickOut:e[1]||(e[1]=o=>d.visible=!1),date:s.date,onSet:e[2]||(e[2]=o=>l.setDate(o))},null,8,["visible","date"])])])):c("",!0)])}const Sl=C(vl,[["render",Dl]]),Tl={name:"ns-daterange-picker",data(){return{leftCalendar:D(),rightCalendar:D().add(1,"months"),rangeViewToggled:!1,clickedOnCalendar:!1}},mounted(){this.field.value||this.clearDate(),document.addEventListener("click",this.checkClickedItem)},beforeUnmount(){document.removeEventListener("click",this.checkClickedItem)},watch:{leftCalendar(){this.leftCalendar.isSame(this.rightCalendar,"month")&&this.rightCalendar.add(1,"months")},rightCalendar(){this.rightCalendar.isSame(this.leftCalendar,"month")&&this.leftCalendar.sub(1,"months")}},methods:{__:b,setDateRange(t,e){this.field.value[t]=e,D(this.field.value.startDate).isBefore(D(this.field.value.endDate))&&this.$emit("change",this.field)},getFormattedDate(t){return t!==null?D(t).format("YYYY-MM-DD HH:mm"):b("N/D")},clearDate(){this.field.value={startDate:null,endDate:null}},toggleRangeView(){this.rangeViewToggled=!this.rangeViewToggled},handleDateRangeClick(){this.clickedOnCalendar=!0},checkClickedItem(t){this.$el.getAttribute("class").split(" ").includes("ns-daterange-picker")&&(!this.$el.contains(t.srcElement)&&!this.clickedOnCalendar&&this.rangeViewToggled&&(this.$emit("blur",this.field),this.toggleRangeView()),setTimeout(()=>{this.clickedOnCalendar=!1},100))}},computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"bg-gray-200 cursor-not-allowed":"bg-transparent"},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"},startDateFormatted(){return this.field.value!==void 0&&D(this.field.value.startDate).isValid()?D(this.field.value.startDate).format("YYYY-MM-DD HH:mm"):!1},endDateFormatted(){return this.field.value!==void 0&&D(this.field.value.endDate).isValid()?D(this.field.value.endDate).format("YYYY-MM-DD HH:mm"):!1}},props:["placeholder","leading","type","field"]},El=["for"],Ol={class:"border border-input-edge rounded-tl rounded-bl flex-auto flex"},Ml={key:0,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},Fl={class:"text-fontcolor sm:text-sm sm:leading-5"},Al={class:""},jl={class:""},Pl={key:0,class:"relative h-0 w-0"},Ll={class:"z-10 absolute md:w-[550px] w-[225px] mt-2 shadow-lg anim-duration-300 zoom-in-entrance flex flex-col"},Rl={class:"flex flex-col md:flex-row bg-box-background rounded-lg"};function $l(t,e,s,u,d,l){const a=y("ns-calendar"),o=y("ns-field-description");return i(),r("div",{onClick:e[4]||(e[4]=h=>l.handleDateRangeClick()),class:"flex flex-auto flex-col mb-2 ns-daterange-picker"},[n("label",{for:s.field.name,class:g([l.hasError?"text-error-primary":"text-font","block leading-5 font-medium"])},[S(t.$slots,"default")],10,El),n("div",{class:g([l.hasError?"error":"","mt-1 relative flex input-group bg-input-background rounded overflow-hidden shadow focus:shadow-sm"])},[n("div",Ol,[s.leading?(i(),r("div",Ml,[n("span",Fl,f(s.leading),1)])):c("",!0),n("div",{class:"flex flex-auto p-1 text-fontcolor text-sm items-center cursor-pointer",onClick:e[0]||(e[0]=h=>l.toggleRangeView())},[e[5]||(e[5]=n("span",{class:"mr-1"},[n("i",{class:"las la-clock text-2xl"})],-1)),n("span",Al,f(l.startDateFormatted||l.__("N/A")),1),e[6]||(e[6]=n("span",{class:"mx-2"},"â€”",-1)),e[7]||(e[7]=n("span",{class:"mr-1"},[n("i",{class:"las la-clock text-2xl"})],-1)),n("span",jl,f(l.endDateFormatted||l.__("N/A")),1)])]),n("button",{class:"px-3 outline-hidden font-bold bg-error-tertiary",onClick:e[1]||(e[1]=h=>l.clearDate())},[...e[8]||(e[8]=[n("i",{class:"las la-times"},null,-1)])])],2),d.rangeViewToggled?(i(),r("div",Pl,[n("div",Ll,[n("div",Rl,[O(a,{class:"md:w-1/2 w-full",range:[l.startDateFormatted,l.endDateFormatted],side:"left",date:s.field.value.startDate,"selected-range":s.field.value,onSet:e[2]||(e[2]=h=>l.setDateRange("startDate",h))},null,8,["range","date","selected-range"]),e[9]||(e[9]=n("div",{class:"flex-auto border-input-edge border-l border-r"},null,-1)),O(a,{class:"md:w-1/2 w-full",range:[l.startDateFormatted,l.endDateFormatted],side:"right",date:s.field.value.endDate,"selected-range":s.field.value,onSet:e[3]||(e[3]=h=>l.setDateRange("endDate",h))},null,8,["range","date","selected-range"])])])])):c("",!0),O(o,{field:s.field},null,8,["field"])])}const Hl=C(Tl,[["render",$l]]),Il={mounted(){console.log(this.parent)},props:["parent"],methods:{__:b,resetDefault(){Popup.show(nsConfirmPopup,{title:b("Confirm Your Action"),message:b("This will clear all records and accounts. It's ideal if you want to start from scratch. Are you sure you want to reset default settings for accounting?"),onAction:t=>{t&&this.resetDefaultAccounting()}})},resetDefaultAccounting(){nsHttpClient.get("/api/transactions-accounts/reset-defaults").subscribe({next:t=>{w.success(t.message),this.parent.loadSettingsForm()},error:t=>{w.error(t.message)}})}}};function Vl(t,e,s,u,d,l){const a=y("ns-button");return i(),F(a,{onClick:e[0]||(e[0]=o=>l.resetDefault()),type:"warning"},{default:T(()=>[x(f(l.__("Reset Default")),1)]),_:1})}const Yl=C(Il,[["render",Vl]]),zl={name:"ns-dropzone",emits:["dropped"],mounted(){},setup(t,{emit:e}){return{dropZone:V(null),handleDrop:d=>{const l=d.dataTransfer.getData("text");e("dropped",l)}}}};function ql(t,e,s,u,d,l){return i(),r("div",{ref:"dropZone",class:"ns-drop-zone mb-4",onDragover:e[0]||(e[0]=Oe(()=>{},["prevent"]))},[S(t.$slots,"default",{},void 0,!0)],544)}const de=C(zl,[["render",ql],["__scopeId","data-v-2d2d8b6c"]]),Bl={emits:["drag-start","drag-end"],name:"ns-draggable",props:{widget:{required:!0}},setup(t,{emit:e}){const s=V(null),u=V(null);V({});let d=null,l=0,a=0,o=0,h=0;const m=M=>{if(M.target.closest(".widget-handle")===null)return;const A=M.srcElement.closest(".ns-draggable-item"),H=A.getBoundingClientRect();d=A.cloneNode(!0),d.setAttribute("class","ns-ghost"),d.style.display="none",d.style.position="fixed",d.style.top=`${H.top}px`,d.style.left=`${H.left}px`,d.style.width=`${H.width}px`,d.style.height=`${H.height}px`,A.closest(".ns-drop-zone").appendChild(d),A.style.filter="grayscale(1) opacity(0.5)",l=M.clientX-o,a=M.clientY-h,u.value={dom:A},e("drag-start",t.widget)},v=M=>{if(u.value===null)return;const j=u.value.dom.closest(".ns-drop-zone").querySelector(".ns-ghost"),A=j.querySelector("div");Array.from(A.classList).filter($=>$.startsWith("shadow")).forEach($=>A.classList.remove($)),o=M.clientX-l,h=M.clientY-a,A.style.boxShadow="0px 4px 10px 5px rgb(0 0 0 / 48%)",j.style.display="block",j.style.transform=`translate(${o}px, ${h}px)`,j.classList.add("z-10"),j.classList.add("widget-grabbed"),document.querySelectorAll(".ns-drop-zone").forEach($=>{$.getBoundingClientRect();const{left:N,top:U,right:_,bottom:fe}=$.getBoundingClientRect(),{clientX:X,clientY:Z}=M;X>=N&&X<=_&&Z>=U&&Z<=fe?$.setAttribute("hovered","true"):$.setAttribute("hovered","false")})},k=M=>{if(u.value===null)return;const A=u.value.dom.closest(".ns-drop-zone").querySelector(".ns-ghost");A&&A.remove(),u.value=null,o=0,h=0,M.srcElement.closest(".ns-drop-zone"),e("drag-end",t.widget)};return le(()=>{s.value&&(document.addEventListener("mousemove",M=>v(M)),document.addEventListener("mouseup",M=>k(M)))}),De(()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",k)}),{draggable:s,startDrag:m}}};function Nl(t,e,s,u,d,l){return i(),r("div",{ref:"draggable",class:"ns-draggable-item",onMousedown:e[0]||(e[0]=(...a)=>u.startDrag&&u.startDrag(...a))},[S(t.$slots,"default")],544)}const oe=C(Bl,[["render",Nl]]),Ul={name:"ns-dragzone",props:["raw-widgets","raw-columns"],components:{nsDropzone:de,nsDraggable:oe},data(){return{widgets:[],theme:ns.theme,dragged:null,isDragging:!1,columns:[]}},mounted(){this.widgets=this.rawWidgets.map(t=>({name:t.name,"component-name":t["component-name"],"class-name":t["class-name"],component:W(window[t["component-name"]])})),this.columns=this.rawColumns.map(t=>(t.widgets.forEach(e=>{e.component=W(window[e.identifier]),e["class-name"]=e.class_name,e["component-name"]=e.identifier}),t)),document.addEventListener("mousemove",t=>{if(this.isDragging===!1)return;document.querySelectorAll(".intermediate-dropzone").forEach((u,d)=>{const l=u.getBoundingClientRect(),{left:a,top:o,right:h,bottom:m}=l,{clientX:v,clientY:k}=t;v>=a&&v<=h&&k>=o&&k<=m?(u.setAttribute("hovered","true"),u.classList.add("slide-fade-entrance")):(u.setAttribute("hovered","false"),u.classList.remove("slide-fade-entrance"))}),document.querySelectorAll(".widget-placeholder").forEach(u=>{const d=u.getBoundingClientRect(),{left:l,top:a,right:o,bottom:h}=d,{clientX:m,clientY:v}=t;m>=l&&m<=o&&v>=a&&v<=h?u.setAttribute("hovered","true"):u.setAttribute("hovered","false")})})},computed:{hasUnusedWidgets(){const t=this.columns.map(e=>e.widgets).flat();return this.widgets.filter(e=>!t.map(u=>u["component-name"]).includes(e["component-name"])).length>0}},methods:{__:b,handleStartDragging(t){this.isDragging=!0},handleEndDragging(t){this.isDragging=!1;const e=document.querySelector('.widget-placeholder[hovered="true"]'),s=document.querySelector('.intermediate-dropzone[hovered="true"]');e?this.processAppendingToColumn(t):s?this.proceedMoveToSpecificLocation(t,s):this.processRegularWidgetSwapping(t),this.removeSpecialEffect()},removeSpecialEffect(){document.querySelectorAll(".ns-draggable-item").forEach(e=>{e.removeAttribute("style")})},proceedMoveToSpecificLocation(t,e){const s=e.getAttribute("data-index"),u=this.columns.filter(o=>o.name===t.column)[0],d=u.widgets.indexOf(t);u.widgets.splice(d,1);const l=e.closest("[column-name]").getAttribute("column-name"),a=this.columns.filter(o=>o.name===l)[0];t.position=s,t.column=a.name,a.widgets.splice(s,0,t),this.handleChange(a),this.handleChange(u),e.setAttribute("hovered","false")},processAppendingToColumn(t){const e=document.querySelector('.widget-placeholder[hovered="true"]');if(e){const s=this.columns.filter(a=>a.name===t.column)[0],u=s.widgets.indexOf(t);s.widgets.splice(u,1);const d=e.closest("[column-name]").getAttribute("column-name"),l=this.columns.filter(a=>a.name===d)[0];t.position=l.widgets.length,t.column=d,l.widgets.push(t),this.handleChange(l),this.handleChange(s)}},processRegularWidgetSwapping(t){const e=document.querySelector('.ns-drop-zone[hovered="true"]');if(e){const d=e.closest("[column-name]").getAttribute("column-name"),l=this.columns.filter(A=>A.name===d),a=l[0].widgets.filter(A=>A["component-name"]===e.querySelector(".ns-draggable-item").getAttribute("component-name")),o=document.querySelector(`[component-name="${t["component-name"]}"]`),m=o.closest("[column-name]").getAttribute("column-name"),v=this.columns.filter(A=>A.name===m),k=v[0].widgets.filter(A=>A["component-name"]===o.getAttribute("component-name"));if(e.setAttribute("hovered","false"),k[0]["component-name"]===a[0]["component-name"])return;const M=k[0].position,j=a[0].position;k[0].column=d,k[0].position=j,a[0].column=m,a[0].position=M,l[0].widgets[j]=k[0],v[0].widgets[M]=a[0],this.handleChange(l[0]),this.handleChange(v[0])}const s=document.querySelector('.widget-placeholder[hovered="true"]');if(s){const u=s.closest("[column-name]").getAttribute("column-name");if(t===u){console.log("The widget is already in the same column.");return}const d=this.columns.filter(o=>o.name===t.column)[0],l=d.widgets.indexOf(t);d.widgets.splice(l,1);const a=this.columns.filter(o=>o.name===u)[0];t.position=a.widgets.length,t.column=u,a.widgets.push(t),this.handleChange(d),this.handleChange(a)}},handleChange(t,e){setTimeout(()=>{nsHttpClient.post("/api/users/widgets",{column:t}).subscribe(s=>{},s=>w.error(s.message||b("An unpexpected error occured while using the widget.")))},100)},handleRemoveWidget(t,e){const s=e.widgets.indexOf(t);e.widgets.splice(s,1),this.handleChange(e)},async openWidgetAdded(t){try{const e=this.columns.filter(a=>a.name!==t.name?a.widgets.length>0:!1).map(a=>a.widgets).flat(),s=t.widgets.map(a=>a["component-name"]),u=this.widgets.filter(a=>{const o=e.map(h=>h["component-name"]);return o.push(...s),!o.includes(a["component-name"])}).map(a=>({value:a,label:a.name})),d=await new Promise((a,o)=>{const h=u.filter(m=>s.includes(m["component-name"]));Popup.show(he,{value:h,resolve:a,reject:o,type:"multiselect",options:u,label:b("Choose Widget"),description:b("Select with widget you want to add to the column.")})}),l=this.columns.indexOf(t);this.columns[l].widgets=[...this.columns[l].widgets,...d].map((a,o)=>(a.position=o,a.column=t.name,a)),this.handleChange(this.columns[l])}catch(e){console.log(e)}}}},Wl={class:"flex md:-mx-2 flex-wrap"},Kl=["column-name"],Gl=["data-index"],Ql=["onClick"],Jl={class:"text-sm text-font",type:"info"},Xl={key:1,class:"widget-placeholder cursor-pointer border-2 border-dashed h-16 flex items-center justify-center"},Zl={class:"text-sm text-font",type:"info"};function en(t,e,s,u,d,l){const a=y("ns-draggable"),o=y("ns-dropzone");return i(),r("div",Wl,[(i(!0),r(p,null,E(d.columns,(h,m)=>(i(),r("div",{class:"w-full md:px-2 md:w-1/2 lg:w-1/3 xl:1/4","column-name":h.name,key:h.name},[(i(!0),r(p,null,E(h.widgets,(v,k)=>(i(),r(p,null,[n("div",{"data-index":k,class:"intermediate-dropzone anim-duration-500"},[...e[2]||(e[2]=[n("div",null,null,-1)])],8,Gl),O(o,null,{default:T(()=>[O(a,{"component-name":v["component-name"],onDragStart:e[0]||(e[0]=M=>l.handleStartDragging(M)),onDragEnd:e[1]||(e[1]=M=>l.handleEndDragging(M)),widget:v},{default:T(()=>[(i(),F(q(v.component),{onOnRemove:M=>l.handleRemoveWidget(v,h),widget:v},null,40,["onOnRemove","widget"]))]),_:2},1032,["component-name","widget"])]),_:2},1024)],64))),256)),l.hasUnusedWidgets?(i(),r("div",{key:0,onClick:v=>l.openWidgetAdded(h),class:"widget-placeholder cursor-pointer border-2 border-dashed h-16 flex items-center justify-center"},[n("span",Jl,f(l.__("Drop widget / click to add")),1)],8,Ql)):c("",!0),d.isDragging&&!l.hasUnusedWidgets?(i(),r("div",Xl,[n("span",Zl,f(l.__("Drop the widget here")),1)])):c("",!0)],8,Kl))),128))])}const tn=C(Ul,[["render",en]]),sn={data:()=>({sizeMapping:{52:"w-52",64:"w-64",72:"w-72",80:"w-80",96:"w-96",128:"w-128",144:"w-144",160:"w-160"}}),name:"ns-switch",emits:["change","blur"],mounted(){},computed:{_options(){return this.field.options.map(t=>(t.selected=t.value===this.field.value,t))},hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"ns-disabled cursor-not-allowed":""},sizeClass(){return` w-1/${this._options.length<=4?this._options.length:4}`},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"}},methods:{__:b,setSelected(t){this.field.value=t.value,this._options.forEach(e=>e.selected=!1),t.selected=!0,this.$forceUpdate(),this.$emit("change",t.value)}},props:["placeholder","leading","type","field","size"]},ln=["for"],nn=["disabled","onClick"],rn={key:1,class:"text-xs ns-description"};function dn(t,e,s,u,d,l){return i(),r("div",{class:g(["ns-switch",(l.hasError?"has-error":"is-pristine")+" "+(s.field.label?"mb-2":"")])},[s.field.label?(i(),r("label",{key:0,for:s.field.name,class:"block leading-5 font-medium"},[S(t.$slots,"default")],8,ln)):c("",!0),n("div",{class:g([t.sizeMapping[s.size]||"w-52","rounded-lg flex overflow-hidden shadow my-1"])},[(i(!0),r(p,null,E(l._options,(a,o)=>(i(),r("button",{disabled:a.disabled,key:o,onClick:h=>l.setSelected(a),class:g([a.selected?"selected "+l.sizeClass:"unselected "+l.inputClass+" "+l.sizeClass,"p-2 text-sm flex-no-wrap outline-hidden rounded-none"])},f(a.label),11,nn))),128))],2),!s.field.errors||s.field.errors.length===0?(i(),r("p",rn,[S(t.$slots,"description")])):c("",!0),(i(!0),r(p,null,E(s.field.errors,(a,o)=>(i(),r("p",{key:o,class:"text-xs ns-error"},[a.identifier==="required"?S(t.$slots,a.identifier,{key:0},()=>[x(f(l.__("This field is required.")),1)]):c("",!0)]))),128))],2)}const ae=C(sn,[["render",dn]]),on={emits:["blur","change","saved","keypress","keyup"],data:()=>({formSubjectSubscription:null}),mounted(){},components:{nsDateTimePicker:re,nsSwitch:ae},computed:{isInputField(){return["text","password","email","number","tel"].includes(this.field.type)},isHiddenField(){return["hidden"].includes(this.field.type)},isDateField(){return["date"].includes(this.field.type)},isSelectField(){return["select"].includes(this.field.type)},isSearchField(){return["search-select"].includes(this.field.type)},isTextarea(){return["textarea"].includes(this.field.type)},isCheckbox(){return["checkbox"].includes(this.field.type)},isMultiselect(){return["multiselect"].includes(this.field.type)},isInlineMultiselect(){return["inline-multiselect"].includes(this.field.type)},isSelectAudio(){return["select-audio"].includes(this.field.type)},isSwitch(){return["switch"].includes(this.field.type)},isMedia(){return["media"].includes(this.field.type)},isCkEditor(){return["ckeditor"].includes(this.field.type)},isDateTimePicker(){return["datetimepicker"].includes(this.field.type)},isDateRangePicker(){return["daterangepicker"].includes(this.field.type)},isCustom(){return["custom"].includes(this.field.type)}},props:["field"],methods:{handleSaved(t,e){this.$emit("saved",e)},addOption(t){this.field.type==="select"&&this.field.options.forEach(s=>s.selected=!1),t.selected=!0;const e=this.field.options.indexOf(t);this.field.options.splice(e,1),this.field.options.unshift(t),this.refreshMultiselect(),this.$emit("change",{action:"addOption",option:t})},changeTouchedState(t,e){e&&e.stopPropagation&&e.stopPropagation(),t.touched=!0,this.$emit("change",t)},refreshMultiselect(){this.field.value=this.field.options.filter(t=>t.selected).map(t=>t.value)},removeOption(t){t.selected=!1,this.refreshMultiselect(),this.$emit("change",{action:"removeOption",option:t})}}},an=["name","value"],un=["innerHTML"],cn=["innerHTML"],fn=["innerHTML"],hn=["innerHTML"],mn=["innerHTML"],bn=["innerHTML"],gn=["innerHTML"],vn=["innerHTML"],pn=["innerHTML"],yn=["innerHTML"],_n=["innerHTML"],xn=["innerHTML"],kn=["innerHTML"],wn=["innerHTML"];function Cn(t,e,s,u,d,l){const a=y("ns-input"),o=y("ns-date"),h=y("ns-media-input"),m=y("ns-select"),v=y("ns-search-select"),k=y("ns-daterange-picker"),M=y("ns-date-time-picker"),j=y("ns-select-audio"),A=y("ns-textarea"),H=y("ns-checkbox"),B=y("ns-inline-multiselect"),$=y("ns-multiselect"),N=y("ns-ckeditor"),U=y("ns-switch");return i(),r(p,null,[l.isHiddenField?(i(),r("input",{key:0,type:"hidden",name:s.field.name,value:s.field.value},null,8,an)):c("",!0),l.isHiddenField?c("",!0):(i(),r("div",{key:1,class:g(["flex flex-auto",s.field.label?"mb-2":""])},[l.isInputField?(i(),F(a,{key:0,onKeyup:e[0]||(e[0]=_=>t.$emit("keyup",_)),onKeypress:e[1]||(e[1]=_=>l.changeTouchedState(s.field,_)),onChange:e[2]||(e[2]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,un)]),_:1},8,["field"])):c("",!0),l.isDateField?(i(),F(o,{key:1,onBlur:e[3]||(e[3]=_=>t.$emit("blur",s.field)),onChange:e[4]||(e[4]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,cn)]),_:1},8,["field"])):c("",!0),l.isMedia?(i(),F(h,{key:2,onBlur:e[5]||(e[5]=_=>t.$emit("blur",s.field)),onChange:e[6]||(e[6]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,fn)]),_:1},8,["field"])):c("",!0),l.isSelectField?(i(),F(m,{key:3,onChange:e[7]||(e[7]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,hn)]),_:1},8,["field"])):c("",!0),l.isSearchField?(i(),F(v,{key:4,field:s.field,onSaved:e[8]||(e[8]=_=>l.handleSaved(s.field,_)),onChange:e[9]||(e[9]=_=>l.changeTouchedState(s.field,_))},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,mn)]),_:1},8,["field"])):c("",!0),l.isDateRangePicker?(i(),F(k,{key:5,onBlur:e[10]||(e[10]=_=>t.$emit("blur",s.field)),onChange:e[11]||(e[11]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,bn)]),_:1},8,["field"])):c("",!0),l.isDateTimePicker?(i(),F(M,{key:6,onBlur:e[12]||(e[12]=_=>t.$emit("blur",s.field)),onChange:e[13]||(e[13]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,gn)]),_:1},8,["field"])):c("",!0),l.isSelectAudio?(i(),F(j,{key:7,onBlur:e[14]||(e[14]=_=>t.$emit("blur",s.field)),onChange:e[15]||(e[15]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,vn)]),_:1},8,["field"])):c("",!0),l.isTextarea?(i(),F(A,{key:8,onBlur:e[16]||(e[16]=_=>t.$emit("blur",s.field)),onChange:e[17]||(e[17]=_=>l.changeTouchedState(s.field,_)),field:s.field},{description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,pn)]),default:T(()=>[n("template",null,[x(f(s.field.label),1)])]),_:1},8,["field"])):c("",!0),l.isCheckbox?(i(),F(H,{key:9,onBlur:e[18]||(e[18]=_=>t.$emit("blur",s.field)),onChange:e[19]||(e[19]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,yn)]),_:1},8,["field"])):c("",!0),l.isInlineMultiselect?(i(),F(B,{key:10,onBlur:e[20]||(e[20]=_=>t.$emit("blur",s.field)),onUpdate:e[21]||(e[21]=_=>l.changeTouchedState(s.field,_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,_n)]),_:1},8,["field"])):c("",!0),l.isMultiselect?(i(),F($,{key:11,onAddOption:e[22]||(e[22]=_=>l.addOption(_)),onRemoveOption:e[23]||(e[23]=_=>l.removeOption(_)),field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,xn)]),_:1},8,["field"])):c("",!0),l.isCkEditor?(i(),F(N,{key:12,field:s.field},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,kn)]),_:1},8,["field"])):c("",!0),l.isSwitch?(i(),F(U,{key:13,field:s.field,onChange:e[24]||(e[24]=_=>l.changeTouchedState(s.field,_))},{default:T(()=>[x(f(s.field.label),1)]),description:T(()=>[n("span",{innerHTML:s.field.description||""},null,8,wn)]),_:1},8,["field"])):c("",!0),l.isCustom?(i(),F(se,{key:14},[(i(),F(q(s.field.component),{field:s.field,onBlur:e[25]||(e[25]=_=>t.$emit("blur",s.field)),onChange:e[26]||(e[26]=_=>l.changeTouchedState(s.field,_))},null,40,["field"]))],1024)):c("",!0)],2))],64)}const Dn=C(on,[["render",Cn]]),Sn={name:"ns-field-detail",props:["field"],data(){return{validation:new Q}},methods:{__:b}},Tn={key:0,class:"text-xs ns-description"},En={key:0,class:"text-xs ns-error"};function On(t,e,s,u,d,l){return!s.field.errors||s.field.errors.length===0?(i(),r("p",Tn,f(s.field.description),1)):(i(!0),r(p,{key:1},E(s.field.errors,(a,o)=>(i(),r("p",{key:o,class:"text-xs ns-error"},[s.field.custom_errors?(i(),r(p,{key:0},[s.field.custom_errors[a.identifier]?(i(),r("p",En,f(s.field.custom_errors[a.identifier]),1)):c("",!0)],64)):(i(),r(p,{key:1},[a.identifier==="required"?S(t.$slots,a.identifier,{key:0},()=>[x(f(l.__("This field is required.")),1)]):c("",!0),a.identifier==="email"?S(t.$slots,a.identifier,{key:1},()=>[x(f(l.__("This field must contain a valid email address.")),1)]):c("",!0),a.identifier==="invalid"?S(t.$slots,a.identifier,{key:2},()=>[x(f(a.message),1)]):c("",!0),a.identifier==="same"?S(t.$slots,a.identifier,{key:3},()=>[x(f(l.__('This field must be similar to "{other}"').replace("{other}",this.validation.getValueByDotNotation(a.labels,a.rule.value))),1)]):c("",!0),a.identifier==="min"?S(t.$slots,a.identifier,{key:4},()=>[x(f(l.__('This field must have at least "{length}" characters').replace("{length}",a.rule.value)),1)]):c("",!0),a.identifier==="max"?S(t.$slots,a.identifier,{key:5},()=>[x(f(l.__('This field must have at most "{length}" characters').replace("{length}",a.rule.value)),1)]):c("",!0),a.identifier==="different"?S(t.$slots,a.identifier,{key:6},()=>[x(f(l.__('This field must be different from "{other}"').replace("{other}",this.validation.getValueByDotNotation(a.labels,a.rule.value))),1)]):c("",!0),a.identifier==="regex"?S(t.$slots,a.identifier,{key:7},()=>[x(f(l.__('This field must match the pattern "{pattern}"').replace("{pattern}",a.rule.value)),1)]):c("",!0),e[0]||(e[0]=x("Ã§Ã  ",-1))],64))]))),128))}const Mn=C(Sn,[["render",On]]),Fn={props:["className","buttonClass","type"]};function An(t,e,s,u,d,l){return i(),r("button",{class:g([s.type?s.type:s.buttonClass,"ns-inset-button rounded-full h-6 min-w-[1.5rem] border border-input-edge items-center justify-center"])},[n("i",{class:g([s.className,"las"])},null,2)],2)}const jn=C(Fn,[["render",An]]),Pn={name:"ns-input-label",props:["field"],data(){return{tags:[],searchField:"",focused:!1,optionsToKeyValue:{}}},methods:{addOption(t){let e;this.optionSuggestions.length===1&&t===void 0?e=this.optionSuggestions[0]:t!==void 0&&(e=t),e!==void 0&&(this.field.value.filter(u=>u===e.value).length>0||(this.searchField="",this.field.value.push(e.value),this.$emit("change",this.field)))},removeOption(t){const e=this.field.value.filter(s=>s!==t);this.field.value=e}},mounted(){if(this.$refs.searchField.addEventListener("focus",t=>{this.focused=!0}),this.$refs.searchField.addEventListener("blur",t=>{setTimeout(()=>{this.focused=!1},200)}),this.field.value.length===void 0)try{this.field.value=JSON.parse(this.field.value)}catch{this.field.value=[]}this.field.options.forEach(t=>{this.optionsToKeyValue[t.value]=t.label})},computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},optionSuggestions(){if(typeof this.field.value.map=="function"){const t=this.field.value.map(e=>e.value);return this.field.options.filter(e=>!t.includes(e.value)&&this.focused>0&&(e.label.search(this.searchField)>-1||e.value.search(this.searchField)>-1))}return[]},disabledClass(){return this.field.disabled?"ns-disabled cursor-not-allowed":""},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":""}},props:["placeholder","leading","type","field"]},Ln=["for"],Rn={key:0,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},$n={class:"leading sm:text-sm sm:leading-5"},Hn=["disabled","id","type","placeholder"],In={class:"selected-option"},Vn={class:"flex items-center justify-center text-font"},Yn={class:"flex items-center justify-center px-1"},zn=["onClick"],qn={class:"relative"},Bn=["placeholder"],Nn={class:"h-0 absolute w-full z-10"},Un={class:"shadow menu absoluve bottom-0 w-full max-h-80 overflow-y-auto"},Wn=["onClick"];function Kn(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(["flex flex-col mb-2 flex-auto ns-inline-multiselect",l.hasError?"has-error":"is-pristine"])},[s.field.label&&s.field.label.length>0?(i(),r("label",{key:0,for:s.field.name,class:"block leading-5 font-medium"},[S(t.$slots,"default")],8,Ln)):c("",!0),n("div",{class:g([s.field.description||s.field.errors>0?"mb-2":"","mt-1 relative rounded-md focus:shadow-sm"])},[s.leading?(i(),r("div",Rn,[n("span",$n,f(s.leading),1)])):c("",!0),n("div",{disabled:s.field.disabled,id:s.field.name,type:s.field.type,class:g([l.inputClass,"flex sm:text-sm sm:leading-5 p-1 flex-wrap"]),placeholder:s.field.placeholder||""},[(i(!0),r(p,null,E(s.field.value,o=>(i(),r("div",In,[n("div",Vn,f(d.optionsToKeyValue[o]),1),n("div",Yn,[n("div",{onClick:h=>l.removeOption(o),class:"cursor-pointer rounded-full h-5 w-5 flex items-center justify-center"},[...e[3]||(e[3]=[n("i",{class:"las la-times-circle"},null,-1)])],8,zn)])]))),256)),n("div",qn,[P(n("input",{onChange:e[0]||(e[0]=o=>o.stopPropagation()),onKeydown:e[1]||(e[1]=Y(o=>l.addOption(),["enter"])),ref:"searchField","onUpdate:modelValue":e[2]||(e[2]=o=>d.searchField=o),type:"text",class:"w-auto p-2 border-b border-dashed bg-transparent",placeholder:s.field.placeholder||"Start searching here..."},null,40,Bn),[[R,d.searchField]]),n("div",Nn,[n("div",Un,[n("ul",null,[(i(!0),r(p,null,E(l.optionSuggestions,o=>(i(),r("li",{onClick:h=>l.addOption(o),class:"p-2 hover:bg-box-elevation-hover text-fontcolor cursor-pointer"},f(o.label),9,Wn))),256))])])])])],10,Hn)],2),O(a,{field:s.field},null,8,["field"])],2)}const Gn=C(Pn,[["render",Kn]]),Qn={data:()=>({}),mounted(){},computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"ns-disabled cursor-not-allowed":""},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"}},props:["placeholder","leading","type","field"]},Jn=["for"],Xn={key:0,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},Zn={class:"leading sm:text-sm sm:leading-5"},ei={key:1,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},ti={class:"prefix sm:text-sm sm:leading-5"},si=["disabled","id","type","placeholder"],li={key:2,class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},ni={class:"suffix sm:text-sm sm:leading-5"};function ii(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(["flex flex-col mb-2 flex-auto ns-input",l.hasError?"has-error":"is-pristine"])},[s.field.label&&s.field.label.length>0?(i(),r("label",{key:0,for:s.field.name,class:"block leading-5 font-medium"},[S(t.$slots,"default")],8,Jn)):c("",!0),n("div",{class:g([s.field.description||s.field.errors>0?"mb-2":"","mt-1 relative overflow-hidden border rounded-md focus:shadow-sm"])},[s.leading?(i(),r("div",Xn,[n("span",Zn,f(s.leading),1)])):c("",!0),s.field.prefix?(i(),r("div",ei,[n("span",ti,f(s.field.prefix),1)])):c("",!0),P(n("input",{disabled:s.field.disabled,"onUpdate:modelValue":e[0]||(e[0]=o=>s.field.value=o),id:s.field.name,type:s.type||s.field.type||"text",class:g([l.inputClass,"block w-full sm:text-sm sm:leading-5 h-10"]),placeholder:s.field.placeholder||""},null,10,si),[[ne,s.field.value]]),s.field.suffix?(i(),r("div",li,[n("span",ni,f(s.field.suffix),1)])):c("",!0)],2),O(a,{field:s.field},null,8,["field"])],2)}const ri=C(Qn,[["render",ii]]),di={data:()=>({clicked:!1,_save:0}),props:["type","to","href","target"],computed:{buttonclass(){switch(this.type){case"info":return"shadow bg-info-secondary text-white";case"success":return"shadow bg-success-secondary text-white";case"error":return"shadow bg-error-secondary text-white";case"warning":return"shadow bg-warning-secondary text-white";default:return"shadow bg-white text-gray-800"}}}},oi={class:"flex"},ai=["target","href"];function ui(t,e,s,u,d,l){return i(),r("div",oi,[s.href?(i(),r("a",{key:0,target:s.target,href:s.href,class:g([l.buttonclass,"rounded cursor-pointer py-2 px-3 font-semibold"])},[S(t.$slots,"default")],10,ai)):c("",!0)])}const ci=C(di,[["render",ui]]),ue={zip:"la-file-archive",tar:"la-file-archive",bz:"la-file-archive","7z":"la-file-archive",css:"la-file-code",js:"la-file-code",json:"la-file-code",docx:"la-file-word",doc:"la-file-word",mp3:"la-file-audio",aac:"la-file-audio",ods:"la-file-audio",pdf:"la-file-pdf",csv:"la-file-csv",avi:"la-file-video",mpeg:"la-file-video",mpkg:"la-file-video",unknown:"la-file"},fi={name:"ns-media",props:["popup"],data(){return{searchFieldDebounce:null,searchField:"",pages:[{label:b("Upload"),name:"upload",selected:!1},{label:b("Gallery"),name:"gallery",selected:!0}],resources:[],isDragging:!1,response:{data:[],current_page:0,from:0,to:0,next_page_url:"",prev_page_url:"",path:"",per_page:0,total:0,last_page:0,first_page:0},fileIcons:ue,queryPage:1,bulkSelect:!1,files:[]}},mounted(){this.popupCloser();const t=this.pages.filter(e=>e.name==="gallery")[0];this.select(t),window.addEventListener("paste",this.handlePasteUpload)},beforeDestroy(){window.removeEventListener("paste",this.handlePasteUpload)},watch:{searchField(){clearTimeout(this.searchFieldDebounce),this.searchFieldDebounce=setTimeout(()=>{this.loadGallery(1)},500)}},computed:{postMedia(){return nsHooks.applyFilters("http-client-url","/api/medias")},currentPage(){return this.pages.filter(t=>t.selected)[0]},hasOneSelected(){return this.response.data.filter(t=>t.selected).length>0},selectedResource(){return this.response.data.filter(t=>t.selected)[0]},csrf(){return ns.authentication.csrf},isPopup(){return typeof this.popup<"u"},user_id(){return this.isPopup&&this.popup.params.user_id||0},panelOpened(){return!this.bulkSelect&&this.hasOneSelected},popupInstance(){return this.popup}},methods:{popupCloser:G,__:b,cancelBulkSelect(){this.bulkSelect=!1,this.response.data.forEach(t=>t.selected=!1)},openError(t){I.show(te,{title:b("An error occured"),message:t.error.message||b("An unexpected error occured.")})},deleteSelected(){I.show(z,{title:b("Confirm Your Action"),message:b("You're about to delete selected resources. Would you like to proceed?"),onAction:t=>{t&&L.post("/api/medias/bulk-delete",{ids:this.response.data.filter(e=>e.selected).map(e=>e.id)}).subscribe({next:e=>{w.success(e.message),this.loadGallery()},error:e=>{w.error(e.message)}})}})},loadUploadScreen(){setTimeout(()=>{this.setDropZone()},1e3)},setDropZone(){const t=document.getElementById("dropping-zone");t.addEventListener("dragenter",s=>this.preventDefaults(s),!1),t.addEventListener("dragleave",s=>this.preventDefaults(s),!1),t.addEventListener("dragover",s=>this.preventDefaults(s),!1),t.addEventListener("drop",s=>this.preventDefaults(s),!1),["dragenter","dragover"].forEach(s=>{t.addEventListener(s,()=>{this.isDragging=!0})}),["dragleave","drop"].forEach(s=>{t.addEventListener(s,()=>{this.isDragging=!1})}),t.addEventListener("drop",s=>this.handleDrop(s),!1),this.$refs.files.addEventListener("change",s=>this.processFiles(s.currentTarget.files))},async uploadFiles(){const t=this.files.filter(e=>e.uploaded===!1&&e.progress===0&&e.failed===!1);for(let e=0;e<t.length;e++){const s=t[e];try{s.progress=1;const u=await new Promise((d,l)=>{const a=new FormData;a.append("file",s.file),L.post("/api/medias",a,{headers:{"Content-Type":"multipart/form-data"}}).subscribe({next:o=>{s.uploaded=!0,s.progress=100,w.success(o.message||b("File uploaded successfully."),b("OK")),this.loadGallery(),d(o)},error:o=>{t[e].failed=!0,t[e].error=o,w.error(o.message||b("Failed to upload file."),b("OK")),l(o)}})})}catch{s.failed=!0,w.error(b("An unexpected error occurred during file upload."),b("OK"))}}},handleDrop(t){this.processFiles(t.dataTransfer.files),t.preventDefault(),t.stopPropagation()},preventDefaults(t){t.preventDefault(),t.stopPropagation()},getAllParents(t){let e=[];for(;t.parentNode&&t.parentNode.nodeName.toLowerCase()!="body";)t=t.parentNode,e.push(t);return e},triggerManualUpload(t){const e=t.target;if(e!==null){const u=this.getAllParents(e).map(d=>{const l=d.getAttribute("class");if(l)return l.split(" ")});if(e.getAttribute("class")){const d=e.getAttribute("class").split(" ");u.push(d)}u.flat().includes("ns-scrollbar")||this.$refs.files.click()}},processFiles(t){console.log({files:t});const e=Array.from(t),s=e.filter(d=>(console.log(this),Object.values(window.ns.medias.mimes).includes(d.type))),u=e.length-s.length;u>0&&w.error(u===1?b("1 file was rejected due to invalid file type."):b("%s files were rejected due to invalid file type.").replace("%s",u.toString()),b("OK")),s.forEach(d=>{this.files.unshift({file:d,uploaded:!1,failed:!1,progress:0})}),s.length>0?this.uploadFiles():e.length>0&&s.length===0&&w.error(b("No valid files selected. Please select supported file types."),b("OK"))},select(t){this.pages.forEach(e=>e.selected=!1),t.selected=!0,t.name==="gallery"?this.loadGallery():t.name==="upload"&&this.loadUploadScreen()},loadGallery(t=null){t=t===null?this.queryPage:t,this.queryPage=t,L.get(`/api/medias?page=${t}&user_id=${this.user_id}${this.searchField.length>0?`&search=${this.searchField}`:""}`).subscribe({next:e=>{e.data.forEach(s=>s.selected=!1),this.response=e},error:e=>{w.error(e.message||b("An error occurred while loading the media gallery."),b("OK")),console.error("Media gallery loading error:",e)}})},submitChange(t,e){L.put(`/api/medias/${e.id}`,{name:t.srcElement.textContent}).subscribe({next:s=>{e.fileEdit=!1,w.success(s.message,"OK")},error:s=>{e.fileEdit=!1,w.success(s.message||b("An unexpected error occured."),"OK")}})},useSelectedEntries(){this.popup.params.resolve({event:"use-selected",value:this.response.data.filter(t=>t.selected)}),this.popup.close()},selectResource(t){this.bulkSelect||this.response.data.forEach((e,s)=>{s!==this.response.data.indexOf(t)&&(e.selected=!1)}),t.fileEdit=!1,t.selected=!t.selected},isImage(t){return Object.keys(ns.medias.imageMimes).includes(t.extension)},handlePasteUpload(t){if(this.currentPage.name==="upload"&&t.clipboardData)try{const e=t.clipboardData.items;let s=!1;for(let u=0;u<e.length;u++){const d=e[u];if(d.kind==="file"&&d.type.startsWith("image/")){const l=d.getAsFile();l&&(s=!0,this.files.unshift({file:l,uploaded:!1,failed:!1,progress:0}))}}s?this.uploadFiles():w.error(b("No valid image found in clipboard."),b("OK"))}catch(e){w.error(b("Error processing clipboard content."),b("OK")),console.error("Clipboard paste error:",e)}}}},hi={class:"sidebar w-48 md:h-full flex-shrink-0"},mi={class:"text-xl font-bold my-4 text-center"},bi={class:"sidebar-menus flex md:block mt-8"},gi=["onClick"],vi={key:0,class:"content flex-auto w-full flex-col overflow-hidden flex"},pi={key:0,class:"p-2 flex bg-box-background flex-shrink-0 justify-between"},yi={class:"cursor-pointer font-bold text-center text-fontcolor mb-4"},_i={style:{display:"none"},type:"file",name:"",multiple:"",ref:"files",id:""},xi={class:"rounded ns-box rounded-lg shadow w-full md:w-2/3 text-fontcolor p-2"},ki={class:"h-56 overflow-y-auto ns-scrollbar"},wi={key:0},Ci={key:0,class:"rounded bg-info-primary flex items-center justify-center text-xs p-2"},Di=["onClick"],Si={class:"ml-2"},Ti={key:1,class:"h-full w-full items-center justify-center flex text-center text-soft-tertiary"},Ei={key:1,class:"content flex-auto flex-col w-full overflow-hidden flex"},Oi={key:0,class:"p-2 flex bg-box-background flex-shrink-0 justify-between"},Mi={class:"flex flex-auto overflow-hidden"},Fi={class:"shadow flex-auto flex flex-col"},Ai={class:"p-2 border-b border-input-edge"},ji={class:"ns-input border border-input-edge overflow-hidden rounded flex"},Pi=["placeholder"],Li={key:0,class:"flex items-center justify-center w-20 p-1"},Ri={class:"flex flex-auto overflow-hidden"},$i={key:0,class:"p-2 flex-auto overflow-y-auto ns-scrollbar"},Hi={class:"grid grid-cols-2 md:grid-cols-3 gap-1 lg:grid-cols-4 xl:grid-cols-6"},Ii=["onClick"],Vi=["src","alt"],Yi={key:1,class:"object-cover h-full flex items-center justify-center"},zi={key:1,class:"flex flex-auto items-center justify-center"},qi={class:"text-2xl font-bold"},Bi={id:"preview",class:"ns-media-preview-panel hidden lg:block w-64 flex-shrink-0"},Ni={key:0,class:"h-64 bg-gray-800 flex items-center justify-center"},Ui=["src","alt"],Wi={key:1,class:"object-cover h-full flex items-center justify-center"},Ki={key:1,id:"details",class:"p-4 text-gray-700 text-sm"},Gi={class:"flex flex-col mb-2"},Qi={class:"font-bold block"},Ji=["contenteditable"],Xi={class:"flex flex-col mb-2"},Zi={class:"font-bold block"},er={class:"flex flex-col mb-2"},tr={class:"font-bold block"},sr={class:"py-2 pr-2 flex ns-media-footer text-sm flex-shrink-0 justify-between"},lr={class:"flex -mx-2 flex-shrink-0"},nr={key:0,class:"px-2"},ir={class:"ns-button shadow rounded overflow-hidden info"},rr={key:1,class:"px-2"},dr={class:"ns-button shadow rounded overflow-hidden info"},or={key:2,class:"px-2"},ar={class:"ns-button shadow rounded overflow-hidden warning"},ur={class:"flex-shrink-0 -mx-2 flex"},cr={class:"px-2"},fr={class:"rounded shadow overflow-hidden flex text-sm"},hr=["disabled"],mr=["disabled"],br={key:0,class:"px-2"},gr={class:"ns-button info"};function vr(t,e,s,u,d,l){const a=y("ns-close-button");return i(),r("div",{class:g(["flex md:flex-row flex-col ns-box overflow-hidden",l.isPopup?"w-[85.71vw] h-[95vh] shadow-xl":"m-4 w-auto h-full rounded-lg"]),id:"ns-media"},[n("div",hi,[n("h3",mi,f(l.__("Medias Manager")),1),n("ul",bi,[(i(!0),r(p,null,E(d.pages,(o,h)=>(i(),r("li",{onClick:m=>l.select(o),class:g(["py-2 px-3 cursor-pointer border-l-8",o.selected?"active":""]),key:h},f(o.label),11,gi))),128))])]),l.currentPage.name==="upload"?(i(),r("div",vi,[l.isPopup?(i(),r("div",pi,[e[13]||(e[13]=n("div",null,null,-1)),n("div",null,[O(a,{onClick:e[0]||(e[0]=o=>l.popupInstance.close())})])])):c("",!0),n("div",{id:"dropping-zone",onClick:e[1]||(e[1]=o=>l.triggerManualUpload(o)),class:g([d.isDragging?"border-dashed border":"","flex flex-auto m-2 p-2 flex-col border-info-primary items-center justify-center"])},[n("h3",yi,f(l.__("Click here or drop your files to upload.")),1),n("input",_i,null,512),n("div",xi,[n("div",ki,[d.files.length>0?(i(),r("ul",wi,[(i(!0),r(p,null,E(d.files,(o,h)=>(i(),r("li",{class:g([o.failed===!1?"border-info-secondary":"border-error-secondary","p-2 mb-2 border-b-2 flex items-center justify-between"]),key:h},[n("span",null,f(o.file.name),1),o.failed===!1?(i(),r("span",Ci,f(o.progress)+"%",1)):c("",!0),o.failed===!0?(i(),r("div",{key:1,onClick:m=>l.openError(o),class:"rounded bg-error-primary hover:bg-error-secondary hover:text-white flex items-center justify-center text-xs p-2 cursor-pointer"},[e[14]||(e[14]=n("i",{class:"las la-eye"},null,-1)),e[15]||(e[15]=x()),n("span",Si,f(l.__("See Error")),1)],8,Di)):c("",!0)],2))),128))])):c("",!0),d.files.length===0?(i(),r("div",Ti,f(l.__("Your uploaded files will displays here.")),1)):c("",!0)])])],2)])):c("",!0),l.currentPage.name==="gallery"?(i(),r("div",Ei,[l.isPopup?(i(),r("div",Oi,[e[16]||(e[16]=n("div",null,null,-1)),n("div",null,[O(a,{onClick:e[2]||(e[2]=o=>l.popupInstance.close())})])])):c("",!0),n("div",Mi,[n("div",Fi,[n("div",Ai,[n("div",ji,[P(n("input",{id:"search",type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>d.searchField=o),placeholder:l.__("Search Medias"),class:"px-4 block w-full sm:text-sm sm:leading-5 h-10"},null,8,Pi),[[R,d.searchField]]),d.searchField.length>0?(i(),r("div",Li,[n("button",{onClick:e[4]||(e[4]=o=>d.searchField=""),class:"h-full w-full rounded-tr rounded-br overflow-hidden"},f(l.__("Cancel")),1)])):c("",!0)])]),n("div",Ri,[d.response.data.length>0?(i(),r("div",$i,[n("div",Hi,[(i(!0),r(p,null,E(d.response.data,(o,h)=>(i(),r("div",{key:h},[n("div",null,[n("div",{onClick:m=>l.selectResource(o),class:g([o.selected?"ns-media-image-selected border-secondary ":"border-transparent","border-4 aspect-square bg-secondary/50 overflow-hidden flex items-center justify-center"])},[l.isImage(o)?(i(),r("img",{key:0,class:"object-cover h-full",src:o.sizes.thumb,alt:o.name},null,8,Vi)):c("",!0),l.isImage(o)?c("",!0):(i(),r("div",Yi,[n("i",{class:g([d.fileIcons[o.extension]||d.fileIcons.unknown,"las text-8xl text-white"])},null,2)]))],10,Ii)])]))),128))])])):c("",!0),d.response.data.length===0?(i(),r("div",zi,[n("h3",qi,f(l.__("Nothing has already been uploaded")),1)])):c("",!0)])]),n("div",Bi,[l.panelOpened?(i(),r("div",Ni,[l.isImage(l.selectedResource)?(i(),r("img",{key:0,class:"object-cover h-full",src:l.selectedResource.sizes.thumb,alt:l.selectedResource.name},null,8,Ui)):c("",!0),l.isImage(l.selectedResource)?c("",!0):(i(),r("div",Wi,[n("i",{class:g([d.fileIcons[l.selectedResource.extension]||d.fileIcons.unknown,"las text-8xl text-white"])},null,2)]))])):c("",!0),l.panelOpened?(i(),r("div",Ki,[n("p",Gi,[n("strong",Qi,f(l.__("File Name"))+": ",1),n("span",{class:g(["p-2",l.selectedResource.fileEdit?"border-b border-input-edge bg-input-background":""]),onBlur:e[5]||(e[5]=o=>l.submitChange(o,l.selectedResource)),contenteditable:l.selectedResource.fileEdit?"true":"false",onClick:e[6]||(e[6]=o=>l.selectedResource.fileEdit=!0)},f(l.selectedResource.name),43,Ji)]),n("p",Xi,[n("strong",Zi,f(l.__("Uploaded At"))+":",1),n("span",null,f(l.selectedResource.created_at),1)]),n("p",er,[n("strong",tr,f(l.__("By"))+" :",1),n("span",null,f(l.selectedResource.user.username),1)])])):c("",!0)])]),n("div",sr,[n("div",lr,[d.bulkSelect?(i(),r("div",nr,[n("div",ir,[n("button",{onClick:e[7]||(e[7]=o=>l.cancelBulkSelect()),class:"py-2 px-3"},[e[17]||(e[17]=n("i",{class:"las la-times"},null,-1)),x(" "+f(l.__("Cancel")),1)])])])):c("",!0),l.hasOneSelected&&!d.bulkSelect?(i(),r("div",rr,[n("div",dr,[n("button",{onClick:e[8]||(e[8]=o=>d.bulkSelect=!0),class:"py-2 px-3"},[e[18]||(e[18]=n("i",{class:"las la-check-circle"},null,-1)),x(" "+f(l.__("Bulk Select")),1)])])])):c("",!0),l.hasOneSelected?(i(),r("div",or,[n("div",ar,[n("button",{onClick:e[9]||(e[9]=o=>l.deleteSelected()),class:"py-2 px-3"},[e[19]||(e[19]=n("i",{class:"las la-trash"},null,-1)),x(" "+f(l.__("Delete")),1)])])])):c("",!0)]),n("div",ur,[n("div",cr,[n("div",fr,[n("div",{class:g(["ns-button",d.response.current_page===1?"disabled cursor-not-allowed":"info"])},[n("button",{disabled:d.response.current_page===1,onClick:e[10]||(e[10]=o=>l.loadGallery(d.response.current_page-1)),class:"p-2"},f(l.__("Previous")),9,hr)],2),e[20]||(e[20]=n("hr",{class:"border-r mx-1 border-gray-700"},null,-1)),n("div",{class:g(["ns-button",d.response.current_page===d.response.last_page?"disabled cursor-not-allowed":"info"])},[n("button",{disabled:d.response.current_page===d.response.last_page,onClick:e[11]||(e[11]=o=>l.loadGallery(d.response.current_page+1)),class:"p-2"},f(l.__("Next")),9,mr)],2)])]),l.isPopup&&l.hasOneSelected?(i(),r("div",br,[n("div",gr,[n("button",{class:"rounded shadow p-2 text-sm",onClick:e[12]||(e[12]=o=>l.useSelectedEntries())},f(l.__("Use Selected")),1)])])):c("",!0)])])])):c("",!0)],2)}const ce=C(fi,[["render",vr]]),Ra=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"})),pr={computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"ns-disabled cursor-not-allowed":""},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"}},data(){return{fileIcons:ue}},props:["placeholder","leading","type","field"],mounted(){},methods:{isImage(t){return Object.keys(ns.medias.imageMimes).includes(t.extension)},toggleMedia(){new Promise((e,s)=>{I.show(ce,{resolve:e,reject:s,...this.field.data||{}})}).then(e=>{e.event==="use-selected"&&(!this.field.data||this.field.data.type==="url"?this.field.value=e.value[0].sizes.original:!this.field.data||this.field.data.type==="model"?(this.field.value=e.value[0].id,this.field.data.model=e.value[0]):this.field.value=e.value[0].sizes.original,this.$forceUpdate())})}}},yr=["for"],_r={class:"mt-1 relative border rounded-md focus:shadow-sm"},xr={key:0,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},kr={class:"text-fontcolor sm:text-sm sm:leading-5"},wr={class:"rounded overflow-hidden flex"},Cr={key:0,class:"form-input flex w-full sm:text-sm items-center sm:leading-5 h-10"},Dr=["src","alt"],Sr={key:1,class:"object-cover flex items-center justify-center"},Tr={class:"text-xs text-fontcolor-soft"},Er=["disabled","id","type","placeholder"];function Or(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(["flex flex-col mb-2 flex-auto ns-media",l.hasError?"has-error":"is-pristine"])},[n("label",{for:s.field.name,class:"block leading-5 font-medium"},[S(t.$slots,"default")],8,yr),n("div",_r,[s.leading?(i(),r("div",xr,[n("span",kr,f(s.leading),1)])):c("",!0),n("div",wr,[s.field.data&&s.field.data.type==="model"?(i(),r("div",Cr,[s.field.value&&s.field.data.model.name?(i(),r(p,{key:0},[l.isImage(s.field.data.model)?(i(),r("img",{key:0,class:"w-8 h-8 m-1",src:s.field.data.model.sizes.thumb,alt:s.field.data.model.name},null,8,Dr)):c("",!0),l.isImage(s.field.data.model)?c("",!0):(i(),r("div",Sr,[n("i",{class:g([d.fileIcons[s.field.data.model.extension]||d.fileIcons.unknown,"las text-3xl"])},null,2)])),n("span",Tr,f(s.field.data.model.name),1)],64)):c("",!0)])):c("",!0),!s.field.data||s.field.data.type==="undefined"||s.field.data.type==="url"?P((i(),r("input",{key:1,"onUpdate:modelValue":e[0]||(e[0]=o=>s.field.value=o),disabled:s.field.disabled,onBlur:e[1]||(e[1]=o=>t.$emit("blur",this)),onChange:e[2]||(e[2]=o=>t.$emit("change",this)),id:s.field.name,type:s.type||s.field.type||"text",class:g([l.inputClass,"form-input block w-full sm:text-sm sm:leading-5 h-10"]),placeholder:s.placeholder},null,42,Er)),[[ne,s.field.value]]):c("",!0),n("button",{onClick:e[3]||(e[3]=o=>l.toggleMedia(s.field)),class:"w-10 h-10 flex items-center justify-center border-l outline-hidden"},[...e[4]||(e[4]=[n("i",{class:"las la-photo-video"},null,-1)])])])]),O(a,{field:s.field},null,8,["field"])],2)}const Mr=C(pr,[["render",Or]]),Fr={data:()=>({defaultToggledState:!1,_save:0,hasChildren:!1}),props:["href","to","label","icon","notification","toggled","identifier"],mounted(){this.hasChildren=this.$el.querySelectorAll(".submenu").length>0,this.defaultToggledState=this.toggled!==void 0?this.toggled:this.defaultToggledState,nsEvent.subject().subscribe(t=>{t.value!==this.identifier&&(this.defaultToggledState=!1)})},methods:{toggleEmit(){this.toggle().then(t=>{t&&nsEvent.emit({identifier:"side-menu.open",value:this.identifier})})},goTo(t,e){return this.$router.push(t),e.preventDefault(),!1},toggle(){return new Promise((t,e)=>{(!this.href||this.href.length===0)&&(this.defaultToggledState=!this.defaultToggledState,t(this.defaultToggledState))})}}},Ar=["href"],jr={class:"flex items-center"},Pr={key:0,class:"rounded-full notification-label font-bold w-6 h-6 text-xs justify-center items-center flex"},Lr=["href"],Rr={class:"flex items-center"},$r={key:0,class:"rounded-full notification-label font-bold w-6 h-6 text-xs justify-center items-center flex"},Hr={key:1,class:"flex items-center"},Ir={key:0,class:"las la-angle-down"},Vr={key:1,class:"las la-angle-up"};function Yr(t,e,s,u,d,l){return i(),r("li",null,[s.to&&!t.hasChildren?(i(),r("a",{key:0,onClick:e[0]||(e[0]=a=>l.goTo(s.to,a)),href:s.to,class:g([t.defaultToggledState?"toggled":"normal","flex justify-between py-2 border-l-8 px-3 font-bold ns-aside-menu"])},[n("span",jr,[n("i",{class:g(["las text-lg mr-2",s.icon?.length>0?s.icon:"la-star"])},null,2),x(" "+f(s.label),1)]),s.notification>0?(i(),r("span",Pr,f(s.notification),1)):c("",!0)],10,Ar)):(i(),r("a",{key:1,onClick:e[1]||(e[1]=a=>l.toggleEmit()),href:s.href||"javascript:void(0)",class:g([t.defaultToggledState?"toggled":"normal","flex justify-between py-2 border-l-8 px-3 font-bold ns-aside-menu"])},[n("span",Rr,[n("i",{class:g(["las text-lg mr-2",s.icon?.length>0?s.icon:"la-star"])},null,2),x(" "+f(s.label),1)]),s.notification>0?(i(),r("span",$r,f(s.notification),1)):c("",!0),t.hasChildren?(i(),r("span",Hr,[t.defaultToggledState?c("",!0):(i(),r("i",Ir)),t.defaultToggledState?(i(),r("i",Vr)):c("",!0)])):c("",!0)],10,Lr)),n("ul",{class:g([t.defaultToggledState?"":"hidden","submenu-wrapper"])},[S(t.$slots,"default")],2)])}const zr=C(Fr,[["render",Yr]]),qr={data(){return{showPanel:!1,search:"",eventListener:null}},emits:["change","blur"],props:["field"],computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},_filtredOptions(){let t=this._options;return this.search.length>0&&(t=this._options.filter(e=>e.label.toLowerCase().search(this.search.toLowerCase())!==-1)),t.filter(e=>e.selected===!1)},_options(){return this.field.options.map(t=>(t.selected=t.selected===void 0?!1:t.selected,this.field.value&&this.field.value.includes(t.value)&&(t.selected=!0),t))}},methods:{__:b,togglePanel(){this.field.disabled||(this.showPanel=!this.showPanel)},selectAvailableOptionIfPossible(){this._filtredOptions.length>0&&this.addOption(this._filtredOptions[0])},addOption(t){this.field.disabled||(this.$emit("addOption",t),this.$forceUpdate(),setTimeout(()=>{this.search=""},100))},removeOption(t,e){if(!this.field.disabled)return e.preventDefault(),e.stopPropagation(),this.$emit("removeOption",t),this.$forceUpdate(),setTimeout(()=>{this.search=""},100),!1}},mounted(){this.field.value&&this.field.value.reverse().forEach(e=>{const s=this.field.options.filter(u=>u.value===e);s.length>0&&this.addOption(s[0])}),this.eventListener=document.addEventListener("click",t=>{let s=t.target.parentElement,u=!1;if(this.showPanel){for(;s;){if(s&&s.classList.contains("ns-multiselect")&&!s.classList.contains("arrows")){u=!0;break}s=s.parentElement}u===!1&&this.togglePanel()}})}},Br=["for"],Nr={class:"flex flex-col"},Ur={class:"flex -mx-1 -my-1 flex-wrap"},Wr={class:"rounded selected-pills flex justify-between p-1 items-center"},Kr={class:"pr-8 text-xs"},Gr=["onClick"],Qr={class:"arrows ml-1"},Jr={class:"ns-dropdown shadow border rounded-b-md"},Xr={class:"search border-b border-input-option-hover"},Zr={class:"h-40 overflow-y-auto"},ed=["onClick"],td={key:0,class:"las la-check"},sd={key:0,class:"p-2 text-center text-fontcolor"},ld={class:"my-2"};function nd(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(["flex flex-col ns-multiselect",l.hasError?"has-error":"is-pristine"])},[n("label",{for:s.field.name,class:"block mb-1 leading-5 font-medium"},[S(t.$slots,"default")],8,Br),n("div",Nr,[n("div",{onClick:e[0]||(e[0]=o=>l.togglePanel()),class:g([(s.field.disabled?"disabled":"")+" "+(d.showPanel?"toggled":"untoggled"),"overflow-y-auto flex select-preview justify-between border p-2 items-start"]),style:{"max-height":"150px"}},[n("div",Ur,[(i(!0),r(p,null,E(l._options.filter(o=>o.selected),(o,h)=>(i(),r("div",{key:h,class:"px-1 my-1"},[n("div",Wr,[n("span",Kr,f(o.label),1),n("button",{onClick:m=>l.removeOption(o,m),class:"rounded outline-hidden hover:bg-info-tertiary h-4 w-4 flex items-center justify-center"},[...e[3]||(e[3]=[n("i",{class:"las la-times"},null,-1)])],8,Gr)])]))),128))]),n("div",Qr,[n("span",{class:g(d.showPanel?"":"hidden")},[...e[4]||(e[4]=[n("i",{class:"las la-angle-down"},null,-1)])],2),n("span",{class:g(d.showPanel?"hidden":"")},[...e[5]||(e[5]=[n("i",{class:"las la-angle-up"},null,-1)])],2)])],2),d.showPanel?(i(),r("div",{key:0,class:g(["h-0 z-10",d.showPanel?"shadow":""]),style:{"margin-top":"-2px","margin-bottom":"2px"}},[n("div",Jr,[n("div",Xr,[P(n("input",{onKeypress:e[1]||(e[1]=Y(o=>l.selectAvailableOptionIfPossible(),["enter"])),"onUpdate:modelValue":e[2]||(e[2]=o=>d.search=o),class:"p-2 w-full bg-transparent text-fontcolor outline-hidden",placeholder:"Search"},null,544),[[R,d.search]])]),n("div",Zr,[(i(!0),r(p,null,E(l._filtredOptions,(o,h)=>(i(),r("div",{onClick:m=>l.addOption(o),key:h,class:g([o.selected?"selected":"","option p-2 flex justify-between cursor-pointer"])},[n("span",null,f(o.label),1),n("span",null,[o.checked?(i(),r("i",td)):c("",!0)])],10,ed))),128))]),l._options.length===0?(i(),r("div",sd,f(l.__("Nothing to display")),1)):c("",!0)])],2)):c("",!0)]),n("div",ld,[O(a,{field:s.field},null,8,["field"])])],2)}const id=C(qr,[["render",nd]]),rd={class:"w-[85.71vw] md:w-[57.14vw] lg:w-[42.86vw] flex flex-col shadow-lg bg-popup-surface"},dd={class:"flex flex-col"},od={class:"h-24 font-bold text-4xl text-fontcolor flex justify-center items-center"},ad=Se({__name:"ns-numpad-popup",props:["popup"],setup(t){let e=V("");const s=t,u=l=>{e.value=l},d=()=>{s.popup.params.resolve(e.value),s.popup.close()};return le(()=>{e.value=s.popup.params.value}),(l,a)=>{const o=y("ns-numpad-plus");return i(),r("div",rd,[n("div",dd,[n("div",od,f(ee(e)),1),O(o,{onChanged:a[0]||(a[0]=h=>u(h)),onNext:a[1]||(a[1]=h=>d()),value:ee(e)},null,8,["value"])])])}}}),ud={},cd={class:"my-4"},fd={class:"font-bold text-2xl"},hd={class:"text-fontcolor"};function md(t,e){return i(),r("div",cd,[n("h2",fd,[S(t.$slots,"title")]),n("span",hd,[S(t.$slots,"description")])])}const bd=C(ud,[["render",md]]),gd={name:"ns-search",props:["url","placeholder","value","label","method","searchArgument"],data(){return{searchText:"",searchTimeout:null,results:[]}},methods:{__:b,selectOption(t){this.$emit("select",t),this.searchText="",this.results=[]},renderLabel(t,e){return typeof e=="object"?e.map(s=>t[s]).join(" "):t[e]}},watch:{searchText(){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchText.length>0&&L[this.method||"post"](this.url,{[this.searchArgument||"search"]:this.searchText}).subscribe({next:t=>{this.results=t},error:t=>{w.error(t.message||b("An unexpected error occurred."))}})},1e3)}},mounted(){}},vd={class:"ns-search"},pd={class:"input-group info border-2"},yd=["placeholder"],_d={class:"relative"},xd={class:"w-full absolute shadow-lg"},kd={key:0,class:"ns-vertical-menu"},wd=["onClick"];function Cd(t,e,s,u,d,l){return i(),r("div",vd,[n("div",pd,[P(n("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>d.searchText=a),class:"p-2 w-full outline-hidden",placeholder:s.placeholder||l.__("Search..."),id:""},null,8,yd),[[R,d.searchText]])]),n("div",_d,[n("div",xd,[d.results.length>0&&d.searchText.length>0?(i(),r("ul",kd,[(i(!0),r(p,null,E(d.results,(a,o)=>(i(),r("li",{class:"border-b p-2 cursor-pointer",onClick:h=>l.selectOption(a),key:o},f(l.renderLabel(a,s.label)),9,wd))),128))])):c("",!0)])])])}const Dd=C(gd,[["render",Cd]]),Sd={data:()=>({searchField:"",showResults:!1,subscription:null}),name:"ns-search-select",emits:["saved","change"],props:["name","placeholder","field","leading"],computed:{selectedOptionLabel(){if(this.field.value===null||this.field.value===void 0)return b("Choose...");const t=this.field.options.filter(e=>e.value===this.field.value);return t.length>0?t[0].label:b("Choose...")},filtredOptions(){return this.searchField.length>0?this.field.options.filter(t=>new RegExp(this.searchField,"i").test(t.label)).splice(0,10):this.field.options},hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"ns-disabled cursor-not-allowed":""},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"}},watch:{showResults(){this.showResults===!0&&setTimeout(()=>{this.$refs.searchInputField.select()},50)}},mounted(){const t=this.field.options.filter(e=>e.value===this.field.value);t.length>0&&[null,void 0].includes(this.field.value)&&this.selectOption(t[0]),this.field.subject&&(this.subscription=this.field.subject.subscribe(({field:e,fields:s})=>{if(e&&s&&this.field.refresh&&e.name===this.field.refresh.watch){const u=this.field.refresh.url,d=this.field.refresh.data,l={identifier:e.value,...d};nsHttpClient.post(u,l).subscribe({next:a=>{this.field.options=a},error:a=>{console.error(a)}})}})),document.addEventListener("click",e=>{this.$el.contains(e.target)===!1&&(this.showResults=!1)})},destroyed(){this.subscription&&this.subscription.unsubscribe()},methods:{__:b,hasSelectedValues(t){return t.options.map(s=>s.value).includes(t.value)},resetSelectedInput(t){t.disabled||(t.value=null,this.$emit("change",null),this.showResults=!1,this.searchField="")},selectFirstOption(){this.filtredOptions.length>0&&this.selectOption(this.filtredOptions[0])},selectOption(t){this.field.value=t.value,this.$emit("change",t.value),this.searchField="",this.showResults=!1},async triggerDynamicComponent(t){try{this.showResults=!1;const e=nsExtraComponents[t.component]||nsComponents[t.component];e===void 0&&w.error(b(`The component ${t.component} cannot be loaded. Make sure it's injected on nsExtraComponents object.`));const s=await new Promise((u,d)=>{const l=I.show(e,{...t.props||{},field:this.field,resolve:u,reject:d})});this.$emit("saved",s)}catch{}},triggerFieldAbout(t){nsNotice.info(b("About this field"),t.about,{duration:5e3})}}},Td=["disabled"],Ed=["for"],Od={class:"text-fontcolor text-sm"},Md={key:0,class:"relative"},Fd={class:"w-full overflow-hidden -top-[5px] ns-select-results border rounded-b-md shadow z-10 absolute"},Ad={class:"border-b border-dashed p-2 filter-input-wrapper"},jd=["placeholder"],Pd={class:"h-60 overflow-y-auto"},Ld=["onClick"];function Rd(t,e,s,u,d,l){const a=y("ns-field-description");return s.field?(i(),r("div",{key:0,class:g(["flex flex-col flex-auto ns-select",l.hasError?"has-error":"is-pristine"]),disabled:s.field.disabled},[n("label",{for:s.field.name,class:"block leading-5 font-medium"},[S(t.$slots,"default")],8,Ed),n("div",{class:g([(s.field.disabled?"cursor-not-allowed":"cursor-default")+" "+(t.showResults?"rounded-t-md":"rounded-md"),"border mt-1 relative shadow-sm mb-1 flex overflow-hidden"])},[n("div",{onClick:e[0]||(e[0]=o=>!s.field.disabled&&(t.showResults=!t.showResults)),class:"placeholder flex-auto h-10 sm:leading-5 py-2 px-4 flex items-center"},[n("span",Od,f(l.selectedOptionLabel),1)]),l.hasSelectedValues(s.field)&&!s.field.disabled?(i(),r("button",{key:0,onClick:e[1]||(e[1]=o=>l.resetSelectedInput(s.field)),class:"flex items-center justify-center w-10 border-l hover:cursor-pointer hover:bg-error-tertiary hover:text-white border-input-edge"},[...e[6]||(e[6]=[n("i",{class:"las la-times"},null,-1)])])):c("",!0),s.field.component&&!s.field.disabled?(i(),r("button",{key:1,onClick:e[2]||(e[2]=o=>l.triggerDynamicComponent(s.field)),class:"flex items-center justify-center w-10 hover:cursor-pointer border-l"},[...e[7]||(e[7]=[n("i",{class:"las la-plus"},null,-1)])])):c("",!0),s.field.about?(i(),r("button",{key:2,onClick:e[3]||(e[3]=o=>l.triggerFieldAbout(s.field)),class:"flex items-center justify-center w-10 hover:cursor-pointer border-l"},[...e[8]||(e[8]=[n("i",{class:"las la-question-circle text-2xl text-font"},null,-1)])])):c("",!0)],2),t.showResults?(i(),r("div",Md,[n("div",Fd,[n("div",Ad,[P(n("input",{onKeypress:e[4]||(e[4]=Y(o=>l.selectFirstOption(),["enter"])),ref:"searchInputField","onUpdate:modelValue":e[5]||(e[5]=o=>t.searchField=o),type:"text",placeholder:l.__("Search result")},null,40,jd),[[R,t.searchField]])]),n("div",Pd,[n("ul",null,[(i(!0),r(p,null,E(l.filtredOptions,o=>(i(),r("li",{onClick:h=>l.selectOption(o),class:"py-1 px-2 hover:bg-info-primary cursor-pointer text-font"},f(o.label),9,Ld))),256))])])])])):c("",!0),O(a,{field:s.field},null,8,["field"])],10,Td)):c("",!0)}const $d=C(Sd,[["render",Rd]]),Hd={data:()=>({}),props:["name","placeholder","field","leading"],computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"ns-disabled cursor-not-allowed":""},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"},flattenedOptions(){return this.flattenOptions(this.field.options||[],0,[])}},mounted(){},methods:{__:b,flattenOptions(t,e=0,s=[]){const u=[];return t.forEach((d,l)=>{const a=l===t.length-1,o=Array.isArray(d.value);let h="";for(let v=0;v<e;v++)v===e-1?h+=a?"â””â”€ ":"â”œâ”€ ":h+=s[v]?"Â Â Â Â ":"â”‚Â Â ";const m=d.disabled!==void 0?d.disabled:o;if(o){u.push({label:h+d.label,value:d.value,disabled:m,level:e,isParent:!0});const v=[...s,a],k=this.flattenOptions(d.value,e+1,v);u.push(...k)}else u.push({label:h+d.label,value:d.value,disabled:m,level:e,isParent:!1})}),u}}},Id=["for"],Vd={class:"border mt-1 relative rounded-md shadow-sm mb-1 overflow-hidden"},Yd=["disabled","name"],zd={value:null},qd=["value","disabled"];function Bd(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(["flex flex-col flex-auto ns-select",l.hasError?"has-error":"is-pristine"])},[n("label",{for:s.field.name,class:"block leading-5 font-medium"},[S(t.$slots,"default")],8,Id),n("div",Vd,[P(n("select",{disabled:s.field.disabled?s.field.disabled:!1,name:s.field.name,"onUpdate:modelValue":e[0]||(e[0]=o=>s.field.value=o),class:g([l.inputClass,"form-input block w-full pl-7 pr-12 sm:text-sm sm:leading-5 h-10 appearance-none"])},[n("option",zd,f(l.__("Choose an option")),1),(i(!0),r(p,null,E(l.flattenedOptions,(o,h)=>(i(),r("option",{key:h,value:o.value,disabled:o.disabled,class:"py-2"},f(o.label),9,qd))),128))],10,Yd),[[J,s.field.value]])]),O(a,{field:s.field},null,8,["field"])],2)}const Nd=C(Hd,[["render",Bd]]),Ud={data:()=>({}),props:["name","placeholder","field","leading"],computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"bg-gray-200 cursor-not-allowed":"bg-transparent"},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"pl-8":"px-4"}},methods:{__:b,playSelectedSound(){this.field.value!==null&&this.field.value.length>0&&new Audio(this.field.value).play()}}},Wd={class:"flex flex-col flex-auto ns-select-audio"},Kd=["for"],Gd=["disabled","name"],Qd=["value"];function Jd(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",Wd,[n("label",{for:s.field.name,class:g([l.hasError?"has-error":"is-pristine","block leading-5 font-medium"])},[S(t.$slots,"default")],10,Kd),n("div",{class:g([l.hasError?"error":"","mt-1 flex relative mb-1 form-input"])},[n("button",{onClick:e[0]||(e[0]=o=>l.playSelectedSound()),class:"rounded-l border w-12 flex-auto flex items-center justify-center"},[...e[3]||(e[3]=[n("i",{class:"las la-play text-2xl"},null,-1)])]),P(n("select",{disabled:s.field.disabled?s.field.disabled:!1,onChange:e[1]||(e[1]=o=>t.$emit("change",o)),name:s.field.name,"onUpdate:modelValue":e[2]||(e[2]=o=>s.field.value=o),class:g([l.inputClass,"text-fontcolor block w-full pl-7 pr-12 sm:text-sm sm:leading-5 h-10 outline-hidden"])},[(i(!0),r(p,null,E(s.field.options,(o,h)=>(i(),r("option",{key:h,value:o.value,class:"py-2"},f(o.label),9,Qd))),128))],42,Gd),[[J,s.field.value]])],2),O(a,{field:s.field},null,8,["field"])])}const Xd=C(Ud,[["render",Jd]]),Zd={data:()=>({}),mounted(){},computed:{validatedSize(){return this.size||24},validatedBorder(){return this.border||8},validatedAnimation(){return this.animation||"fast"}},props:["color","size","border","animation"]},eo={class:"flex items-center justify-center"};function to(t,e,s,u,d,l){return i(),r("div",eo,[n("div",{class:g(["loader ease-linear rounded-full border-gray-200",l.validatedAnimation+" border-4 border-t-4 w-"+l.validatedSize+" h-"+l.validatedSize])},null,2)])}const so=C(Zd,[["render",to]]),lo={data:()=>({}),props:["href","label","active","to"],mounted(){},methods:{goTo(t,e){return this.$router.push(t),e.preventDefault(),!1}}},no={class:"submenu"},io=["href"],ro=["href"];function oo(t,e,s,u,d,l){return i(),r("div",null,[n("li",no,[s.href?(i(),r("a",{key:0,class:g([s.active?"font-bold active":"normal","py-2 border-l-4 px-4 block ns-aside-submenu"]),href:s.href},[S(t.$slots,"default")],10,io)):s.to?(i(),r("a",{key:1,class:g([s.active?"font-bold active":"normal","py-2 border-l-4 px-4 block ns-aside-submenu"]),onClick:e[0]||(e[0]=a=>l.goTo(s.to,a)),href:s.to},[S(t.$slots,"default")],10,ro)):c("",!0)])])}const ao=C(lo,[["render",oo]]),uo={props:["options","row","columns","prependOptions","showOptions","showCheckboxes"],data:()=>({optionsToggled:!1}),mounted(){},methods:{__:b,sanitizeHTML(t){var e=document.createElement("div");e.innerHTML=t;for(var s=e.getElementsByTagName("script"),u=s.length;u--;)s[u].parentNode.removeChild(s[u]);return e.innerHTML},getElementOffset(t){const e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset}},toggleMenu(t){if(this.row.$toggled=!this.row.$toggled,this.$emit("toggled",this.row),this.row.$toggled)setTimeout(()=>{const e=this.$el.querySelectorAll(".dropdown-holder > .ns-menu-wrapper")[0],s=this.$el.querySelectorAll(".dropdown-holder")[0],u=this.getElementOffset(s);e.style.top=u.top+"px",e.style.left=u.left+"px",e.classList.remove("hidden"),s!==void 0&&(s.classList.remove("off"),s.classList.add("on"))},100);else{const e=this.$el.querySelectorAll(".dropdown-holder")[0];e.classList.remove("on"),e.classList.add("off")}},handleChanged(t){this.row.$checked=t,this.$emit("updated",this.row)},triggerAsync(t){t.confirm!==null?Popup.show(z,{title:t.confirm.title||b("Confirm Your Action"),message:t.confirm.message||b("Would you like to delete this entry?"),onAction:e=>{e&&L[t.type.toLowerCase()](t.url).subscribe(s=>{w.success(s.message),this.$emit("reload",this.row)},s=>{this.toggleMenu(),w.error(s.message)})}}):(nsEvent.emit({identifier:"ns-table-row-action",value:{action:t,row:this.row,component:this}}),this.toggleMenu())},triggerPopup(t,e){const s=window.nsExtraComponents[t.component];if(t.component)return s?new Promise((u,d)=>{Popup.show(s,{resolve:u,reject:d,row:e,action:t})}):w.error(b(`Unable to load the component "${t.component}". Make sure the component is registered to "nsExtraComponents".`));this.triggerAsync(t)}}},co={key:0,class:"font-sans text-center align-middle p-1"},fo={key:1,class:"font-sans p-1"},ho={class:""},mo={class:"dropdown-holder"},bo={key:0,class:"zoom-in-entrance anim-duration-300 ns-menu-wrapper hidden z-50 origin-top-left mt-2"},go={class:"rounded-md"},vo={role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu"},po=["href","target","innerHTML"],yo=["onClick","innerHTML"],_o=["href","innerHTML"],xo=["innerHTML"],ko={class:"flex md:-mx-1 md:flex-wrap flex-col md:flex-row text-xs"},wo={class:"md:px-1 w-full md:w-1/2 lg:w-2/4"},Co=["innerHTML"],Do={key:2},So={key:2,class:"font-sans p-1 flex flex-col items-center justify-center"},To={class:""},Eo={class:"dropdown-holder"},Oo={key:0,class:"zoom-in-entrance anim-duration-300 z-50 origin-bottom-right mt-2 -ml-31 w-56 absolute rounded-md shadow-lg ns-menu-wrapper"},Mo={class:"rounded-md"},Fo={role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu"},Ao=["href","target","innerHTML"],jo=["onClick","innerHTML"];function Po(t,e,s,u,d,l){const a=y("ns-checkbox");return i(),r("tr",{class:g(["ns-table-row border text-sm",s.row.$cssClass?s.row.$cssClass:""])},[s.showCheckboxes?(i(),r("td",co,[O(a,{class:"inline-block",onChange:e[0]||(e[0]=o=>l.handleChanged(o)),checked:s.row.$checked},null,8,["checked"])])):c("",!0),s.prependOptions&&s.showOptions?(i(),r("td",fo,[n("div",ho,[n("button",{onClick:e[1]||(e[1]=o=>l.toggleMenu(o)),class:g([s.row.$toggled?"active":"","ns-inset-button outline-hidden rounded-full w-24 text-sm p-1 border"])},[e[5]||(e[5]=n("i",{class:"las la-ellipsis-h"},null,-1)),x(" "+f(l.__("Options")),1)],2),s.row.$toggled?(i(),r("div",{key:0,onClick:e[2]||(e[2]=o=>l.toggleMenu(o)),class:"absolute w-full h-full z-10 top-0 left-0"})):c("",!0),n("div",mo,[s.row.$toggled?(i(),r("div",bo,[n("div",go,[n("div",vo,[(i(!0),r(p,null,E(s.row.$actions,(o,h)=>(i(),r(p,{key:h},[["GOTO","TAB"].includes(o.type)?(i(),r("a",{key:0,href:o.url,target:o.type==="TAB"?"_blank":"_self",class:"ns-action-button block px-4 py-2 text-sm leading-5",role:"menuitem",innerHTML:l.sanitizeHTML(o.label)},null,8,po)):c("",!0),["GET","DELETE","POPUP"].includes(o.type)?(i(),r("a",{key:1,href:"javascript:void(0)",onClick:m=>l.triggerAsync(o),class:"ns-action-button block px-4 py-2 text-sm leading-5",role:"menuitem",innerHTML:l.sanitizeHTML(o.label)},null,8,yo)):c("",!0)],64))),128))])])])):c("",!0)])])])):c("",!0),(i(!0),r(p,null,E(s.columns,(o,h)=>(i(),r("td",{key:h,class:"font-sans p-1"},[s.row[h]&&s.row[h].type&&s.row[h].type==="link"?(i(),r("a",{key:0,target:"_blank",href:s.row[h].href,innerHTML:l.sanitizeHTML(s.row[h].label)},null,8,_o)):c("",!0),typeof s.row[h]=="string"||typeof s.row[h]=="number"?(i(),r(p,{key:1},[o.attributes&&o.attributes.length>0?(i(),r(p,{key:0},[n("h3",{class:"fond-bold text-lg",innerHTML:l.sanitizeHTML(s.row[h])},null,8,xo),n("div",ko,[(i(!0),r(p,null,E(o.attributes,m=>(i(),r("div",wo,[n("strong",null,f(m.label),1),x(": "+f(s.row[m.column]),1)]))),256))])],64)):(i(),r("div",{key:1,innerHTML:l.sanitizeHTML(s.row[h])},null,8,Co))],64)):c("",!0),s.row[h]===null?(i(),r("div",Do,f(l.__("Undefined")),1)):c("",!0)]))),128)),!s.prependOptions&&s.showOptions?(i(),r("td",So,[n("div",To,[n("button",{onClick:e[3]||(e[3]=o=>l.toggleMenu(o)),class:g([s.row.$toggled?"active":"","ns-inset-button outline-hidden rounded-full w-24 text-sm p-1 border"])},[e[6]||(e[6]=n("i",{class:"las la-ellipsis-h"},null,-1)),x(" "+f(l.__("Options")),1)],2),s.row.$toggled?(i(),r("div",{key:0,onClick:e[4]||(e[4]=o=>l.toggleMenu(o)),class:"absolute w-full h-full z-10 top-0 left-0"})):c("",!0),n("div",Eo,[s.row.$toggled?(i(),r("div",Oo,[n("div",Mo,[n("div",Fo,[(i(!0),r(p,null,E(s.row.$actions,(o,h)=>(i(),r(p,{key:h},[["GOTO","TAB"].includes(o.type)?(i(),r("a",{key:0,href:o.url,target:o.type==="TAB"?"_blank":"_self",class:"ns-action-button block px-4 py-2 text-sm leading-5",role:"menuitem",innerHTML:l.sanitizeHTML(o.label)},null,8,Ao)):c("",!0),["GET","DELETE","POPUP"].includes(o.type)?(i(),r("a",{key:1,href:"javascript:void(0)",onClick:m=>l.triggerAsync(o),class:"ns-action-button block px-4 py-2 text-sm leading-5",role:"menuitem",innerHTML:l.sanitizeHTML(o.label)},null,8,jo)):c("",!0)],64))),128))])])])):c("",!0)])])])):c("",!0)],2)}const Lo=C(uo,[["render",Po]]),Ro={data(){return{childrens:[],tabState:new Ee}},props:["active"],computed:{activeComponent(){const t=this.childrens.filter(e=>e.active);return t.length>0?t[0]:!1}},beforeUnmount(){this.tabState.unsubscribe()},watch:{active(t,e){this.childrens.forEach(s=>{s.active=s.identifier===t,s.active&&this.toggle(s)})}},mounted(){this.buildChildrens(this.active)},methods:{__:b,toggle(t){this.$emit("active",t.identifier),this.$emit("changeTab",t.identifier),this.tabState.next(t)},buildChildrens(t){this.childrens=Array.from(this.$el.querySelectorAll(".ns-tab-item")).map(s=>{const u=s.getAttribute("identifier")||void 0;let d=!0;return s.getAttribute("visible")&&(d=s.getAttribute("visible")==="true"),{el:s,active:!!(t&&t===u),identifier:u,closable:s.getAttribute("closable")==="true",initialized:!1,visible:d,label:s.getAttribute("label")||b("Unamed Tab")}}).filter(s=>s.visible),!(this.childrens.filter(s=>s.active).length>0)&&this.childrens.length>0&&(this.childrens[0].active=!0),this.childrens.forEach(s=>{s.active&&this.toggle(s)})}}},$o=["selected-tab"],Ho={class:"header ml-4 flex justify-between",style:{"margin-bottom":"-1px"}},Io={class:"flex flex-auto"},Vo=["onClick"],Yo=["onClick"];function zo(t,e,s,u,d,l){return i(),r("div",{class:"tabs flex flex-col flex-auto ns-tab overflow-hidden","selected-tab":l.activeComponent.identifier},[n("div",Ho,[n("div",Io,[(i(!0),r(p,null,E(d.childrens,(a,o)=>(i(),r("div",{key:a.identifier,onClick:h=>l.toggle(a),class:g([s.active===a.identifier?"border-b-0 active z-10":"inactive","tab rounded-tl rounded-tr border px-2 py-1 cursor-pointer flex items-center"]),style:{"margin-right":"-1px"}},[n("span",null,f(a.label),1),a.closable?(i(),r("div",{key:0,onClick:h=>t.$emit("close",a),class:"ns-inset-button border border-box-edge text-xs hover:border-error-tertiary error rounded-full h-5 w-5 flex items-center justify-center ml-1"},[...e[0]||(e[0]=[n("i",{class:"las la-times"},null,-1)])],8,Yo)):c("",!0)],10,Vo))),128))]),n("div",null,[S(t.$slots,"extra")])]),S(t.$slots,"default")],8,$o)}const qo=C(Ro,[["render",zo]]),Bo={data(){return{selectedTab:{},tabStateSubscriber:null}},computed:{},mounted(){this.tabStateSubscriber=this.$parent.tabState.subscribe(t=>{this.selectedTab=t})},unmounted(){this.tabStateSubscriber.unsubscribe()},props:["label","closable","identifier","padding"]},No=["closable","label","identifier"];function Uo(t,e,s,u,d,l){return i(),r("div",{class:g([d.selectedTab.identifier!==s.identifier?"hidden":"","ns-tab-item flex flex-auto overflow-hidden"]),closable:s.closable,label:s.label,identifier:s.identifier},[d.selectedTab.identifier===s.identifier?(i(),r("div",{key:0,class:g(["border rounded flex-auto overflow-y-auto",s.padding||"p-4"])},[S(t.$slots,"default")],2)):c("",!0)],10,No)}const Wo=C(Bo,[["render",Uo]]),Ko={data:()=>({}),mounted(){},computed:{hasError(){return this.field.errors!==void 0&&this.field.errors.length>0},disabledClass(){return this.field.disabled?"ns-disabled cursor-not-allowed":""},inputClass(){return this.disabledClass+" "+this.leadClass},leadClass(){return this.leading?"p-8":"p-2"}},props:["placeholder","leading","type","field"]},Go=["for"],Qo={class:"mt-1 relative border overflow-hidden rounded-md focus:shadow-sm mb-1"},Jo={key:0,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},Xo={class:"text-fontcolor-soft sm:text-sm sm:leading-5"},Zo=["rows","disabled","id","type","placeholder"];function ea(t,e,s,u,d,l){const a=y("ns-field-description");return i(),r("div",{class:g(["flex flex-col mb-2 flex-auto ns-textarea",l.hasError?"has-error":"is-pristine"])},[n("label",{for:s.field.name,class:"block leading-5 font-medium"},f(s.field.label),9,Go),n("div",Qo,[s.leading?(i(),r("div",Jo,[n("span",Xo,f(s.leading),1)])):c("",!0),P(n("textarea",{rows:s.field.data&&s.field.data.rows||10,disabled:s.field.disabled,"onUpdate:modelValue":e[0]||(e[0]=o=>s.field.value=o),onBlur:e[1]||(e[1]=o=>t.$emit("blur",this)),onChange:e[2]||(e[2]=o=>t.$emit("change",this)),id:s.field.name,type:s.type||s.field.type||"text",class:g([l.inputClass,"form-input block w-full sm:text-sm sm:leading-5"]),placeholder:s.placeholder},null,42,Zo),[[R,s.field.value]])]),O(a,{field:s.field},null,8,["field"])],2)}const ta=C(Ko,[["render",ea]]),sa={name:"ns-reorder-popup",components:{"ns-dropzone":de,"ns-draggable":oe},props:["popup"],data(){return{isDragging:!1,loading:!0,saving:!1,items:[],originalItems:[],currentCategory:null,breadcrumb:[],itemType:"category",hasChanges:!1}},mounted(){this.popupCloser(),this.loadItems(),document.addEventListener("mousemove",this.handleMouseMove)},beforeUnmount(){document.removeEventListener("mousemove",this.handleMouseMove)},methods:{__:b,popupCloser:G,popupResolver:K,handleMouseMove(t){if(!this.isDragging)return;document.querySelectorAll(".intermediate-dropzone").forEach(u=>{const d=u.getBoundingClientRect(),{left:l,top:a,right:o,bottom:h}=d,{clientX:m,clientY:v}=t;m>=l&&m<=o&&v>=a&&v<=h?(u.setAttribute("hovered","true"),u.classList.add("slide-fade-entrance")):(u.setAttribute("hovered","false"),u.classList.remove("slide-fade-entrance"))}),document.querySelectorAll(".ns-drop-zone").forEach(u=>{const d=u.getBoundingClientRect(),{left:l,top:a,right:o,bottom:h}=d,{clientX:m,clientY:v}=t;m>=l&&m<=o&&v>=a&&v<=h?u.setAttribute("hovered","true"):u.setAttribute("hovered","false")})},handleStartDragging(t){this.isDragging=!0},handleEndDragging(t,e){this.isDragging=!1;const s=document.querySelector('.intermediate-dropzone[hovered="true"]'),u=document.querySelector('.ns-drop-zone[hovered="true"]');if(s){const d=parseInt(s.getAttribute("data-index"));if(d!==e){this.items.splice(e,1);const l=d>e?d-1:d;this.items.splice(l,0,t),this.checkForChanges()}s.setAttribute("hovered","false"),s.classList.remove("slide-fade-entrance")}else if(u){const d=u.querySelector(".ns-draggable-item");if(d){const l=this.items.find(a=>d.querySelector(".font-semibold")?.textContent?.trim()===a.name);if(l&&l.id!==t.id){const a=this.items.indexOf(l);this.items[e]=l,this.items[a]=t,this.checkForChanges()}}u.setAttribute("hovered","false")}this.removeSpecialEffect()},checkForChanges(){const t=this.items.map(s=>s.id).join(","),e=this.originalItems.map(s=>s.id).join(",");this.hasChanges=t!==e},removeSpecialEffect(){document.querySelectorAll(".ns-draggable-item").forEach(e=>{e.removeAttribute("style")})},close(){this.popupResolver(!1)},loadItems(t=null){this.loading=!0,L.get(`/api/categories/${t||""}?parent=${t?"false":"true"}`).subscribe({next:e=>{if(t)L.get(`/api/categories/${t}`).subscribe({next:s=>{this.currentCategory=s,L.get("/api/categories?parent=false").subscribe({next:u=>{const d=u.filter(l=>l.parent_id===t);if(d.length>0)this.items=this.sortByPosition(d),this.itemType="category";else{this.loadProducts(t);return}this.originalItems=JSON.parse(JSON.stringify(this.items)),this.hasChanges=!1,this.loading=!1}})}});else{const s=Array.isArray(e)?e:[];this.items=this.sortByPosition(s.filter(u=>!u.parent_id||u.parent_id===0)),this.itemType="category",this.currentCategory=null,this.originalItems=JSON.parse(JSON.stringify(this.items)),this.hasChanges=!1,this.loading=!1}},error:e=>{this.loading=!1,w.error(e.message||b("Failed to load items"))}})},loadProducts(t){L.get(`/api/categories/${t}/products`).subscribe({next:e=>{this.items=this.sortByPosition(e),this.itemType="product",this.originalItems=JSON.parse(JSON.stringify(this.items)),this.hasChanges=!1,this.loading=!1},error:e=>{this.loading=!1,w.error(e.message||b("Failed to load products"))}})},sortByPosition(t){return t.sort((e,s)=>(e.position||0)-(s.position||0))},canNavigateInto(t){return!0},navigateInto(t){this.breadcrumb.push(t),this.loadItems(t.id)},navigateToCategory(t){const e=this.breadcrumb.findIndex(s=>s.id===t.id);this.breadcrumb=this.breadcrumb.slice(0,e+1),this.loadItems(t.id)},navigateToRoot(){this.breadcrumb=[],this.loadItems(null)},saveOrder(){this.saving=!0;const t=this.items.map((s,u)=>({id:s.id,position:u})),e=this.itemType==="category"?"/api/categories/reorder":"/api/products/reorder";L.post(e,{items:t}).subscribe({next:s=>{this.saving=!1,this.hasChanges=!1,this.originalItems=JSON.parse(JSON.stringify(this.items)),w.success(s.message||b("Order saved successfully"))},error:s=>{this.saving=!1,w.error(s.message||b("Failed to save order"))}})}}},la={class:"w-95vw h-95vh flex flex-col shadow-lg md:w-[80vw] md:h-[80vh] ns-box"},na={class:"header ns-box-header border-b border-box-edge flex justify-between p-2 items-center"},ia={class:"ns-box-body flex-auto overflow-hidden flex flex-col"},ra={class:"p-2 border-b border-box-edge"},da={class:"flex items-center space-x-2"},oa=["onClick"],aa={key:0,class:"h-full w-full flex justify-center items-center"},ua={key:1,class:"flex-auto overflow-y-auto p-4"},ca={key:0,class:"text-center py-8 text-secondary"},fa={key:1,class:"space-y-2"},ha=["data-index"],ma={class:"border border-box-edge rounded p-3 flex items-center space-x-3 bg-box-elevation hover:bg-box-elevation-hover shadow-sm"},ba={class:"flex-auto"},ga={class:"font-semibold"},va={key:0,class:"text-sm text-fontcolor-soft"},pa={key:1,class:"text-sm text-fontcolor-soft"},ya={class:"flex items-center space-x-2"},_a=["onClick","title"],xa={class:"ns-box-footer border-t flex justify-between p-2"},ka={key:1};function wa(t,e,s,u,d,l){const a=y("ns-close-button"),o=y("ns-spinner"),h=y("ns-draggable"),m=y("ns-dropzone"),v=y("ns-button");return i(),r("div",la,[n("div",na,[n("h3",null,f(l.__("Reorder Categories & Products")),1),n("div",null,[O(a,{onClick:e[0]||(e[0]=k=>l.close())})])]),n("div",ia,[n("div",ra,[n("div",da,[n("button",{onClick:e[1]||(e[1]=k=>l.navigateToRoot()),class:"px-3 py-1 rounded hover:bg-box-elevation-hover"},[e[4]||(e[4]=n("i",{class:"las la-home"},null,-1)),x(" "+f(l.__("Home")),1)]),(i(!0),r(p,null,E(d.breadcrumb,(k,M)=>(i(),r(p,{key:k.id},[e[5]||(e[5]=n("i",{class:"las la-angle-right"},null,-1)),n("button",{onClick:j=>l.navigateToCategory(k),class:"px-3 py-1 rounded hover:bg-box-elevation-hover"},f(k.name),9,oa)],64))),128))])]),d.loading?(i(),r("div",aa,[O(o)])):(i(),r("div",ua,[d.items.length===0?(i(),r("div",ca,f(l.__("No items to reorder.")),1)):(i(),r("div",fa,[(i(!0),r(p,null,E(d.items,(k,M)=>(i(),r(p,{key:k.id},[n("div",{"data-index":M,class:"intermediate-dropzone anim-duration-500"},[...e[6]||(e[6]=[n("div",null,null,-1)])],8,ha),O(m,null,{default:T(()=>[O(h,{widget:k,onDragStart:l.handleStartDragging,onDragEnd:j=>l.handleEndDragging(j,M)},{default:T(()=>[n("div",ma,[e[8]||(e[8]=n("div",{class:"widget-handle drag-handle cursor-move text-secondary hover:text-primary"},[n("i",{class:"las la-grip-vertical text-2xl"})],-1)),n("div",ba,[n("div",ga,f(k.name),1),d.itemType==="category"?(i(),r("div",va,f(k.total_items||0)+" "+f(l.__("items")),1)):(i(),r("div",pa,f(k.sku),1))]),n("div",ya,[d.itemType==="category"&&l.canNavigateInto(k)?(i(),r("button",{key:0,onClick:j=>l.navigateInto(k),class:"px-3 py-2 rounded border border-box-edge hover:bg-box-elevation-hover",title:l.__("View contents")},[...e[7]||(e[7]=[n("i",{class:"las la-arrow-right"},null,-1)])],8,_a)):c("",!0)])])]),_:2},1032,["widget","onDragStart","onDragEnd"])]),_:2},1024)],64))),128))]))]))]),n("div",xa,[n("div",null,[O(v,{onClick:e[2]||(e[2]=k=>l.close()),type:"default"},{default:T(()=>[x(f(l.__("Cancel")),1)]),_:1})]),n("div",null,[O(v,{onClick:e[3]||(e[3]=k=>l.saveOrder()),type:"info",disabled:!d.hasChanges||d.saving},{default:T(()=>[d.saving?(i(),F(o,{key:0,size:"4",border:"2"})):(i(),r("span",ka,f(l.__("Save Order")),1))]),_:1},8,["disabled"])])])])}const Ca=C(sa,[["render",wa],["__scopeId","data-v-978f1655"]]),Da={name:"nsReorderButton",methods:{__:b,openReorder(){I.show(Ca)}}};function Sa(t,e,s,u,d,l){return i(),r("button",{onClick:e[0]||(e[0]=a=>l.openReorder()),class:"flex justify-center items-center rounded-full text-sm h-10 px-3 ns-crud-button border outline-hidden"},[e[1]||(e[1]=n("i",{class:"las la-hand-pointer mr-1"},null,-1)),x(" "+f(l.__("Reorder")),1)])}const Ta=C(Da,[["render",Sa]]),$a=Object.freeze(Object.defineProperty({__proto__:null,nsAlertPopup:te,nsAvatar:xe,nsAvatarImage:ke,nsButton:Pe,nsCalendar:ie,nsCheckbox:Dt,nsCkeditor:me,nsCloseButton:Ot,nsConfirmPopup:z,nsCrud:Cs,nsCrudForm:Js,nsDate:il,nsDateTimePicker:re,nsDatepicker:Sl,nsDaterangePicker:Hl,nsDefaultAccounting:Yl,nsDragzone:tn,nsField:Dn,nsFieldDescription:Mn,nsIconButton:jn,nsInlineMultiselect:Gn,nsInput:ri,nsLink:ci,nsMediaInput:Mr,nsMenu:zr,nsMultiselect:id,nsNotice:be,nsNumpad:ge,nsNumpadPlus:ve,nsNumpadPopup:ad,nsPOSLoadingPopup:pe,nsPageTitle:bd,nsPaginate:ye,nsPromptPopup:_e,nsReorderButton:Ta,nsSearch:Dd,nsSearchSelect:$d,nsSelect:Nd,nsSelectAudio:Xd,nsSpinner:so,nsSubmenu:ao,nsSwitch:ae,nsTableRow:Lo,nsTabs:qo,nsTabsItem:Wo,nsTextarea:ta},Symbol.toStringTag,{value:"Module"}));export{Js as N,ad as _,zr as a,$a as b,Sl as c,Hl as d,re as e,ce as f,Dn as g,Pe as h,Ot as i,so as j,Ra as k,ao as n};
