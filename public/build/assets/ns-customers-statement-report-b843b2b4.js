import{_ as c,n as b}from"./currency-47ec5b79.js";import{_ as p}from"./_plugin-vue_export-helper-c27b6911.js";import{ae as m,a6 as l,z as a,A as e,c as i,y as h,F as x,ac as f}from"./npm~@vue~runtime-core_-ff0bdc0c.js";import{U as s}from"./npm~@vue~shared_-82b01912.js";import"./npm~numeral-faf61dd1.js";import"./npm~@ckeditor~ckeditor5-build-classic_-a8abd726.js";import"./npm~currency.js-57f74176.js";import"./npm~@vue~reactivity_-481192b6.js";const y={name:"ns-customers-statement-report",props:["store-logo","store-name","search-url"],data(){return{startDate:moment().startOf("day"),endDate:moment().endOf("day"),selectedCustomer:null,ns:window.ns,report:{total_purchases:0,total_orders:0,account_amount:0,owed_amount:0,credit_limit_amount:0,orders:[],wallet_transactions:[]}}},mounted(){},computed:{selectedCustomerName(){return this.selectedCustomer===null?c("N/A"):this.selectedCustomer.name}},methods:{__:c,nsCurrency:b,printSaleReport(){this.$htmlToPaper("report")},setStartDate(n){this.startDate=n},setEndDate(n){this.endDate=n},handleSelectedCustomer(n){this.selectedCustomer=n,nsHttpClient.post(`/api/reports/customers-statement/${n.id}`,{rangeStarts:this.startDate.format("YYYY-MM-DD HH:mm:ss"),rangeEnds:this.endDate.format("YYYY-MM-DD HH:mm:ss")}).subscribe({next:r=>{this.report=r},error:r=>{nsSnackBar.error(r.message||c("An unexpected error occured")).subscribe()}})}}},C={id:"report-section"},w={class:"flex -mx-2"},v={class:"px-2"},g={class:"px-2"},D={key:0,class:"px-2"},S={class:"ns-button"},k=e("i",{class:"las la-sync-alt text-xl"},null,-1),N={class:"pl-2"},Y={class:"px-2"},B={class:"ns-button"},H=e("i",{class:"las la-print text-xl"},null,-1),O={class:"pl-2"},A={id:"report",class:"anim-duration-500 fade-in-entrance"},E={class:"flex w-full"},L={class:"my-4 flex justify-between w-full"},M={class:"text-primary"},T={class:"pb-1 border-b border-dashed border-box-edge"},j={class:"pb-1 border-b border-dashed border-box-edge"},P={class:"pb-1 border-b border-dashed border-box-edge"},R={class:"pb-1 border-b border-dashed border-box-edge"},V=["src","alt"],F={class:"shadow rounded"},U={class:"ns-box"},z={class:"text-center ns-box-header p-2"},W={class:"font-bold"},q={class:"border-b ns-box-body"},G={class:"table ns-table w-full"},I={class:"text-primary"},J={class:""},K={width:"200",class:"font-semibold p-2 border text-left bg-success-secondary border-info-primary text-white print:text-black"},Q={class:"p-2 border text-right border-info-primary"},X={class:""},Z={width:"200",class:"font-semibold p-2 border text-left bg-warning-secondary border-info-primary text-white print:text-black"},$={class:"p-2 border text-right border-info-primary"},ee={class:""},te={width:"200",class:"font-semibold p-2 border text-left bg-info-secondary border-info-primary text-white print:text-black"},se={class:"p-2 border text-right border-info-primary"},re={class:""},oe={width:"200",class:"font-semibold p-2 border text-left border-info-primary"},de={class:"p-2 border text-right border-info-primary"},ne={class:""},le={width:"200",class:"font-semibold p-2 border text-left border-info-primary"},ae={class:"p-2 border text-right border-info-primary"},ce=e("br",null,null,-1),ie=e("br",null,null,-1),_e={key:0,class:"shadow rounded overflow-hidden"},me={class:"ns-box"},he={class:"text-center ns-box-header p-2"},ue={class:"font-bold"},be={class:"border-b ns-box-body"},pe={class:"table ns-table w-full"},xe={class:"p-2 border text-left"},fe={class:"p-2 border text-right"},ye={class:"text-primary"},Ce={width:"200",class:"font-semibold p-2 border text-left"},we={class:"p-2 border text-right"};function ve(n,r,ge,De,o,t){const _=m("ns-date-time-picker"),u=m("ns-search");return l(),a("div",C,[e("div",w,[e("div",v,[i(_,{date:o.startDate,onChange:r[0]||(r[0]=d=>t.setStartDate(d))},null,8,["date"])]),e("div",g,[i(_,{date:o.endDate,onChange:r[1]||(r[1]=d=>t.setEndDate(d))},null,8,["date"])]),o.selectedCustomer?(l(),a("div",D,[e("div",S,[e("button",{onClick:r[2]||(r[2]=d=>t.handleSelectedCustomer(o.selectedCustomer)),class:"rounded flex justify-between text-primary shadow py-1 items-center px-2"},[k,e("span",N,s(t.__("Load")),1)])])])):h("",!0),e("div",Y,[e("div",B,[e("button",{onClick:r[3]||(r[3]=d=>t.printSaleReport()),class:"rounded flex justify-between text-primary shadow py-1 items-center px-2"},[H,e("span",O,s(t.__("Print")),1)])])])]),e("div",null,[i(u,{placeholder:t.__("Search Customer..."),label:"name",value:"id",onSelect:r[4]||(r[4]=d=>t.handleSelectedCustomer(d)),url:n.searchUrl},null,8,["placeholder","url"])]),e("div",A,[e("div",E,[e("div",L,[e("div",M,[e("ul",null,[e("li",T,s(t.__("Date : {date}").replace("{date}",o.ns.date.current)),1),e("li",j,s(t.__("Document : Customer Statement")),1),e("li",P,s(t.__("Customer : {selectedCustomerName}").replace("{selectedCustomerName}",t.selectedCustomerName)),1),e("li",R,s(t.__("By : {user}").replace("{user}",o.ns.user.username)),1)])]),e("div",null,[e("img",{class:"w-24",src:n.storeLogo,alt:n.storeName},null,8,V)])])]),e("div",F,[e("div",U,[e("div",z,[e("h3",W,s(t.__("Summary")),1)]),e("div",q,[e("table",G,[e("tbody",I,[e("tr",J,[e("td",K,s(t.__("Total Purchases")),1),e("td",Q,s(t.nsCurrency(o.report.purchases_amount)),1)]),e("tr",X,[e("td",Z,s(t.__("Due Amount")),1),e("td",$,s(t.nsCurrency(o.report.owed_amount)),1)]),e("tr",ee,[e("td",te,s(t.__("Wallet Balance")),1),e("td",se,s(t.nsCurrency(o.report.account_amount)),1)]),e("tr",re,[e("td",oe,s(t.__("Credit Limit")),1),e("td",de,s(t.nsCurrency(o.report.credit_limit_amount)),1)]),e("tr",ne,[e("td",le,s(t.__("Total Orders")),1),e("td",ae,s(o.report.total_orders),1)])])])])])]),ce,ie,o.report.orders.length>0?(l(),a("div",_e,[e("div",me,[e("div",he,[e("h3",ue,s(t.__("Orders")),1)]),e("div",be,[e("table",pe,[e("thead",null,[e("tr",null,[e("th",xe,s(t.__("Order")),1),e("th",fe,s(t.__("Total")),1)])]),e("tbody",ye,[(l(!0),a(x,null,f(o.report.orders,d=>(l(),a("tr",{class:"",key:d.id},[e("td",Ce,s(d.code),1),e("td",we,s(t.nsCurrency(d.total)),1)]))),128))])])])])])):h("",!0)])])}const Ee=p(y,[["render",ve]]);export{Ee as default};
