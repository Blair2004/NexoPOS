import{a as y,P as f,e as D,p as Q,F as N,n as M,b as L}from"./bootstrap-0aabbab9.js";import{_ as c,n as O}from"./currency-47ec5b79.js";import{s as U}from"./pos-section-switch-0869c4e1.js";import{P as Y}from"./product-quantity-bc6a11af.js";import{n as H,a as G}from"./ns-pos-customer-select-popup-515e845b.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";import{ae as b,a6 as i,z as a,A as t,y as p,c as v,F as w,ac as k,x as P,ax as C,H as T,ag as q,az as z}from"./npm~@vue~runtime-core_-ff0bdc0c.js";import{U as n,z as V}from"./npm~@vue~shared_-82b01912.js";import F from"./ns-pos-confirm-popup-07a76865.js";import{n as A,a as W}from"./ns-numpad-plus-f3ffaa01.js";import K from"./ns-pos-loading-popup-f38cabd2.js";import{n as J}from"./ns-paginate-19e98260.js";import{n as R}from"./ns-pos-order-type-popup-8108b393.js";import{m as X,w as Z}from"./npm~@vue~runtime-dom_-a668b91e.js";import ee from"./ns-pos-shipping-popup-fc6689b1.js";import{r as j,m as $}from"./npm~@vue~reactivity_-481192b6.js";import"./npm~@dicebear~avatars_-e73ed2cc.js";import"./npm~@dicebear~avatars-avataaars-sprites_-e47afe24.js";import"./npm~moment-fbc5633a.js";import"./ns-switch-0a4d4345.js";import"./npm~vue2-daterange-picker-f17f6b76.js";import"./npm~vuedraggable-90a90e9d.js";import"./npm~vue-upload-component-9e5d4563.js";import"./npm~lodash-f7a36ac5.js";import{f as te}from"./npm~rxjs-a7e91008.js";import"./npm~laravel-echo-7ac8f47a.js";import"./npm~pusher-js-7b18aad5.js";import"./npm~@ckeditor~ckeditor5-build-classic_-a8abd726.js";import"./npm~axios-0ec1b34a.js";import"./npm~form-data-87061074.js";import"./npm~chart.js-3fed1729.js";import"./npm~vue-6a0d7c4c.js";import"./npm~@vue~compiler-dom_-04241bb4.js";import"./npm~@vue~compiler-core_-2a2ce8c7.js";import"./npm~rx-1641e2f8.js";import"./npm~@wordpress~hooks_-18172e20.js";import"./npm~tslib-f3101d7c.js";import"./npm~numeral-faf61dd1.js";import"./npm~currency.js-57f74176.js";import"./ns-orders-preview-popup-86a40fe6.js";import"./print-3c0412fa.js";import"./ns-prompt-popup-64b67141.js";import"./npm~pure-color-28f75675.js";import"./npm~svgson-a2b86d8a.js";import"./npm~omit-deep-3a616dcc.js";import"./npm~is-plain-object-01248184.js";import"./npm~isobject-2e03973b.js";import"./npm~isarray-980812a4.js";import"./npm~unset-value-cf896816.js";import"./npm~has-value-859045a0.js";import"./npm~has-values-79b61d1f.js";import"./npm~get-value-efae0488.js";import"./npm~deep-rename-keys-9802c842.js";import"./npm~kind-of-f578382b.js";import"./npm~is-buffer-793dba8c.js";import"./npm~rename-keys-8dab041c.js";import"./npm~xml-reader-1784d248.js";import"./npm~eventemitter3-c7e30f9c.js";import"./npm~xml-lexer-6516179a.js";import"./npm~@ckeditor~ckeditor5-vue_-b5744b68.js";import"./npm~sortablejs-9be29f79.js";let se=class{constructor(s){this.order=s}run(){return new Promise((s,d)=>this.order.products.length===0?(y.error(c("You need to provide some products before proceeding.")).subscribe(),d(!1)):s(!0))}};window.ProductsQueue=se;let re=class{constructor(s){this.order=s}run(){return new Promise((s,d)=>this.order.customer===void 0?f.show(H,{resolve:s,reject:d}):s(!0))}};window.CustomerQueue=re;const ne={name:"ns-pos-discount-popup",props:["popup"],data(){return{finalValue:1,virtualStock:null,popupSubscription:null,mode:"",type:"",allSelected:!0,isLoading:!1,keys:[...[7,8,9].map(e=>({identifier:e,value:e})),...[4,5,6].map(e=>({identifier:e,value:e})),...[1,2,3].map(e=>({identifier:e,value:e})),{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}]}},mounted(){this.mode=this.popup.params.reference.discount_type||"percentage",this.type=this.popup.params.type,this.mode==="percentage"?this.finalValue=this.popup.params.reference.discount_percentage||1:this.finalValue=this.popup.params.reference.discount||1},methods:{__:c,nsCurrency:O,setPercentageType(e){this.mode=e},closePopup(){this.popup.close()},inputValue(e){e.identifier==="next"?(this.popup.params.onSubmit({discount_type:this.mode,discount_percentage:this.mode==="percentage"?this.finalValue:void 0,discount:this.mode==="flat"?this.finalValue:void 0}),this.popup.close()):e.identifier==="backspace"?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue),this.mode==="percentage"&&(this.finalValue=this.finalValue>100?100:this.finalValue))}}},oe={id:"discount-popup",class:"ns-box shadow min-h-2/5-screen w-6/7-screen md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen relative"},ie={class:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},le={key:0,class:"text-xl font-bold text-primary text-center"},ae={key:1,class:"text-xl font-bold text-primary text-center"},de={id:"screen",class:"h-16 ns-box-body text-white flex items-center justify-center"},ue={class:"font-bold text-3xl"},ce={key:0},pe={key:1},_e={id:"switch-mode",class:"flex"},he=t("hr",{class:"border-r border-box-edge"},null,-1),me={id:"numpad",class:"grid grid-flow-row grid-cols-3 grid-rows-3"},be=["onClick"],fe={key:0};function ye(e,s,d,u,o,r){const l=b("ns-close-button");return i(),a("div",oe,[t("div",ie,[t("div",null,[o.type==="product"?(i(),a("h1",le,n(r.__("Product Discount")),1)):p("",!0),o.type==="cart"?(i(),a("h1",ae,n(r.__("Cart Discount")),1)):p("",!0)]),t("div",null,[v(l,{onClick:s[0]||(s[0]=_=>r.closePopup())})])]),t("div",de,[t("h1",ue,[o.mode==="flat"?(i(),a("span",ce,n(r.nsCurrency(o.finalValue)),1)):p("",!0),o.mode==="percentage"?(i(),a("span",pe,n(o.finalValue)+"%",1)):p("",!0)])]),t("div",_e,[t("button",{onClick:s[1]||(s[1]=_=>r.setPercentageType("flat")),class:V([o.mode==="flat"?"bg-tab-active":"bg-tab-inactive text-tertiary","outline-none w-1/2 py-2 flex items-center justify-center"])},n(r.__("Flat")),3),he,t("button",{onClick:s[2]||(s[2]=_=>r.setPercentageType("percentage")),class:V([o.mode==="percentage"?"bg-tab-active":"bg-tab-inactive text-tertiary","outline-none w-1/2 py-2 flex items-center justify-center"])},n(r.__("Percentage")),3)]),t("div",me,[(i(!0),a(w,null,k(o.keys,(_,h)=>(i(),a("div",{onClick:m=>r.inputValue(_),key:h,class:"text-primary ns-numpad-key info text-xl font-bold border h-24 flex items-center justify-center cursor-pointer"},[_.value!==void 0?(i(),a("span",fe,n(_.value),1)):p("",!0),_.icon?(i(),a("i",{key:1,class:V(["las",_.icon])},null,2)):p("",!0)],8,be))),128))])])}const I=x(ne,[["render",ye]]),ve={name:"sample-payment",props:["label","identifier"],data(){return{backValue:"0",number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map(e=>0).join("")),order:null,settings:{},settingsSubscription:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[...[7,8,9].map(e=>({identifier:e,value:e})),...[4,5,6].map(e=>({identifier:e,value:e})),...[1,2,3].map(e=>({identifier:e,value:e})),{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}]}},computed:{amountShortcuts(){return nsShortcuts.ns_pos_amount_shortcut!==null?nsShortcuts.ns_pos_amount_shortcut.split("|"):[]}},mounted(){this.orderSubscription=POS.order.subscribe(s=>{this.order=s}),this.settingsSubscription=POS.settings.subscribe(s=>{this.settings=s});const e=new Array(10).fill("").map((s,d)=>d);nsHotPress.create("numpad-keys").whenVisible([".is-popup"]).whenPressed(e,(s,d)=>{this.inputValue({value:d})}),nsHotPress.create("numpad-backspace").whenVisible([".is-popup"]).whenPressed("backspace",()=>this.inputValue({identifier:"backspace"})),nsHotPress.create("numpad-save").whenVisible([".is-popup"]).whenPressed("enter",()=>{this.backValue===""?(this.$emit("submit"),this.backValue=0):this.inputValue({identifier:"next"})})},beforeDestroy(){nsHotPress.destroy("numpad-keys"),nsHotPress.destroy("numpad-backspace"),nsHotPress.destroy("numpad-save")},unmounted(){this.orderSubscription.unsubscribe()},methods:{__:c,nsCurrency:O,toggleDiscount(){if(this.settings.cart_discount!==void 0&&this.settings.cart_discount===!0)f.show(I,{reference:this.order,type:"cart",onSubmit:e=>{POS.updateCart(this.order,e)}});else return y.error(c("You're not allowed to add a discount on the cart.")).subscribe()},makeFullPayment(){f.show(F,{title:c("Confirm Full Payment"),message:c("A full payment will be made using {paymentType} for {total}").replace("{paymentType}",this.label).replace("{total}",O(this.order.total)),onAction:e=>{if(e){const s=POS.order.getValue();s.tendered<s.total&&POS.addPayment({value:this.order.total-s.tendered,identifier:this.identifier,selected:!1,label:this.label,readonly:!1}),this.$emit("submit"),this.backValue="0"}}})},increaseBy(e){let s=parseInt(1+new Array(this.cursor).fill("").map(d=>0).join(""));this.backValue=(parseFloat(e.value)*s+(parseFloat(this.backValue)||0)).toString(),this.allSelected=!1},inputValue(e){e.identifier==="next"?(POS.addPayment({value:parseFloat(this.backValue/this.number),identifier:this.identifier,selected:!1,label:this.label,readonly:!1}),this.backValue="0"):e.identifier==="backspace"?this.allSelected?(this.backValue="0",this.allSelected=!1):this.backValue=this.backValue.substr(1):e.value.toString().match(/^\d+$/)&&(this.allSelected?(this.backValue=e.value.toString(),this.allSelected=!1):(this.backValue+=e.value.toString(),this.mode==="percentage"&&(this.backValue=this.backValue>100?100:this.backValue))),this.backValue==="0"&&(this.backValue="")}}},xe={class:"h-full w-full py-2"},we={key:0,class:"px-2 pb-2"},ge={class:"grid grid-cols-2 gap-2"},Pe={id:"details",class:"h-16 flex justify-between items-center border elevation-surface info text-xl md:text-3xl p-2"},ke={id:"paid",class:"h-16 flex justify-between items-center border elevation-surface success text-xl md:text-3xl p-2"},Ce={id:"change",class:"h-16 flex justify-between items-center border elevation-surface warning text-xl md:text-3xl p-2"},Se={id:"change",class:"col-span-2 h-16 flex justify-between items-center elevation-surface border text-xl md:text-3xl p-2"},Te={class:"px-2 pb-2"},Ve={class:"-mx-2 flex flex-wrap"},Oe={class:"pl-2 pr-1 flex-auto"},je={id:"numpad",class:"grid grid-flow-row grid-cols-3 gap-2 grid-rows-3",style:{padding:"1px"}},Fe=["onClick"],$e={key:0},De={class:"w-1/2 md:w-72 pr-2 pl-1"},Qe={class:"grid grid-flow-row grid-rows-1 gap-2"},Ne=["onClick"];function Be(e,s,d,u,o,r){return i(),a("div",xe,[o.order?(i(),a("div",we,[t("div",ge,[t("div",Pe,[t("span",null,n(r.__("Total"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.total)),1)]),t("div",{id:"discount",onClick:s[0]||(s[0]=l=>r.toggleDiscount()),class:"cursor-pointer h-16 flex justify-between items-center border elevation-surface error text-xl md:text-3xl p-2"},[t("span",null,n(r.__("Discount"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.discount)),1)]),t("div",ke,[t("span",null,n(r.__("Paid"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.tendered)),1)]),t("div",Ce,[t("span",null,n(r.__("Change"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.change)),1)]),t("div",Se,[t("span",null,n(r.__("Screen"))+" : ",1),t("span",null,n(r.nsCurrency(o.backValue/o.number)),1)])])])):p("",!0),t("div",Te,[t("div",Ve,[t("div",Oe,[t("div",je,[(i(!0),a(w,null,k(o.keys,(l,_)=>(i(),a("div",{onClick:h=>r.inputValue(l),key:_,style:{margin:"-1px"},class:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer"},[l.value!==void 0?(i(),a("span",$e,n(l.value),1)):p("",!0),l.icon?(i(),a("i",{key:1,class:V(["las",l.icon])},null,2)):p("",!0)],8,Fe))),128)),t("div",{onClick:s[1]||(s[1]=l=>r.makeFullPayment()),class:"hover:bg-green-500 col-span-3 bg-success-secondary border-success-tertiary text-2xl text-white border h-16 flex items-center justify-center cursor-pointer"},n(r.__("Full Payment")),1)])]),t("div",De,[t("div",Qe,[(i(!0),a(w,null,k(r.amountShortcuts,(l,_)=>(i(),a("div",{key:_,onClick:h=>r.increaseBy({value:l}),class:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer"},[t("span",null,n(r.nsCurrency(l)),1)],8,Ne))),128))])])])])])}const B=x(ve,[["render",Be]]),He={name:"cash-payment",props:["identifier","label"],components:{samplePayment:B}};function qe(e,s,d,u,o,r){const l=b("sample-payment");return i(),P(l,{identifier:d.identifier,label:d.label},null,8,["identifier","label"])}const Ae=x(He,[["render",qe]]),Re={name:"creditcart-payment",props:["identifier"]};function Ie(e,s,d,u,o,r){return i(),a("h1",null,"Credit Card")}const Ee=x(Re,[["render",Ie]]),Me={name:"bank-payment",props:["identifier","label"],components:{samplePayment:B}};function Le(e,s,d,u,o,r){const l=b("sample-payment");return i(),P(l,{identifier:d.identifier,label:d.label},null,8,["identifier","label"])}const Ue=x(Me,[["render",Le]]),Ye={name:"ns-account-payment",components:{nsNumpad:A},props:["identifier","label"],data(){return{subscription:null,screenValue:0,order:null}},methods:{__:c,nsCurrency:O,handleChange(e){this.screenValue=e},proceedAddingPayment(e){const s=parseFloat(e),d=this.order.payments;if(s<=0)return y.error(c("Please provide a valid payment amount.")).subscribe();if(d.filter(u=>u.identifier==="account-payment").length>0)return y.error(c("The customer account can only be used once per order. Consider deleting the previously used payment.")).subscribe();if(s>this.order.customer.account_amount)return y.error(c("Not enough funds to add {amount} as a payment. Available balance {balance}.").replace("{amount}",this.$options.filters.currency(s)).replace("{balance}",this.$options.filters.currency(this.order.customer.account_amount))).subscribe();POS.addPayment({value:s,identifier:"account-payment",selected:!1,label:this.label,readonly:!1}),this.order.customer.account_amount-=s,POS.selectCustomer(this.order.customer),this.$emit("submit")},proceedFullPayment(){this.proceedAddingPayment(this.order.total)},makeFullPayment(){Popup.show(F,{title:c("Confirm Full Payment"),message:c("You're about to use {amount} from the customer account to make a payment. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(this.order.total)),onAction:e=>{e&&this.proceedFullPayment()}})}},mounted(){this.subscription=POS.order.subscribe(e=>this.order=e)},unmounted(){this.subscription.unsubscribe()}},Ge={class:"h-full w-full py-2"},ze={key:0,class:"px-2 pb-2"},We={class:"grid grid-cols-2 gap-2"},Ke={id:"details",class:"h-16 flex justify-between items-center elevation-surface border info text-xl md:text-3xl p-2"},Je={id:"paid",class:"h-16 flex justify-between items-center elevation-surface success border text-xl md:text-3xl p-2"},Xe={id:"change",class:"h-16 flex justify-between items-center elevation-surface warning border text-xl md:text-3xl p-2"},Ze={id:"change",class:"col-span-2 h-16 flex justify-between items-center elevation-surface border success text-xl md:text-3xl p-2"},et={id:"change",class:"col-span-2 h-16 flex justify-between items-center elevation-surface border text-primary text-xl md:text-3xl p-2"},tt={class:"px-2 pb-2"},st={class:"-mx-2 flex flex-wrap"},rt={class:"pl-2 pr-1 flex-auto"},nt={class:"w-1/2 md:w-72 pr-2 pl-1"},ot={class:"grid grid-flow-row grid-rows-1 gap-2"};function it(e,s,d,u,o,r){const l=b("ns-numpad");return i(),a("div",Ge,[o.order?(i(),a("div",ze,[t("div",We,[t("div",Ke,[t("span",null,n(r.__("Total"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.total)),1)]),t("div",{id:"discount",onClick:s[0]||(s[0]=_=>e.toggleDiscount()),class:"cursor-pointer h-16 flex justify-between items-center elevation-surface error border text-xl md:text-3xl p-2"},[t("span",null,n(r.__("Discount"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.discount)),1)]),t("div",Je,[t("span",null,n(r.__("Paid"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.tendered)),1)]),t("div",Xe,[t("span",null,n(r.__("Change"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.change)),1)]),t("div",Ze,[t("span",null,n(r.__("Current Balance"))+" : ",1),t("span",null,n(r.nsCurrency(o.order.customer.account_amount)),1)]),t("div",et,[t("span",null,n(r.__("Screen"))+" : ",1),t("span",null,n(r.nsCurrency(o.screenValue)),1)])])])):p("",!0),t("div",tt,[t("div",st,[t("div",rt,[v(l,{floating:!0,onChanged:s[2]||(s[2]=_=>r.handleChange(_)),onNext:s[3]||(s[3]=_=>r.proceedAddingPayment(_))},{"numpad-footer":C(()=>[t("div",{onClick:s[1]||(s[1]=_=>r.makeFullPayment()),class:"hover:bg-success-tertiary col-span-3 bg-success-secondary text-2xl text-white border border-success-secondary h-16 flex items-center justify-center cursor-pointer"},n(r.__("Full Payment")),1)]),_:1})]),t("div",nt,[t("div",ot,[t("div",{onClick:s[4]||(s[4]=_=>e.increaseBy({value:100})),class:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer"},[t("span",null,n(r.nsCurrency(100)),1)]),t("div",{onClick:s[5]||(s[5]=_=>e.increaseBy({value:500})),class:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer"},[t("span",null,n(r.nsCurrency(500)),1)]),t("div",{onClick:s[6]||(s[6]=_=>e.increaseBy({value:1e3})),class:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer"},[t("span",null,n(r.nsCurrency(1e3)),1)])])])])])])}const lt=x(Ye,[["render",it]]),at={name:"ns-pos-payment",props:["popup"],data(){return{paymentTypesSubscription:null,paymentsType:[],order:null,showPayment:!1,orderSubscription:null,currentPaymentComponent:null,activePaymentSubscription:null}},computed:{expectedPayment(){const e=this.order.customer.group.minimal_credit_payment;return this.order.total*e/100}},mounted(){this.order=this.popup.params.order,this.activePaymentSubscription=POS.selectedPaymentType.subscribe(e=>{this.activePayment=e,e!==null&&this.loadPaymentComponent(e)}),this.paymentTypesSubscription=POS.paymentsType.subscribe(e=>{this.paymentsType=e,e.filter(s=>{s.selected&&POS.selectedPaymentType.next(s)})}),nsHooks.doAction("ns-pos-payment-mounted",this)},unmounted(){this.activePaymentSubscription.unsubscribe(),this.paymentTypesSubscription.unsubscribe(),nsHooks.doAction("ns-pos-payment-destroyed",this)},methods:{__:c,nsCurrency:O,resolveIfQueued:D,loadPaymentComponent(e){switch(e.identifier){case"cash-payment":this.currentPaymentComponent=shallowRef(Ae);break;case"creditcard-payment":this.currentPaymentComponent=shallowRef(Ee);break;case"bank-payment":this.currentPaymentComponent=shallowRef(Ue);break;case"account-payment":this.currentPaymentComponent=shallowRef(lt);break;default:this.currentPaymentComponent=shallowRef(B);break}},async selectPayment(){try{const e=await new Promise((s,d)=>{f.show(J,{label:c("Select Payment Gateway"),options:this.paymentsType.map(u=>({label:u.label,value:u.identifier})),value:this.activePayment.identifier,resolve:s,reject:d})});this.select(this.paymentsType.filter(s=>s.identifier===e[0].value)[0])}catch{}},select(e){this.showPayment=!1,POS.setPaymentActive(e)},closePopup(){this.popup.close(),POS.selectedPaymentType.next(null)},deletePayment(e){POS.removePayment(e)},selectPaymentAsActive(e){this.select(this.paymentsType.filter(s=>s.identifier===e.target.value)[0])},submitOrder(e={}){const s=f.show(K);try{const d={...POS.order.getValue(),...e};POS.submitOrder(d).then(u=>{s.close(),y.success(u.message).subscribe(),POS.printOrderReceipt(u.data.order,"silent"),this.popup.close()},u=>{s.close(),y.error(u.message).subscribe()})}catch{s.close(),y.error(error.message).subscribe()}}}},dt={key:0,id:"ns-payment-popup",class:"w-screen h-screen p-4 flex overflow-hidden"},ut={class:"flex flex-col flex-auto lg:flex-row shadow-xl"},ct={class:"w-full lg:w-56 lg:h-full flex justify-between px-2 lg:px-0 lg:block items-center lg:items-start"},pt={class:"lg:hidden text-xl text-center my-4 font-bold lg:my-8"},_t=t("div",{class:"h-16 hidden lg:block"},null,-1),ht={class:"hidden lg:block"},mt=["onClick"],bt={class:"px-2 rounded-full h-8 w-8 flex items-center justify-center ns-label"},ft={class:"overflow-hidden flex flex-col flex-auto"},yt={class:"flex flex-col flex-auto overflow-hidden"},vt={class:"h-12 hidden items-center justify-between lg:flex"},xt={class:"text-xl hidden lg:block text-center my-4 font-bold lg:my-8"},wt={class:"hidden-md"},gt={class:"px-2"},Pt={key:0,class:"flex flex-auto ns-payment-wrapper overflow-y-auto"},kt={key:1,class:"flex flex-auto ns-payment-wrapper overflow-y-auto p-2 flex-col"},Ct={class:"text-center font-bold py-2"},St={class:"flex-auto"},Tt={key:0,class:"p-2 flex justify-center mb-2 items-center"},Vt={class:"font-semibold"},Ot={class:"flex items-center"},jt=["onClick"],Ft=t("i",{class:"las la-trash-alt"},null,-1),$t=[Ft],Dt={class:"flex lg:hidden ns-payment-buttons"},Qt={class:"text-sm"},Nt={class:"text-sm"},Bt={class:"text-sm"},Ht={class:"text-sm mr-1"},qt={class:"px-2 rounded-full h-6 w-6 text-xs flex items-center justify-center ns-label"},At={class:"flex-col sm:flex-row w-full ns-payment-footer justify-end p-2 hidden lg:flex"},Rt={class:"flex justify-end"},It=t("i",{class:"las la-cash-register"},null,-1),Et=t("i",{class:"las la-bookmark"},null,-1);function Mt(e,s,d,u,o,r){const l=b("ns-close-button"),_=b("ns-button");return o.order?(i(),a("div",dt,[t("div",ut,[t("div",ct,[t("h3",pt,[T(n(r.__("Gateway"))+" ",1),t("span",null,": "+n(e.activePayment.label),1)]),_t,t("ul",ht,[(i(!0),a(w,null,k(o.paymentsType,h=>(i(),a("li",{onClick:m=>r.select(h),class:V([h.selected&&!o.showPayment?"ns-visible":"","cursor-pointer ns-payment-gateway py-2 px-3"]),key:h.identifier},n(h.label),11,mt))),128)),t("li",{onClick:s[0]||(s[0]=h=>o.showPayment=!0),class:V([o.showPayment?"ns-visible":"","cursor-pointer py-2 px-3 ns-payment-list border-t mt-4 flex items-center justify-between"])},[t("span",null,n(r.__("Payment List")),1),t("span",bt,n(o.order.payments.length),1)],2)]),v(l,{class:"lg:hidden",onClick:s[1]||(s[1]=h=>r.closePopup())})]),t("div",ft,[t("div",yt,[t("div",vt,[t("div",null,[t("h3",xt,[T(n(r.__("Gateway"))+" ",1),t("span",wt,": "+n(e.activePayment.label),1)])]),t("div",gt,[v(l,{onClick:s[2]||(s[2]=h=>r.closePopup())})])]),o.showPayment?p("",!0):(i(),a("div",Pt,[(i(),P(q(o.currentPaymentComponent),{onSubmit:s[3]||(s[3]=h=>r.submitOrder()),label:e.activePayment.label,identifier:e.activePayment.identifier},null,40,["label","identifier"]))])),o.showPayment?(i(),a("div",kt,[t("h3",Ct,n(r.__("List Of Payments")),1),t("ul",St,[o.order.payments.length===0?(i(),a("li",Tt,[t("h3",Vt,n(r.__("No Payment added.")),1)])):p("",!0),(i(!0),a(w,null,k(o.order.payments,(h,m)=>(i(),a("li",{key:m,class:"p-2 flex justify-between mb-2 items-center"},[t("span",null,n(h.label),1),t("div",Ot,[t("span",null,n(r.nsCurrency(h.value)),1),t("button",{onClick:g=>r.deletePayment(h),class:"rounded-full h-8 w-8 flex items-center justify-center ml-2"},$t,8,jt)])]))),128))])])):p("",!0)]),t("div",Dt,[t("button",{onClick:s[4]||(s[4]=h=>r.selectPayment()),class:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 font-bold ns-payment-type-button"},[t("span",Qt,n(r.__("Payment Type")),1)]),o.order.tendered>=o.order.total?(i(),a("button",{key:0,onClick:s[5]||(s[5]=h=>r.submitOrder()),class:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-submit-button font-bold"},[t("span",Nt,n(r.__("Submit Payment")),1)])):p("",!0),o.order.tendered<o.order.total?(i(),a("button",{key:1,onClick:s[6]||(s[6]=h=>r.submitOrder({payment_status:"unpaid"})),class:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-layaway-button font-bold"},[t("span",Bt,n(r.__("Layaway")),1)])):p("",!0),t("button",{onClick:s[7]||(s[7]=h=>o.showPayment=!0),class:"w-1/3 flex ns-payment-button text-2xl flex-auto h-12 items-center justify-center font-bold"},[t("span",Ht,n(r.__("Payment List")),1),t("span",qt,n(o.order.payments.length),1)])]),t("div",At,[t("div",Rt,[o.order.tendered>=o.order.total?(i(),P(_,{key:0,onClick:s[8]||(s[8]=h=>r.submitOrder()),type:o.order.tendered>=o.order.total?"success":"info"},{default:C(()=>[t("span",null,[It,T(" "+n(r.__("Submit Payment")),1)])]),_:1},8,["type"])):p("",!0),o.order.tendered<o.order.total?(i(),P(_,{key:1,onClick:s[9]||(s[9]=h=>r.submitOrder({payment_status:"unpaid"})),type:o.order.tendered>=o.order.total?"success":"info"},{default:C(()=>[t("span",null,[Et,T(" "+n(r.__("Layaway"))+" — "+n(r.nsCurrency(r.expectedPayment)),1)])]),_:1},8,["type"])):p("",!0)])])])])])):p("",!0)}const Lt=x(at,[["render",Mt]]);let Ut=class{constructor(s){this.order=s}run(){return new Promise((s,d)=>{f.show(Lt,{resolve:s,reject:d,order:this.order})})}};window.PaymentQueue=Ut;let Yt=class{constructor(s){this.order=s}run(){return new Promise((s,d)=>{if(this.order.type===void 0)return f.show(R,{resolve:s,reject:d});s(!0)})}};window.TypeQueue=Yt;const Gt={props:["order"],methods:{__,async payOrder(){const e=nsHooks.applyFilters("ns-pay-queue",[ProductsQueue,CustomerQueue,TypeQueue,PaymentQueue]);for(let s in e)try{const u=await new e[s](this.order).run()}catch{return!1}}},mounted(){for(let e in nsShortcuts)["ns_pos_keyboard_payment"].includes(e)&&nsHotPress.create("ns_pos_keyboard_payment").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],s=>{s.preventDefault(),this.payOrder()})},unmounted(){nsHotPress.destroy("ns_pos_keyboard_payment")}},zt=t("i",{class:"mr-2 text-2xl lg:text-xl las la-cash-register"},null,-1),Wt={class:"text-lg hidden md:inline lg:text-2xl"};function Kt(e,s,d,u,o,r){return i(),a("div",{onClick:s[0]||(s[0]=l=>r.payOrder()),id:"pay-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-green-500 text-white hover:bg-green-600 border-r border-green-600 flex-auto"},[zt,t("span",Wt,n(r.__("Pay")),1)])}const Jt=x(Gt,[["render",Kt]]),Xt={name:"ns-pos-hold-orders",props:["popup"],data(){return{order:{},title:"",show:!0}},mounted(){this.popupCloser(),this.show=POS.getHoldPopupEnabled(),this.show||this.popup.params.resolve({title:this.title}),this.$refs.reference.focus(),this.$refs.reference.select(),this.order=this.popup.params.order,this.title=this.popup.params.order.title||""},methods:{__:c,nsCurrency:O,popupCloser:Q,submitHold(){this.popup.close(),this.popup.params.resolve({title:this.title})}}},Zt={class:"ns-box shadow-lg w-6/7-screen md:w-3/7-screen lg:w-2/6-screen"},es={class:"p-2 flex ns-box-header justify-between border-b items-center"},ts={class:"font-semibold"},ss={class:"flex-auto ns-box-body"},rs={class:"border-b h-16 flex items-center justify-center"},os={class:"text-5xl text-primary"},is={class:"p-2"},ls={class:"input-group border-2 info"},as=["placeholder"],ds={class:"p-2"},us={class:"text-secondary"},cs={class:"flex ns-box-footer"};function ps(e,s,d,u,o,r){const l=b("ns-close-button");return i(),a("div",Zt,[t("div",es,[t("h3",ts,n(r.__("Hold Order")),1),t("div",null,[v(l,{onClick:s[0]||(s[0]=_=>d.popup.close())})])]),t("div",ss,[t("div",rs,[t("span",os,n(r.nsCurrency(e.total)),1)]),t("div",is,[t("div",ls,[z(t("input",{onKeyup:s[1]||(s[1]=Z(_=>r.submitHold(),["enter"])),"onUpdate:modelValue":s[2]||(s[2]=_=>o.title=_),ref:"reference",type:"text",placeholder:r.__("Order Reference"),class:"outline-none rounded border-2 p-2 w-full"},null,40,as),[[X,o.title]])])]),t("div",ds,[t("p",us,n(r.__("The current order will be set on hold. You can retrieve this order from the pending order button. Providing a reference to it might help you to identify the order more quickly.")),1)])]),t("div",cs,[t("div",{onClick:s[3]||(s[3]=_=>r.submitHold()),class:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-green-500 text-white font-semibold"},n(r.__("Confirm")),1),t("div",{onClick:s[4]||(s[4]=_=>d.popup.close()),class:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-error-secondary text-white font-semibold"},n(r.__("Cancel")),1)])])}const _s=x(Xt,[["render",ps]]),hs={props:["order"],methods:{__,async holdOrder(){if(this.order.payment_status!=="hold"&&this.order.payments.length>0)return nsSnackBar.error(__("Unable to hold an order which payment status has been updated already.")).subscribe();const e=nsHooks.applyFilters("ns-hold-queue",[ProductsQueue,CustomerQueue,TypeQueue]);for(let d in e)try{const o=await new e[d](this.order).run()}catch{return!1}nsHooks.applyFilters("ns-override-hold-popup",()=>{new Promise((u,o)=>{Popup.show(_s,{resolve:u,reject:o,order:this.order})}).then(u=>{this.order.title=u.title,this.order.payment_status="hold",POS.order.next(this.order);const o=Popup.show(nsPosLoadingPopupVue);POS.submitOrder().then(r=>{o.close(),nsSnackBar.success(r.message).subscribe()},r=>{o.close(),nsSnackBar.error(r.message).subscribe()})})})()}},mounted(){for(let e in nsShortcuts)["ns_pos_keyboard_hold_order"].includes(e)&&nsHotPress.create("ns_pos_keyboard_hold_order").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],s=>{s.preventDefault(),this.holdOrder()})},unmounted(){nsHotPress.destroy("ns_pos_keyboard_hold_order")}},ms=t("i",{class:"mr-2 text-2xl lg:text-xl las la-pause"},null,-1),bs={class:"text-lg hidden md:inline lg:text-2xl"};function fs(e,s,d,u,o,r){return i(),a("div",{onClick:s[0]||(s[0]=l=>r.holdOrder()),id:"hold-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-blue-500 text-white border-r hover:bg-blue-600 border-blue-600 flex-auto"},[ms,t("span",bs,n(r.__("Hold")),1)])}const ys=x(hs,[["render",fs]]),vs={props:["order","settings"],methods:{__,openDiscountPopup(e,s,d=null){if(!this.settings.products_discount&&s==="product")return nsSnackBar.error(__("You're not allowed to add a discount on the product.")).subscribe();if(!this.settings.cart_discount&&s==="cart")return nsSnackBar.error(__("You're not allowed to add a discount on the cart.")).subscribe();Popup.show(I,{reference:e,type:s,onSubmit(u){s==="product"?POS.updateProduct(e,u,d):s==="cart"&&POS.updateCart(e,u)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"})}}},xs=t("i",{class:"mr-2 text-2xl lg:text-xl las la-percent"},null,-1),ws={class:"text-lg hidden md:inline lg:text-2xl"};function gs(e,s,d,u,o,r){return i(),a("div",{onClick:s[0]||(s[0]=l=>r.openDiscountPopup(d.order,"cart")),id:"discount-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center border-r border-box-edge flex-auto"},[xs,t("span",ws,n(r.__("Discount")),1)])}const Ps=x(vs,[["render",gs]]),ks={props:["order","settings"],methods:{__,voidOngoingOrder(){POS.voidOrder(this.order)}}},Cs=t("i",{class:"mr-2 text-2xl lg:text-xl las la-trash"},null,-1),Ss={class:"text-lg hidden md:inline lg:text-2xl"};function Ts(e,s,d,u,o,r){return i(),a("div",{onClick:s[0]||(s[0]=l=>r.voidOngoingOrder(d.order)),id:"void-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-red-500 text-white border-box-edge hover:bg-red-600 flex-auto"},[Cs,t("span",Ss,n(r.__("Void")),1)])}const Vs=x(ks,[["render",Ts]]),Os={name:"ns-pos-note-popup",props:["popup"],data(){return{validation:new N,fields:[{label:c("Note"),name:"note",value:"",description:c("More details about this order"),type:"textarea"},{label:c("Display On Receipt"),name:"note_visibility",value:"",options:[{label:c("Yes"),value:"visible"},{label:c("No"),value:"hidden"}],description:c("Will display the note on the receipt"),type:"switch"}]}},mounted(){this.popupCloser(),this.fields.forEach(e=>{e.name==="note"?e.value=this.popup.params.note:e.name==="note_visibility"&&(e.value=this.popup.params.note_visibility)})},methods:{__:c,popupResolver:D,popupCloser:Q,closePopup(){this.popupResolver(!1)},saveNote(){if(!this.validation.validateFields(this.fields)){const e=this.validation.validateFieldsErrors(this.fields);return this.validation.triggerFieldsErrors(this.fields,e),this.$forceUpdate(),y.error(c("Unable to proceed the form is not valid.")).subscribe()}return this.popupResolver(this.validation.extractFields(this.fields))}}},js={class:"shadow-lg ns-box w-95vw md:w-3/5-screen lg:w-2/5-screen"},Fs={class:"p-2 flex justify-between items-center border-b ns-box-header"},$s={class:"font-bold"},Ds={class:"p-2"},Qs={class:"p-2 flex justify-end border-t ns-box-footer"};function Ns(e,s,d,u,o,r){const l=b("ns-close-button"),_=b("ns-field"),h=b("ns-button");return i(),a("div",js,[t("div",Fs,[t("h3",$s,n(r.__("Order Note")),1),t("div",null,[v(l,{onClick:s[0]||(s[0]=m=>r.closePopup())})])]),t("div",Ds,[(i(!0),a(w,null,k(o.fields,(m,g)=>(i(),P(_,{key:g,field:m},null,8,["field"]))),128))]),t("div",Qs,[v(h,{type:"info",onClick:s[1]||(s[1]=m=>r.saveNote())},{default:C(()=>[T(n(r.__("Save")),1)]),_:1})])])}const Bs=x(Os,[["render",Ns]]),Hs={name:"ns-pos-tax-popup",props:["popup"],data(){return{validation:new N,tax_group:[],order:null,orderSubscriber:null,optionsSubscriber:null,options:{},tax_groups:[],activeTab:"",group_fields:[{label:c("Select Tax"),name:"tax_group_id",description:c("Define the tax that apply to the sale."),type:"select",disabled:!0,value:"",validation:"required",options:[]},{label:c("Type"),name:"tax_type",disabled:!0,value:"",description:c("Define how the tax is computed"),type:"select",validation:"required",options:[{label:c("Exclusive"),value:"exclusive"},{label:c("Inclusive"),value:"inclusive"}]}]}},mounted(){this.loadGroups(),this.popupCloser(),this.activeTab=this.popup.params.activeTab||"settings",this.group_fields.forEach(e=>{e.value=this.popup.params[e.name]||void 0}),this.orderSubscriber=POS.order.subscribe(e=>{this.order=e}),this.optionsSubscriber=POS.options.subscribe(e=>{this.options=e,["variable_vat","products_variable_vat"].includes(this.options.ns_pos_vat)&&this.group_fields.forEach(s=>s.disabled=!1)})},unmounted(){this.orderSubscriber.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{__:c,nsCurrency:O,popupCloser:Q,popupResolver:D,changeActive(e){this.activeTab=e},closePopup(){this.popupResolver(!1)},saveTax(){if(!this.validation.validateFields(this.group_fields))return y.error(c("Unable to proceed the form is not valid.")).subscribe();const e=this.validation.extractFields(this.group_fields);this.popupResolver(e)},loadGroups(){M.get("/api/taxes/groups").subscribe(e=>{this.groups=e,this.group_fields.forEach(s=>{s.name==="tax_group_id"&&(s.options=this.groups.map(d=>({label:d.name,value:d.id})))})})}}},qs={class:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},As={class:"p-2 flex justify-between items-center border-b ns-box-header"},Rs={class:"text-blog"},Is={class:"p-2 ns-box-body"},Es={class:"p-2 border-b ns-box-body"},Ms={class:"flex justify-end p-2"},Ls={key:0,class:"p-2"},Us={key:0,class:"p-2 text-center text-primary"},Ys={key:0,class:"p-2"},Gs={class:"border shadow p-2 w-full flex justify-between items-center elevation-surface"};function zs(e,s,d,u,o,r){const l=b("ns-close-button"),_=b("ns-field"),h=b("ns-button"),m=b("ns-tabs-item"),g=b("ns-tabs");return i(),a("div",qs,[t("div",As,[t("h3",Rs,n(r.__("Tax & Summary")),1),t("div",null,[v(l,{onClick:s[0]||(s[0]=S=>r.closePopup())})])]),t("div",Is,[v(g,{active:o.activeTab,onChangeTab:s[2]||(s[2]=S=>r.changeActive(S))},{default:C(()=>[v(m,{padding:"0",label:r.__("Settings"),identifier:"settings",active:!0},{default:C(()=>[t("div",Es,[(i(!0),a(w,null,k(o.group_fields,(S,E)=>(i(),P(_,{field:S,key:E},null,8,["field"]))),128))]),t("div",Ms,[v(h,{onClick:s[1]||(s[1]=S=>r.saveTax()),type:"info"},{default:C(()=>[T(n(r.__("Save")),1)]),_:1})])]),_:1},8,["label"]),v(m,{padding:"0",label:r.__("Summary"),identifier:"summary",active:!1},{default:C(()=>[o.order?(i(),a("div",Ls,[(i(!0),a(w,null,k(o.order.taxes,S=>(i(),a("div",{key:S.id,class:"mb-2 border shadow p-2 w-full flex justify-between items-center elevation-surface"},[t("span",null,n(S.tax_name),1),t("span",null,n(r.nsCurrency(e.value)),1)]))),128)),o.order.taxes.length===0?(i(),a("div",Us,n(r.__("No tax is active")),1)):p("",!0)])):p("",!0)]),_:1},8,["label"]),v(m,{padding:"0",label:r.__("Product Taxes"),identifier:"product_taxes",active:!1},{default:C(()=>[o.order?(i(),a("div",Ys,[t("div",Gs,[t("span",null,n(r.__("Product Taxes")),1),t("span",null,n(r.nsCurrency(o.order.products_tax_value)),1)])])):p("",!0)]),_:1},8,["label"])]),_:1},8,["active"])])])}const Ws=x(Hs,[["render",zs]]),Ks={name:"ns-pos-order-settings",props:["popup"],mounted(){nsHttpClient.get("/api/fields/ns.pos-order-settings").subscribe(e=>{e.forEach(s=>{s.value=thsi.popup.params.order[s.name]||""}),this.fields=this.validation.createFields(e)},e=>{}),this.popupCloser()},data(){return{fields:[],validation:new N}},methods:{__,popupCloser,popupResolver,closePopup(){this.popupResolver(!1)},saveSettings(){const e=this.validation.extractFields(this.fields);this.popupResolver(e)}}},Js={class:"shadow-lg flex flex-col ns-box w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen lg:w-2/5-screen"},Xs={class:"p-2 border-b ns-box-header items-center flex justify-between"},Zs={class:"text-semibold"},er={class:"p-2 flex-auto border-b ns-box-body overflow-y-auto"},tr={class:"p-2 flex justify-end ns-box-footer"};function sr(e,s,d,u,o,r){const l=b("ns-close-button"),_=b("ns-field"),h=b("ns-button");return i(),a("div",Js,[t("div",Xs,[t("h3",Zs,n(r.__("Order Settings")),1),t("div",null,[v(l,{onClick:s[0]||(s[0]=m=>r.closePopup())})])]),t("div",er,[(i(!0),a(w,null,k(o.fields,(m,g)=>(i(),P(_,{field:m,key:g},null,8,["field"]))),128))]),t("div",tr,[v(h,{onClick:s[1]||(s[1]=m=>r.saveSettings()),type:"info"},{default:C(()=>[T(n(r.__("Save")),1)]),_:1})])])}const rr=x(Ks,[["render",sr]]),nr={name:"ns-pos-product-price-product",props:["popup"],components:{nsNumpad:A,nsNumpadPlus:W},computed:{},data(){return{product:{},optionsSubscription:null,options:{},price:0}},mounted(){this.popupCloser(),this.product=this.popup.params.product,this.optionsSubscription=POS.options.subscribe(e=>{this.options=j(e)})},beforeDestroy(){this.optionsSubscription.unsubscribe()},methods:{popupResolver,popupCloser,nsCurrency:O,__,updateProductPrice(e){this.product.unit_price=e},resolveProductPrice(e){this.popupResolver(this.product.unit_price)}}},or={class:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},ir={class:"popup-heading ns-box-header"},lr={class:"flex flex-col ns-box-body"},ar={class:"h-16 flex items-center justify-center elevation-surface info font-bold"},dr={class:"text-2xl"};function ur(e,s,d,u,o,r){const l=b("ns-close-button"),_=b("ns-numpad"),h=b("ns-numpad-plus");return i(),a("div",or,[t("div",ir,[t("h3",null,n(r.__("Product Price")),1),t("div",null,[v(l,{onClick:s[0]||(s[0]=m=>r.popupResolver(!1))})])]),t("div",lr,[t("div",ar,[t("h2",dr,n(r.nsCurrency(o.product.unit_price)),1)]),o.options.ns_pos_numpad==="default"?(i(),P(_,{key:0,floating:o.options.ns_pos_allow_decimal_quantities,onChanged:s[1]||(s[1]=m=>r.updateProductPrice(m)),onNext:s[2]||(s[2]=m=>r.resolveProductPrice(m)),value:o.product.unit_price},null,8,["floating","value"])):p("",!0),o.options.ns_pos_numpad==="advanced"?(i(),P(h,{key:1,onChanged:s[3]||(s[3]=m=>r.updateProductPrice(m)),onNext:s[4]||(s[4]=m=>r.resolveProductPrice(m)),value:o.product.unit_price},null,8,["value"])):p("",!0)])])}const cr=x(nr,[["render",ur]]),pr={name:"ns-pos-quick-product-popup",methods:{__:c,popupCloser:Q,popupResolver:D,close(){this.popupResolver(!1)},async addProduct(){const e=this.validation.extractFields(this.fields),s=this.fields.filter(r=>typeof r.show>"u"||typeof r.show=="function"&&r.show(e));if(!this.validation.validateFields(s))return y.error(c("Unable to proceed. The form is not valid.")).subscribe();let u=this.validation.extractFields(s);u.$original=()=>({stock_management:"disabled",category_id:0,tax_group:this.tax_groups.filter(r=>parseInt(r.id)===parseInt(u.tax_group_id))[0],tax_group_id:u.tax_group_id,tax_type:u.tax_type}),u.product_type==="product"?(u.unit_name=this.units.filter(r=>r.id===u.unit_id)[0].name,u.quantity=parseFloat(u.quantity),u.unit_price=parseFloat(u.unit_price),u.mode="custom",u.price_with_tax=u.unit_price,u.price_without_tax=u.unit_price,u.tax_value=0):(u.unit_name=c("N/A"),u.unit_price=0,u.quantity=1);const o=await POS.defineQuantities(u,this.units);u.$quantities=()=>o,u=POS.computeProductTax(u),POS.addToCart(u),this.close()},loadData(){this.loaded=!1,te(nsHttpClient.get("/api/units"),nsHttpClient.get("/api/taxes/groups")).subscribe({next:e=>{this.units=e[0],this.tax_groups=e[1],this.fields.filter(s=>{s.name==="tax_group_id"&&(s.options=e[1].map(d=>({label:d.name,value:d.id}))),s.name==="unit_id"&&(s.options=e[0].map(d=>({label:d.name,value:d.id})))}),this.buildForm()},error:e=>{}})},buildForm(){this.fields=this.validation.createFields(this.fields),this.loaded=!0}},computed:{form(){return this.validation.extractFields(this.fields)}},data(){return{units:[],tax_groups:[],loaded:!1,validation:new N,fields:[{label:c("Name"),name:"name",type:"text",description:c("Provide a unique name for the product."),validation:"required"},{label:c("Product Type"),name:"product_type",type:"select",description:c("Define the product type."),options:[{label:c("Normal"),value:"product"},{label:c("Dynamic"),value:"dynamic"}],value:"product",validation:"required"},{label:c("Rate"),name:"rate",type:"text",description:c("In case the product is computed based on a percentage, define the rate here."),validation:"required",show(e){return e.product_type==="dynamic"}},{label:c("Unit Price"),name:"unit_price",type:"text",description:c("Define what is the sale price of the item."),validation:"",show(e){return e.product_type==="product"}},{label:c("Quantity"),name:"quantity",type:"text",value:1,description:c("Set the quantity of the product."),validation:"",show(e){return e.product_type==="product"}},{label:c("Unit"),name:"unit_id",type:"select",options:[],description:c("Assign a unit to the product."),validation:"",show(e){return e.product_type==="product"}},{label:c("Tax Type"),name:"tax_type",type:"select",options:[{label:c("Disabled"),value:""},{label:c("Inclusive"),value:"inclusive"},{label:c("Exclusive"),value:"exclusive"}],description:c("Define what is tax type of the item."),show(e){return e.product_type==="product"}},{label:c("Tax Group"),name:"tax_group_id",type:"select",options:[],description:c("Choose the tax group that should apply to the item."),show(e){return e.product_type==="product"}}]}},mounted(){this.popupCloser(),this.loadData()}},_r={class:"w-95vw flex flex-col h-95vh shadow-lg md:w-3/5-screen lg:w-2/5-screen md:h-3/5-screen ns-box"},hr={class:"header ns-box-header border-b flex justify-between p-2 items-center"},mr={class:"ns-box-body p-2 flex-auto overflow-y-auto"},br={key:0,class:"h-full w-full flex justify-center items-center"},fr={class:"ns-box-footer border-t flex justify-between p-2"},yr=t("div",null,null,-1);function vr(e,s,d,u,o,r){const l=b("ns-close-button"),_=b("ns-spinner"),h=b("ns-field"),m=b("ns-button");return i(),a("div",_r,[t("div",hr,[t("h3",null,n(r.__("Product / Service")),1),t("div",null,[v(l,{onClick:s[0]||(s[0]=g=>r.close())})])]),t("div",mr,[o.loaded?p("",!0):(i(),a("div",br,[v(_)])),o.loaded?(i(!0),a(w,{key:1},k(o.fields,(g,S)=>(i(),a(w,null,[g.show&&g.show(r.form)||!g.show?(i(),P(h,{key:S,field:g},null,8,["field"])):p("",!0)],64))),256)):p("",!0)]),t("div",fr,[yr,t("div",null,[v(m,{onClick:s[1]||(s[1]=g=>r.addProduct()),type:"info"},{default:C(()=>[T(n(r.__("Create")),1)]),_:1})])])])}const xr=x(pr,[["render",vr]]),wr={name:"ns-pos-cart",data:()=>({popup:null,cartButtons:{},products:[],defaultCartButtons:{nsPosPayButton:$(Jt),nsPosHoldButton:$(ys),nsPosDiscountButton:$(Ps),nsPosVoidButton:$(Vs)},visibleSection:null,visibleSectionSubscriber:null,cartButtonsSubscriber:null,optionsSubscriber:null,options:{},typeSubscribe:null,orderSubscribe:null,productSubscribe:null,settingsSubscribe:null,settings:{},types:[],order:j({})}),computed:{selectedType(){return this.order.type?this.order.type.label:"N/A"},isVisible(){return this.visibleSection==="cart"},customerName(){return this.order.customer?this.order.customer.first_name:"N/A"},couponName(){return c("Apply Coupon")}},mounted(){this.cartButtonsSubscriber=POS.cartButtons.subscribe(e=>{this.cartButtons=e}),this.optionsSubscriber=POS.options.subscribe(e=>{this.options=e}),this.typeSubscribe=POS.types.subscribe(e=>this.types=e),this.orderSubscribe=POS.order.subscribe(e=>{this.order=j(e)}),this.productSubscribe=POS.products.subscribe(e=>{this.products=j(e)}),this.settingsSubscribe=POS.settings.subscribe(e=>{this.settings=j(e)}),this.visibleSectionSubscriber=POS.visibleSection.subscribe(e=>{this.visibleSection=j(e)}),L.addAction("ns-after-cart-reset","ns-pos-cart-buttons",()=>{POS.cartButtons.next(this.defaultCartButtons)});for(let e in nsShortcuts)["ns_pos_keyboard_shipping"].includes(e)&&nsHotPress.create("ns_pos_keyboard_shipping").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],s=>{s.preventDefault(),this.openShippingPopup()}),["ns_pos_keyboard_note"].includes(e)&&nsHotPress.create("ns_pos_keyboard_note").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],s=>{s.preventDefault(),this.openNotePopup()})},unmounted(){this.visibleSectionSubscriber.unsubscribe(),this.typeSubscribe.unsubscribe(),this.orderSubscribe.unsubscribe(),this.productSubscribe.unsubscribe(),this.settingsSubscribe.unsubscribe(),this.optionsSubscriber.unsubscribe(),this.cartButtonsSubscriber.unsubscribe(),nsHotPress.destroy("ns_pos_keyboard_shipping"),nsHotPress.destroy("ns_pos_keyboard_note")},methods:{__:c,nsCurrency:O,switchTo:U,openAddQuickProduct(){new Promise((s,d)=>{f.show(xr,{resolve:s,reject:d})}).then(s=>{}).catch(s=>{})},summarizeCoupons(){const e=this.order.coupons.map(s=>s.value);return e.length>0?e.reduce((s,d)=>s+d):0},async changeProductPrice(e){if(!this.settings.edit_purchase_price)return y.error(c("You don't have the right to edit the purchase price.")).subscribe();if(e.product_type==="dynamic")return y.error(c("Dynamic product can't have their price updated.")).subscribe();if(this.settings.unit_price_editable)try{const s=await new Promise((u,o)=>f.show(cr,{product:Object.assign({},e),resolve:u,reject:o})),d={...e.$quantities(),custom_price_edit:s};return e.$quantities=()=>d,e.mode="custom",e=POS.computeProductTax(e),POS.recomputeProducts(POS.products.getValue()),POS.refreshCart(),y.success(c("The product price has been updated.")).subscribe()}catch(s){if(s!==!1)throw y.error(s).subscribe(),s}else return y.error(c("The editable price feature is disabled.")).subscribe()},async selectCoupon(){try{const e=await new Promise((s,d)=>{f.show(G,{resolve:s,reject:d})})}catch{}},async defineOrderSettings(){if(!this.settings.edit_settings)return y.error(c("You're not allowed to edit the order settings.")).subscribe();try{const e=await new Promise((s,d)=>{f.show(rr,{resolve:s,reject:d,order:this.order})});POS.order.next({...this.order,...e})}catch{}},async openNotePopup(){try{const e=await new Promise((d,u)=>{const o=this.order.note,r=this.order.note_visibility;f.show(Bs,{resolve:d,reject:u,note:o,note_visibility:r})}),s={...this.order,...e};POS.order.next(s)}catch(e){e!==!1&&y.error(e.message).subscribe()}},async selectTaxGroup(e="settings"){try{const s=await new Promise((u,o)=>{const r=this.order.taxes,l=this.order.tax_group_id,_=this.order.tax_type;f.show(Ws,{resolve:u,reject:o,taxes:r,tax_group_id:l,tax_type:_,activeTab:e})}),d={...this.order,...s};POS.order.next(d),POS.refreshCart()}catch(s){console.log(s)}},openTaxSummary(){this.selectTaxGroup("summary")},selectCustomer(){f.show(H)},toggleMode(e,s){if(!this.options.ns_pos_allow_wholesale_price)return y.error(c("Unable to change the price mode. This feature has been disabled.")).subscribe();e.mode==="normal"?f.show(F,{title:c("Enable WholeSale Price"),message:c("Would you like to switch to wholesale price ?"),onAction(d){d&&POS.updateProduct(e,{mode:"wholesale"},s)}}):f.show(F,{title:c("Enable Normal Price"),message:c("Would you like to switch to normal price ?"),onAction(d){d&&POS.updateProduct(e,{mode:"normal"},s)}})},remove(e){f.show(F,{title:c("Confirm Your Action"),message:c("Would you like to delete this product ?"),onAction(s){s&&POS.removeProduct(e)}})},allowQuantityModification(e){return e.product_type==="product"},changeQuantity(e,s){this.allowQuantityModification(e)&&new Y(e).run({unit_quantity_id:e.unit_quantity_id,unit_name:e.unit_name,$quantities:e.$quantities}).then(u=>{POS.updateProduct(e,u,s)})},openOrderType(){f.show(R)},openShippingPopup(){f.show(ee)}}},gr={id:"pos-cart",class:"flex-auto flex flex-col"},Pr={key:0,id:"tools",class:"flex pl-2 ns-tab"},kr={key:0,class:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},Cr={class:"rounded shadow ns-tab-item flex-auto flex overflow-hidden"},Sr={class:"cart-table flex flex-auto flex-col overflow-hidden"},Tr={id:"cart-toolbox",class:"w-full p-2 border-b"},Vr={class:"border rounded overflow-hidden"},Or={class:"flex flex-wrap"},jr={class:"ns-button"},Fr=t("i",{class:"las la-comment"},null,-1),$r={class:"ml-1 hidden md:inline-block"},Dr=t("hr",{class:"h-10",style:{width:"1px"}},null,-1),Qr={class:"ns-button"},Nr=t("i",{class:"las la-balance-scale-left"},null,-1),Br={class:"ml-1 hidden md:inline-block"},Hr={key:0,class:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},qr=t("hr",{class:"h-10",style:{width:"1px"}},null,-1),Ar={class:"ns-button"},Rr=t("i",{class:"las la-tags"},null,-1),Ir={class:"ml-1 hidden md:inline-block"},Er={key:0,class:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},Mr=t("hr",{class:"h-10",style:{width:"1px"}},null,-1),Lr={class:"ns-button"},Ur=t("i",{class:"las la-tools"},null,-1),Yr={class:"ml-1 hidden md:inline-block"},Gr=t("hr",{class:"h-10",style:{width:"1px"}},null,-1),zr={key:0,class:"ns-button"},Wr=t("i",{class:"las la-plus"},null,-1),Kr={class:"ml-1 hidden md:inline-block"},Jr=t("hr",{class:"h-10",style:{width:"1px"}},null,-1),Xr={id:"cart-table-header",class:"w-full text-primary font-semibold flex"},Zr={class:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0"},en={class:"hidden lg:flex lg:w-1/6 p-2 border-b border-t-0"},tn={class:"hidden lg:flex lg:w-1/6 p-2 border border-r-0 border-t-0"},sn={id:"cart-products-table",class:"flex flex-auto flex-col overflow-auto"},rn={key:0,class:"text-primary flex"},nn={class:"w-full text-center py-4 border-b"},on=["product-index"],ln={class:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0"},an={class:"flex justify-between product-details mb-1"},dn={class:"font-semibold"},un={class:"-mx-1 flex product-options"},cn={class:"px-1"},pn=["onClick"],_n=t("i",{class:"las la-trash text-xl"},null,-1),hn=[_n],mn={key:0,class:"px-1"},bn=["onClick"],fn=t("i",{class:"las la-award text-xl"},null,-1),yn=[fn],vn={class:"flex justify-between product-controls"},xn={class:"-mx-1 flex flex-wrap"},wn={class:"px-1 w-1/2 md:w-auto mb-1"},gn=["onClick"],Pn={class:"px-1 w-1/2 md:w-auto mb-1"},kn=["onClick"],Cn={key:0},Sn={class:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},Tn=["onClick"],Vn={class:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},On={class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},jn=["onClick"],Fn={key:0,class:"border-b border-dashed border-info-primary p-2"},$n={class:"hidden lg:flex w-1/6 p-2 border border-r-0 border-t-0 items-center justify-center"},Dn={id:"cart-products-summary",class:"flex"},Qn={key:0,class:"table ns-table w-full text-sm"},Nn={width:"200",class:"border p-2"},Bn={width:"200",class:"border p-2"},Hn={width:"200",class:"border p-2 text-right"},qn={key:0},An=t("td",{width:"200",class:"border p-2"},null,-1),Rn={width:"200",class:"border p-2"},In={width:"200",class:"border p-2 text-right"},En={width:"200",class:"border p-2"},Mn={width:"200",class:"border p-2"},Ln={key:0},Un={key:1},Yn={width:"200",class:"border p-2 text-right"},Gn={key:1},zn=t("td",{width:"200",class:"border p-2"},null,-1),Wn={width:"200",class:"border p-2"},Kn={width:"200",class:"border p-2 text-right"},Jn={class:"success"},Xn={width:"200",class:"border p-2"},Zn={width:"200",class:"border p-2"},eo={width:"200",class:"border p-2 text-right"},to={key:1,class:"table ns-table w-full text-sm"},so={width:"200",class:"border p-2"},ro={width:"200",class:"border p-2"},no={class:"flex justify-between"},oo={key:0},io=t("td",{width:"200",class:"border p-2"},null,-1),lo={width:"200",class:"border p-2"},ao={width:"200",class:"border p-2 text-right"},uo={width:"200",class:"border p-2"},co={width:"200",class:"border p-2"},po={class:"flex justify-between items-center"},_o={key:0},ho={key:1},mo={key:1},bo=t("td",{width:"200",class:"border p-2"},null,-1),fo={width:"200",class:"border p-2"},yo=t("span",null,null,-1),vo={class:"success"},xo={width:"200",class:"border p-2"},wo={width:"200",class:"border p-2"},go={class:"flex justify-between w-full"},Po={class:"h-16 flex flex-shrink-0 border-t border-box-edge",id:"cart-bottom-buttons"};function ko(e,s,d,u,o,r){return i(),a("div",gr,[e.visibleSection==="cart"?(i(),a("div",Pr,[t("div",{onClick:s[0]||(s[0]=l=>r.switchTo("cart")),class:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 font-semibold active tab"},[t("span",null,n(r.__("Cart")),1),e.order?(i(),a("span",kr,n(e.order.products.length),1)):p("",!0)]),t("div",{onClick:s[1]||(s[1]=l=>r.switchTo("grid")),class:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 border-t border-r border-l inactive tab"},n(r.__("Products")),1)])):p("",!0),t("div",Cr,[t("div",Sr,[t("div",Tr,[t("div",Vr,[t("div",Or,[t("div",jr,[t("button",{onClick:s[2]||(s[2]=l=>r.openNotePopup()),class:"w-full h-10 px-3 outline-none"},[Fr,t("span",$r,n(r.__("Comments")),1)])]),Dr,t("div",Qr,[t("button",{onClick:s[3]||(s[3]=l=>r.selectTaxGroup()),class:"w-full h-10 px-3 outline-none flex items-center"},[Nr,t("span",Br,n(r.__("Taxes")),1),e.order.taxes&&e.order.taxes.length>0?(i(),a("span",Hr,n(e.order.taxes.length),1)):p("",!0)])]),qr,t("div",Ar,[t("button",{onClick:s[4]||(s[4]=l=>r.selectCoupon()),class:"w-full h-10 px-3 outline-none flex items-center"},[Rr,t("span",Ir,n(r.__("Coupons")),1),e.order.coupons&&e.order.coupons.length>0?(i(),a("span",Er,n(e.order.coupons.length),1)):p("",!0)])]),Mr,t("div",Lr,[t("button",{onClick:s[5]||(s[5]=l=>r.defineOrderSettings()),class:"w-full h-10 px-3 outline-none flex items-center"},[Ur,t("span",Yr,n(r.__("Settings")),1)])]),Gr,e.options.ns_pos_quick_product==="yes"?(i(),a("div",zr,[t("button",{onClick:s[6]||(s[6]=l=>r.openAddQuickProduct()),class:"w-full h-10 px-3 outline-none flex items-center"},[Wr,t("span",Kr,n(r.__("Product")),1)])])):p("",!0),Jr])])]),t("div",Xr,[t("div",Zr,n(r.__("Product")),1),t("div",en,n(r.__("Quantity")),1),t("div",tn,n(r.__("Total")),1)]),t("div",sn,[e.products.length===0?(i(),a("div",rn,[t("div",nn,[t("h3",null,n(r.__("No products added...")),1)])])):p("",!0),(i(!0),a(w,null,k(e.products,(l,_)=>(i(),a("div",{"product-index":_,key:l.barcode,class:"product-item flex"},[t("div",ln,[t("div",an,[t("h3",dn,n(l.name)+" — "+n(l.unit_name),1),t("div",un,[t("div",cn,[t("a",{onClick:h=>r.remove(l),class:"hover:text-error-secondary cursor-pointer outline-none border-dashed py-1 border-b border-error-secondary text-sm"},hn,8,pn)]),e.options.ns_pos_allow_wholesale_price&&r.allowQuantityModification(l)?(i(),a("div",mn,[t("a",{class:V([l.mode==="wholesale"?"text-success-secondary border-success-secondary":"border-info-primary","cursor-pointer outline-none border-dashed py-1 border-b text-sm"]),onClick:h=>r.toggleMode(l,_)},yn,10,bn)])):p("",!0)])]),t("div",vn,[t("div",xn,[t("div",wn,[t("a",{onClick:h=>r.changeProductPrice(l),class:V([l.mode==="wholesale"?"text-success-secondary hover:text-success-secondary border-success-secondary":"border-info-primary","cursor-pointer outline-none border-dashed py-1 border-b text-sm"])},n(r.__("Price"))+" : "+n(r.nsCurrency(l.unit_price)),11,gn)]),t("div",Pn,[r.allowQuantityModification(l)?(i(),a("a",{key:0,onClick:h=>e.openDiscountPopup(l,"product",_),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},[T(n(r.__("Discount"))+" ",1),l.discount_type==="percentage"?(i(),a("span",Cn,n(l.discount_percentage)+"%",1)):p("",!0),T(" : "+n(r.nsCurrency(l.discount)),1)],8,kn)):p("",!0)]),t("div",Sn,[r.allowQuantityModification(l)?(i(),a("a",{key:0,onClick:h=>r.changeQuantity(l,_),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Quantity"))+": "+n(l.quantity),9,Tn)):p("",!0)]),t("div",Vn,[t("span",On,n(r.__("Total :"))+" "+n(r.nsCurrency(l.total_price)),1)])])])]),t("div",{onClick:h=>r.changeQuantity(l,_),class:V([r.allowQuantityModification(l)?"cursor-pointer ns-numpad-key":"","hidden lg:flex w-1/6 p-2 border-b items-center justify-center"])},[r.allowQuantityModification(l)?(i(),a("span",Fn,n(l.quantity),1)):p("",!0)],10,jn),t("div",$n,n(r.nsCurrency(l.total_price)),1)],8,on))),128))]),t("div",Dn,[e.visibleSection==="both"?(i(),a("table",Qn,[t("tr",null,[t("td",Nn,[t("a",{onClick:s[7]||(s[7]=l=>r.selectCustomer()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Customer"))+": "+n(r.customerName),1)]),t("td",Bn,n(r.__("Sub Total")),1),t("td",Hn,n(r.nsCurrency(e.order.subtotal)),1)]),e.order.coupons.length>0?(i(),a("tr",qn,[An,t("td",Rn,[t("a",{onClick:s[8]||(s[8]=l=>r.selectCoupon()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Coupons")),1)]),t("td",In,n(r.nsCurrency(r.summarizeCoupons())),1)])):p("",!0),t("tr",null,[t("td",En,[t("a",{onClick:s[9]||(s[9]=l=>r.openOrderType()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Type"))+": "+n(r.selectedType),1)]),t("td",Mn,[t("span",null,n(r.__("Discount")),1),e.order.discount_type==="percentage"?(i(),a("span",Ln,"("+n(e.order.discount_percentage)+"%)",1)):p("",!0),e.order.discount_type==="flat"?(i(),a("span",Un,"("+n(r.__("Flat"))+")",1)):p("",!0)]),t("td",Yn,[t("a",{onClick:s[10]||(s[10]=l=>e.openDiscountPopup(e.order,"cart")),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.nsCurrency(e.order.discount)),1)])]),e.order.type&&e.order.type.identifier==="delivery"?(i(),a("tr",Gn,[zn,t("td",Wn,[t("a",{onClick:s[11]||(s[11]=l=>r.openShippingPopup()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Shipping")),1)]),t("td",Kn,n(r.nsCurrency(e.order.shipping)),1)])):p("",!0),t("tr",Jn,[t("td",Xn,[e.order&&e.options.ns_pos_tax_type==="exclusive"?(i(),a(w,{key:0},[e.options.ns_pos_price_with_tax==="yes"?(i(),a("a",{key:0,onClick:s[12]||(s[12]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax Included"))+": "+n(r.nsCurrency(e.order.total_tax_value+e.order.products_tax_value)),1)):e.options.ns_pos_price_with_tax==="no"?(i(),a("a",{key:1,onClick:s[13]||(s[13]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax"))+": "+n(r.nsCurrency(e.order.total_tax_value)),1)):p("",!0)],64)):e.order&&e.options.ns_pos_tax_type==="inclusive"?(i(),a(w,{key:1},[e.options.ns_pos_price_with_tax==="yes"?(i(),a("a",{key:0,onClick:s[14]||(s[14]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax Included"))+": "+n(r.nsCurrency(e.order.total_tax_value+e.order.products_tax_value)),1)):e.options.ns_pos_price_with_tax==="no"?(i(),a("a",{key:1,onClick:s[15]||(s[15]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax"))+": "+n(r.nsCurrency(e.order.total_tax_value)),1)):p("",!0)],64)):p("",!0)]),t("td",Zn,n(r.__("Total")),1),t("td",eo,n(r.nsCurrency(e.order.total)),1)])])):p("",!0),e.visibleSection==="cart"?(i(),a("table",to,[t("tr",null,[t("td",so,[t("a",{onClick:s[16]||(s[16]=l=>r.selectCustomer()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Customer"))+": "+n(r.customerName),1)]),t("td",ro,[t("div",no,[t("span",null,n(r.__("Sub Total")),1),t("span",null,n(r.nsCurrency(e.order.subtotal)),1)])])]),e.order.coupons.length>0?(i(),a("tr",oo,[io,t("td",lo,[t("a",{onClick:s[17]||(s[17]=l=>r.selectCoupon()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Coupons")),1)]),t("td",ao,n(r.nsCurrency(r.summarizeCoupons())),1)])):p("",!0),t("tr",null,[t("td",uo,[t("a",{onClick:s[18]||(s[18]=l=>r.openOrderType()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Type"))+": "+n(r.selectedType),1)]),t("td",co,[t("div",po,[t("p",null,[t("span",null,n(r.__("Discount")),1),e.order.discount_type==="percentage"?(i(),a("span",_o,"("+n(e.order.discount_percentage)+"%)",1)):p("",!0),e.order.discount_type==="flat"?(i(),a("span",ho,"("+n(r.__("Flat"))+")",1)):p("",!0)]),t("a",{onClick:s[19]||(s[19]=l=>e.openDiscountPopup(e.order,"cart")),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.nsCurrency(e.order.discount)),1)])])]),e.order.type&&e.order.type.identifier==="delivery"?(i(),a("tr",mo,[bo,t("td",fo,[t("a",{onClick:s[20]||(s[20]=l=>r.openShippingPopup()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Shipping")),1),yo])])):p("",!0),t("tr",vo,[t("td",xo,[e.order&&e.options.ns_pos_tax_type==="exclusive"?(i(),a(w,{key:0},[e.options.ns_pos_price_with_tax==="yes"?(i(),a("a",{key:0,onClick:s[21]||(s[21]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax"))+": "+n(r.nsCurrency(e.order.total_tax_value)),1)):e.options.ns_pos_price_with_tax==="no"?(i(),a("a",{key:1,onClick:s[22]||(s[22]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax Inclusive"))+": "+n(r.nsCurrency(e.order.total_tax_value+e.order.products_tax_value)),1)):p("",!0)],64)):e.order&&e.options.ns_pos_tax_type==="inclusive"?(i(),a(w,{key:1},[e.options.ns_pos_price_with_tax==="yes"?(i(),a("a",{key:0,onClick:s[23]||(s[23]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax Included"))+": "+n(r.nsCurrency(e.order.total_tax_value)),1)):e.options.ns_pos_price_with_tax==="no"?(i(),a("a",{key:1,onClick:s[24]||(s[24]=l=>r.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},n(r.__("Tax Included"))+": "+n(r.nsCurrency(e.order.total_tax_value+e.order.products_tax_value)),1)):p("",!0)],64)):p("",!0)]),t("td",wo,[t("div",go,[t("span",null,n(r.__("Total")),1),t("span",null,n(r.nsCurrency(e.order.total)),1)])])])])):p("",!0)]),t("div",Po,[(i(!0),a(w,null,k(e.cartButtons,l=>(i(),P(q(l),{order:e.order,settings:e.settings},null,8,["order","settings"]))),256))])])])])}const Bi=x(wr,[["render",ko]]);export{Bi as default};
